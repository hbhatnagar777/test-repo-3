<CustomReport>
  <report>
    <customReportName>Office365 Backup Health</customReportName>
  </report>
  <pages>
    <Page>
      <pageName>Exchange</pageName>
      <isDefault>true</isDefault>
      <pageTitle>
        <text>Exchange</text>
      </pageTitle>
      <dataSets>
        <dataSet>
          <DataSet>
            <dataSet>
              <dataSetName>Clients</dataSetName>
              <dataSetGuid>93d702e9-9993-4480-95b6-219fd0b50979</dataSetGuid>
            </dataSet>
            <endpoint>DATABASE</endpoint>
            <shared>false</shared>
            <dataSources>
              <DataSource>
                <connectionType>COMMCELL</connectionType>
                <endpoint>DATABASE</endpoint>
                <commCell>
                  <commCellName>$ALL$</commCellName>
                </commCell>
              </DataSource>
            </dataSources>
            <allColumns>false</allColumns>
            <fields>
              <Column>
                <name>sys_rowid</name>
                <dataField>$row_number$</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Data Source</name>
                <dataField>Data Source</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>id</name>
                <dataField>id</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>displayName</name>
                <dataField>displayName</dataField>
                <type>String</type>
              </Column>
            </fields>
            <GetOperation>
              <parameters />
              <sqlText>-- Constants

DECLARE @CV_APPTYPE_EXCHANGE_ONEPASS INT = 137



-- variables

DECLARE @userId INT

DECLARE @companyId INT

DECLARE @clientIds TABLE (clientId INT)



-- read inputs

SELECT @userId = id FROM UMUsers WHERE login = @sys_username

SET @companyId = dbo.AppGetOrganizationForUser(@userId)



IF @companyId &gt; 0

			BEGIN

				DECLARE @OrgClients table (clientId INT,  tenantId INT , tenant nvarchar(40))            

				

				INSERT INTO @OrgClients 

				SELECT A.clientId, D.id , D.domainName

				from APP_ClientGroupAssoc A WITH (NOLOCK)

				JOIN APP_ClientGroup B WITH (NOLOCK) ON A.clientGroupId = B.id 

				JOIN App_CompanyProp C WITH (NOLOCK) ON C.attrName = 'Associated Smart Client Group' AND CAST(A.clientGroupId AS nvarchar(MAX)) = C.attrVal AND C.modIFied = 0

				JOIN UMDSProviders D WITH (NOLOCK) ON C.componentNameId = D.id

				WHERE (C.componentNameId = @companyId) AND  B.flag&amp;0x1000 &gt; 0



				INSERT INTO @clientIds (clientId) SELECT clientId FROM @OrgClients

			END

		ELSE

			BEGIN

				IF OBJECT_ID('tempdb.dbo.#temp_clientIds') IS NOT NULL

					DROP TABLE #temp_clientIds



				CREATE TABLE #temp_clientIds

				(

					clientId            INT,

					appTypeId           INT,

					instanceId          INT,

					backupsetId         INT,

					subclientId         INT

				)



				EXEC sec_getIdaObjectsForUser @userId, 3/*Client Entity*/, 0, 0, '#temp_clientIds', 1



				INSERT INTO @clientIds (clientId) SELECT clientId FROM #temp_clientIds

			END



DELETE FROM @clientIds WHERE clientId NOT IN 

(SELECT DISTINCT clientId FROM APP_Application WITH (NOLOCK) 

WHERE appTypeId = @CV_APPTYPE_EXCHANGE_ONEPASS

AND subclientStatus &amp; 0x04 != 0x04 /*DELETED*/ AND subclientStatus &amp; 0x00020 != 0x00020 /*HIDDEN*/)



DELETE FROM @clientIds WHERE clientId NOT IN

(SELECT DISTINCT AIN.clientId FROM APP_IDAName AIN WITH (NOLOCK)

INNER JOIN APP_IDAProp AIP WITH (NOLOCK) ON AIN.id = AIP.componentNameId

WHERE AIP.attrName = 'Exchange Environment Type' AND AIP.modified = 0 AND AIP.attrVal IN (1, 2, 3, 4))



SELECT id, displayName FROM APP_Client WITH (NOLOCK) WHERE id IN (select clientId FROM @clientIds) AND specialClientFlags &amp; 0x02 &lt;&gt; 0 /*Pseudo client*/



IF OBJECT_ID('tempdb.dbo.#temp_clientIds') IS NOT NULL

	DROP TABLE #temp_clientIds</sqlText>
              <timeout>5</timeout>
              <postQueryFilter>true</postQueryFilter>
              <rDataSetQuery />
              <rPlotQuery />
            </GetOperation>
            <description>Backup Health Report for Office 365 Clients.</description>
            <databaseName>CommServ</databaseName>
            <queryPlan>
              <offline>false</offline>
              <collectionType>HTTP</collectionType>
              <retentionDays>1</retentionDays>
              <versions>
                <CommCellVersion>ALL</CommCellVersion>
              </versions>
              <dynamicCollection>false</dynamicCollection>
              <frequency>60</frequency>
              <direct>false</direct>
            </queryPlan>
            <version>144</version>
            <guid>93d702e9-9993-4480-95b6-219fd0b50979</guid>
            <hidden>true</hidden>
            <revision />
            <computedColumns>
              <scriptName>R</scriptName>
              <script />
              <columnList />
            </computedColumns>
          </DataSet>
          <DataSet>
            <dataSet>
              <dataSetName>Exchange Mailbox Details</dataSetName>
              <dataSetGuid>282b5ae7-a371-4c1c-f7fa-9fb4f7e7cfd4</dataSetGuid>
            </dataSet>
            <endpoint>DATABASE</endpoint>
            <shared>false</shared>
            <dataSources>
              <DataSource>
                <connectionType>COMMCELL</connectionType>
                <endpoint>DATABASE</endpoint>
                <commCell>
                  <commCellName>$ALL$</commCellName>
                </commCell>
              </DataSource>
            </dataSources>
            <allColumns>true</allColumns>
            <fields>
              <Column>
                <name>sys_rowid</name>
                <dataField>$row_number$</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Data Source</name>
                <dataField>Data Source</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Name</name>
                <dataField>Name</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Email Address</name>
                <dataField>Email Address</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Last Backup</name>
                <dataField>Last Backup</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Last Backup Status</name>
                <dataField>Last Backup Status</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Failure Reason</name>
                <dataField>Failure Reason</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Last Backup Attempt</name>
                <dataField>Last Backup Attempt</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Last Backup Attempt JobId</name>
                <dataField>Last Backup Attempt JobId</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Client</name>
                <dataField>Client</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Added to content on</name>
                <dataField>Added to content on</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Mailbox Type</name>
                <dataField>Mailbox Type</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Backup Size</name>
                <dataField>Backup Size</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Number Of Emails</name>
                <dataField>Number Of Emails</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Failed Items</name>
                <dataField>Failed Items</dataField>
                <type>Integer</type>
              </Column>
            </fields>
            <GetOperation>
              <parameters>
                <Parameter>
                  <name>timeframe</name>
                  <dataType>DateRange</dataType>
                  <values>
                    <string>=input.Timeframe</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>Clients</name>
                  <dataType>Integer</dataType>
                  <isList>true</isList>
                  <values>
                    <string>=input.ExchangeClients</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>ClientGroups</name>
                  <dataType>Integer</dataType>
                  <isList>true</isList>
                  <values>
                    <string>=input.ClientGroups</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>Options</name>
                  <dataType>String</dataType>
                  <isList>true</isList>
                  <values>
                    <string>=input.Options</string>
                  </values>
                </Parameter>
              </parameters>
              <sqlText>/*Validity check*/

IF NOT EXISTS (SELECT Clients FROM @Clients) AND NOT EXISTS (SELECT ClientGroups FROM @ClientGroups)

BEGIN

	/*SELECT dummy columns to maintain consistency in report columns output*/

	SELECT 

		Clients AS [Name],

		Clients AS [Email Address],

		Clients AS [Last Backup],

		Clients AS [Last Backup Status],

		Clients AS [Failure Reason],

		Clients AS [Last Backup Attempt],

		Clients AS [Last Backup Attempt JobId],

		Clients AS [Client],

		Clients AS [Added to content on],

		Clients AS [Mailbox Type],

		Clients AS [Backup Size],

		Clients AS [Number Of Emails],

		Clients AS [Failed Items]

	FROM @Clients



	RETURN

END



-- constants

DECLARE @CV_APPTYPE_EXCHANGE_ONEPASS INT = 137



DECLARE @MAILBOX_USER INT = 1

DECLARE @MAILBOX_SHARED INT = 3

DECLARE @MAILBOX_GROUP INT = 36



DECLARE @STATUS_NOT_AVAILABLE INT = 0

DECLARE @STATUS_FAILED INT = 1

DECLARE @STATUS_SKIPPED INT = 2

DECLARE @STATUS_SUCCESS INT = 3

DECLARE @STATUS_SUSPENDED INT = 4

DECLARE @STATUS_COMPLETED_WITH_ERRORS INT = 5

DECLARE @STATUS_PARTIALLY_PROCESSED INT = 6

DECLARE @STATUS_NEVER_BACKED_UP INT = 501



DECLARE @userId INT = (SELECT TOP 1 id FROM UMUsers WITH (NOLOCK) WHERE login = @sys_username)

DECLARE @companyId INT = 0

DECLARE @numberOfDays INT = 7

DECLARE @depthRefTime INT = dbo.getunixtime(DATEADD(HOUR, -@numberOfDays*24 , GETUTCDATE()))



-- variables

DECLARE @includeBackupDisabledClients INT = 0

DECLARE @includeAllMailboxes INT = 0



IF OBJECT_ID('tempdb.dbo.#listClientIds_Exchange') IS NOT NULL

	DROP TABLE #listClientIds_Exchange



CREATE TABLE #listClientIds_Exchange (clientId INT, subclientId INT, backupsetId INT, instanceId INT)

CREATE NONCLUSTERED INDEX #listClientIds_Exchange_c_s_b_i_ids ON #listClientIds_Exchange(clientId, subclientId, backupsetId, instanceId)

			

INSERT INTO #listClientIds_Exchange (clientId) 

SELECT DISTINCT Clients FROM @Clients

UNION

SELECT DISTINCT CG.clientId FROM App_ClientGroupAssoc CG WITH (NOLOCK)

INNER JOIN APP_Application AA WITH (NOLOCK) ON CG.clientId = AA.clientId AND AA.appTypeId = @CV_APPTYPE_EXCHANGE_ONEPASS

WHERE clientGroupId IN (SELECT ClientGroups FROM @ClientGroups)

AND subclientStatus &amp; 0x04 != 0x04 /*DELETED*/ AND subclientStatus &amp; 0x00020 != 0x00020 /*HIDDEN*/



IF OBJECT_ID('tempdb.dbo.#temp__clientIds') IS NOT NULL

	DROP TABLE #temp__clientIds



CREATE TABLE #temp__clientIds

(

	clientId            INT,

	appTypeId           INT,

	instanceId          INT,

	backupsetId         INT,

	subclientId         INT

)



SET @companyId = dbo.AppGetOrganizationForUser(@userId)



IF @companyId &gt; 0

BEGIN

	INSERT INTO #temp__clientIds (clientId)

	SELECT DISTINCT CGA.clientId

	FROM UMDSProviders UMDS WITH (NOLOCK)

	JOIN App_CompanyProp CP WITH (NOLOCK) ON CP.attrName = 'Associated Smart Client Group' AND CP.modified = 0 AND UMDS.id = CP.componentNameId

	JOIN APP_ClientGroupAssoc CGA WITH (NOLOCK) ON CAST(CGA.clientGroupId AS NVARCHAR(16)) = CP.attrVal

	JOIN APP_ClientGroup CG WITH (NOLOCK) ON CGA.clientGroupId = CG.id

	WHERE CP.componentNameId = @companyId AND CG.flag &amp; 0x1000 &gt; 0

END

ELSE

BEGIN

	EXEC dbo.sec_getIdaObjectsForUser @userId, 3 /*Client Entity*/, 0, 0, '#temp__clientIds', 1

END



DELETE #listClientIds_Exchange

FROM #listClientIds_Exchange C 

INNER JOIN App_Client AC WITH (NOLOCK) ON C.clientId = AC.id

WHERE AC.specialClientFlags &amp; 0x02 = 0 /*Not Pseudo client*/ OR C.clientId NOT IN (SELECT clientId FROM #temp__clientIds)



IF OBJECT_ID('tempdb.dbo.#temp__clientIds') IS NOT NULL

	DROP TABLE #temp__clientIds



DECLARE @csTimeZoneId			INT = 0

DECLARE @csTimeZone				NVARCHAR(1024) = ''

DECLARE @browserBias			INT = 0

DECLARE @browserTimeZoneId		INT = 0



SET @browserTimeZoneId = (SELECT TOP 1 TimeZoneID FROM SchedTimeZone WITH (NOLOCK) WHERE TimeZoneName LIKE '%' + @sys_timezone + '%')

SELECT @browserBias = Bias FROM SchedTimeZone WITH (NOLOCK) WHERE TimeZoneID = @browserTimeZoneId



SELECT @csTimeZoneId = (SELECT TOP 1 attrVal FROM APP_ClientProp WITH (NOLOCK) WHERE attrName = 'Commcell timezone Id' AND modified = 0)

IF ISNULL(@csTimeZoneId, 0) = 0

	SELECT @csTimeZoneId = (SELECT TOP 1 attrVal FROM APP_ClientProp WITH (NOLOCK) WHERE componentNameId = 2 AND attrName = 'timezone Id' AND modified = 0)

SET @csTimeZone = (SELECT TOP 1 TimeZoneName FROM SchedTimeZone WITH (NOLOCK) WHERE TimeZoneID = @csTimeZoneId)



DECLARE @startTime BIGINT = DATEDIFF(SS, '1970-01-01', dbo.LocalToUTCDateTimeConversionManaged(ISNULL(@timeframe_from,'1970-01-01 00:00:00.000'), @csTimeZone))



IF EXISTS (SELECT Options FROM @Options WHERE Options = 'Show backup disabled clients')

	SET @includeBackupDisabledClients = 1



IF EXISTS (SELECT Options FROM @Options WHERE Options = 'Show all mailboxes')

	SET @includeAllMailboxes = 1



UPDATE #listClientIds_Exchange

SET subclientId = S.subclientId, backupsetId = S.backupSet, instanceId = S.instance

FROM (SELECT MIN(id) AS subclientId, clientId, backupSet, instance

		FROM APP_Application WITH (NOLOCK)

		WHERE clientId IN (SELECT clientId FROM #listClientIds_Exchange) AND appTypeId = @CV_APPTYPE_EXCHANGE_ONEPASS

		GROUP BY clientId, backupSet, instance

	) S WHERE #listClientIds_Exchange.clientId = S.clientId



IF @includeBackupDisabledClients = 0

BEGIN

	DELETE FROM #listClientIds_Exchange

	WHERE subclientId IN 

	(

		/*Delete license released clients*/

		SELECT AA.id

		FROM App_Application AA WITH (NOLOCK)

		INNER JOIN #listClientIds_Exchange TT ON AA.id = TT.subclientId 

		WHERE subclientStatus &amp; 0x02 = 0x02

		UNION

		/*Delete excluded from SLA clients*/

		SELECT ASP.componentNameId

		FROM APP_SubClientProp ASP WITH (NOLOCK)

		JOIN #listClientIds_Exchange TE ON ASP.componentNameId = TE.subclientId

		WHERE ASP.attrName = 'Exclude From SLA' AND ASP.attrVal = 1 AND ASP.modified = 0

		UNION

		/*Delete backup disabled clients*/

		SELECT JA.appId

		FROM JMJobAction JA WITH (NOLOCK) 

		JOIN #listClientIds_Exchange TE ON JA.appId = TE.subclientId

		WHERE JA.clientId = 1 AND JA.mediaAgentID = 1 AND JA.appType = 0 AND JA.optype = 4 AND JA.action = 1

	)



	/*Delete clients associated with deactivated tenants*/

	DELETE FROM #listClientIds_Exchange

	WHERE clientId IN (SELECT DISTINCT CGA.clientId

	FROM UMDSProviders UMDS WITH (NOLOCK)

	JOIN App_CompanyProp CP WITH (NOLOCK) ON CP.attrName = 'Associated Smart Client Group' AND CP.modified = 0 AND UMDS.id = CP.componentNameId

	JOIN APP_ClientGroupAssoc CGA WITH (NOLOCK) ON CAST(CGA.clientGroupId AS NVARCHAR(16)) = CP.attrVal

	WHERE UMDS.flags &amp; 0x0010 = 0x0010 OR enabled = 0)

END



IF OBJECT_ID('tempdb.dbo.#temp_unprotected_mailboxes') IS NOT NULL

	DROP TABLE #temp_unprotected_mailboxes



CREATE TABLE #temp_unprotected_mailboxes

(

	displayName NVARCHAR(512),

	smtpAddress NVARCHAR(512),

	userGUID NVARCHAR(128),

	created BIGINT,

	backupReferenceTime BIGINT,

	clientId INT,

	mailboxType INT,

	mailboxSize BIGINT,

	numberOfEmails BIGINT,

	isProtected INT

)



INSERT INTO #temp_unprotected_mailboxes (displayName, smtpAddress, userGUID, created, backupReferenceTime, mailboxType, clientId, mailboxSize, numberOfEmails, isProtected)

SELECT E.displayName, E.smtpAdrress, UPPER(E.userGuid), created,

backupReferenceTime, msExchRecipientTypeDetails, TE.clientId, mailBoxSize, numberOfEmails, 0

FROM APP_EmailConfigPolicyAssoc E WITH (NOLOCK)

INNER JOIN #listClientIds_Exchange TE ON TE.subclientId = E.subClientId

WHERE discoverByType = 1 AND E.modified = 0 AND E.status = 0 /*Active*/ AND E.smtpAdrress IS NOT NULL AND E.mailBoxType = 1

AND (CASE 

		WHEN @includeAllMailboxes = 1 THEN 1

		WHEN (backupReferenceTime &lt; @startTime OR backupReferenceTime IS NULL) THEN 1

		ELSE 0

	END) = 1



CREATE CLUSTERED INDEX #temp_unprotected_mailboxes_smtp_clientId ON #temp_unprotected_mailboxes (clientId, userGUID)



IF OBJECT_ID('tempdb.dbo.#upm_temp_job_summary') IS NOT NULL

	DROP TABLE #upm_temp_job_summary



CREATE TABLE #upm_temp_job_summary

(

	clientId INT,

	jobId INT,

	jobStartTime BIGINT,

	jobEndTime BIGINT,

	data XML

)



CREATE CLUSTERED INDEX #ump_job_summary_client_jobId ON #upm_temp_job_summary(clientId, jobId)



INSERT INTO #upm_temp_job_summary

SELECT TE.clientId, JM.jobId, JS.servStartDate, JS.servEndDate, JM.data

FROM  JMMisc JM WITH (NOLOCK)

INNER JOIN JMBkpStats JS WITH (NOLOCK) ON JM.jobId = JS.jobId AND JS.servEndDate &gt;= @depthRefTime AND JS.commcellId = 2

INNER JOIN #listClientIds_Exchange TE ON TE.subclientId = JS.appId

WHERE JS.opType = 4 /*Backup*/ AND JM.itemType = 28



IF OBJECT_ID('tempdb.dbo.#upm_temp_mailbox_summary') IS NOT NULL

	DROP TABLE #upm_temp_mailbox_summary



CREATE TABLE #upm_temp_mailbox_summary

(

	smtpAddress NVARCHAR(512),

	userGUID NVARCHAR(128),

	status INT, 

	failureReason NVARCHAR(MAX),

	failedItems INT,

	jobId INT,

	jobStartTime BIGINT,

	jobEndTime BIGINT,

	clientId INT

)



CREATE CLUSTERED INDEX #upm_temp_mailbox_summary_smtp_cId_jId ON #upm_temp_mailbox_summary (jobId, clientId, userGUID)



INSERT INTO #upm_temp_mailbox_summary

SELECT 

	M.NA.value('@SMTP', 'NVARCHAR(512)'),

	UPPER(REPLACE(M.NA.value('@GUID', 'NVARCHAR(128)'), '-', 'X')),

	M.NA.value('@status', 'INT'),

	M.NA.value('@FailureReason', 'NVARCHAR(MAX)'),

	M.NA.value('@FailedMessages', 'INT'),

	jobId, jobStartTime, jobEndTime, clientId

FROM #upm_temp_job_summary U

CROSS APPLY U.data.nodes('./JobManager_ExchMbJobInfo/SourceMailboxStats') M(NA)

WHERE M.NA.value('@SMTP', 'NVARCHAR(512)') &lt;&gt; '' -- exclude pst



DELETE dup FROM 

(SELECT ROW_NUMBER() OVER (PARTITION BY userGUID, clientId ORDER BY jobId DESC) cnt FROM #upm_temp_mailbox_summary) dup

WHERE dup.cnt &gt; 1



QUERY_END:

SELECT

displayName AS 'Name',

smtpAddress AS 'Email Address',

(CASE WHEN lastBackup IS NOT NULL AND lastBackup &gt; 0

	THEN (SELECT DATEADD(ss, lastBackup + @browserBias, CAST('1970-01-01 00:00:00' AS DATETIME)))

END) AS 'Last Backup', 

(CASE mailboxStatus 

	WHEN @STATUS_FAILED THEN 'Failed'

	WHEN @STATUS_SKIPPED THEN 'Skipped'

	WHEN @STATUS_SUCCESS THEN 'Successful'

	WHEN @STATUS_SUSPENDED THEN 'Suspended'

	WHEN @STATUS_COMPLETED_WITH_ERRORS THEN 'Completed with errors'

	WHEN @STATUS_PARTIALLY_PROCESSED THEN 'Partially Processed'

	WHEN @STATUS_NEVER_BACKED_UP THEN 'Never backed-up'

	WHEN @STATUS_NOT_AVAILABLE THEN 'Not Available'

END) AS 'Last Backup Status',

(CASE WHEN mailboxStatus NOT IN (@STATUS_SUCCESS, @STATUS_NOT_AVAILABLE) THEN failureReason END) AS 'Failure Reason',

(CASE 

	WHEN mailboxStatus = @STATUS_SUCCESS THEN (SELECT DATEADD(ss, lastBackup + @browserBias, CAST('1970-01-01 00:00:00' AS DATETIME)))

	WHEN mailboxStatus &lt;&gt; @STATUS_NOT_AVAILABLE THEN lastAttempt

END) AS 'Last Backup Attempt', 

(CASE WHEN mailboxStatus NOT IN (@STATUS_SUCCESS, @STATUS_NOT_AVAILABLE) THEN jobId END) AS 'Last Backup Attempt JobId',

clientName AS 'Client',

(CASE WHEN created IS NOT NULL AND created &gt; 0

	THEN (SELECT DATEADD(ss, created + @browserBias, CAST('1970-01-01 00:00:00' AS DATETIME)))

END) AS 'Added to content on', 

(CASE mailboxType

	WHEN @MAILBOX_USER THEN 'User mailbox'

	WHEN @MAILBOX_SHARED THEN 'Shared mailbox'

	WHEN @MAILBOX_GROUP THEN 'Group mailbox'

	ELSE 'Other'

END) AS 'Mailbox Type',

(CASE WHEN mailboxSize IS NULL THEN 0 ELSE mailboxSize END) AS 'Backup Size',

(CASE WHEN numberOfEmails IS NULL THEN 0 ELSE numberOfEmails END) AS 'Number Of Emails',

(CASE WHEN mailboxStatus &lt;&gt; @STATUS_NOT_AVAILABLE THEN ISNULL(failedItems, 0) ELSE 0 END) AS 'Failed Items'

FROM

(

	SELECT 

		UP.displayName, UP.smtpAddress, UP.created,

		(SELECT DATEADD(ss, jobStartTime + @browserBias, CAST('1970-01-01 00:00' AS DATETIME))) AS [lastAttempt],

		backupReferenceTime AS [lastBackup],

		(CASE 

			WHEN MS.status IS NOT NULL AND (ISNULL(MS.jobStartTime, 0) &gt;= ISNULL(backupReferenceTime, 0) 

											OR ISNULL(backupReferenceTime, 0) BETWEEN ISNULL(MS.jobStartTime, 0) AND ISNULL(MS.jobEndTime, 0)) THEN MS.status

			WHEN ISNULL(backupReferenceTime, 0) &gt;= @depthRefTime THEN @STATUS_SUCCESS

			WHEN ISNULL(backupReferenceTime, 0) = 0 THEN @STATUS_NEVER_BACKED_UP 

			ELSE @STATUS_NOT_AVAILABLE 

		END) AS [mailboxStatus],

		UP.clientId, AC.displayName AS [clientName] , jobId, failureReason, failedItems, mailboxType, mailboxSize, numberOfEmails

		FROM #temp_unprotected_mailboxes UP 

		LEFT JOIN App_Client AC WITH (NOLOCK) ON UP.clientId = AC.id

		LEFT JOIN #upm_temp_mailbox_summary MS ON UP.userGUID = MS.userGUID AND UP.clientId = MS.clientId

		--WHERE (status = @STATUS_SKIPPED OR (MS.jobStartTime IS NULL OR MS.jobStartTime &gt; (CASE WHEN UP.backupReferenceTime IS NULL THEN 0 ELSE UP.backupReferenceTime END)))

) R

--ORDER BY jobId DESC, lastBackup DESC



IF OBJECT_ID('tempdb.dbo.#listClientIds_Exchange') IS NOT NULL

	DROP TABLE #listClientIds_Exchange



IF OBJECT_ID('tempdb.dbo.#temp_unprotected_mailboxes') IS NOT NULL

	DROP TABLE #temp_unprotected_mailboxes



IF OBJECT_ID('tempdb.dbo.#upm_temp_mailbox_summary') IS NOT NULL

	DROP TABLE #upm_temp_mailbox_summary



IF OBJECT_ID('tempdb.dbo.#upm_temp_mailbox_summary') IS NOT NULL

	DROP TABLE #upm_temp_mailbox_summary</sqlText>
              <timeout>5</timeout>
              <postQueryFilter>true</postQueryFilter>
              <rDataSetQuery />
              <rPlotQuery />
            </GetOperation>
            <description>Backup Health Report for Office 365 Clients.</description>
            <databaseName>CommServ</databaseName>
            <queryPlan>
              <offline>false</offline>
              <collectionType>HTTP</collectionType>
              <retentionDays>1</retentionDays>
              <versions>
                <CommCellVersion>ALL</CommCellVersion>
              </versions>
              <dynamicCollection>false</dynamicCollection>
              <frequency>60</frequency>
              <direct>false</direct>
            </queryPlan>
            <version>144</version>
            <guid>282b5ae7-a371-4c1c-f7fa-9fb4f7e7cfd4</guid>
            <hidden>true</hidden>
            <revision />
            <computedColumns>
              <scriptName>R</scriptName>
              <script />
              <columnList />
            </computedColumns>
          </DataSet>
          <DataSet>
            <dataSet>
              <dataSetName>Exchange Client Groups</dataSetName>
              <dataSetGuid>ca913a5e-152a-44c0-d028-6a9e26e648b8</dataSetGuid>
            </dataSet>
            <endpoint>DATABASE</endpoint>
            <shared>false</shared>
            <dataSources>
              <DataSource>
                <connectionType>COMMCELL</connectionType>
                <endpoint>DATABASE</endpoint>
                <commCell>
                  <commCellName>$ALL$</commCellName>
                </commCell>
              </DataSource>
            </dataSources>
            <allColumns>false</allColumns>
            <fields>
              <Column>
                <name>sys_rowid</name>
                <dataField>$row_number$</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Data Source</name>
                <dataField>Data Source</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>groupId</name>
                <dataField>groupId</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>groupName</name>
                <dataField>groupName</dataField>
                <type>String</type>
              </Column>
            </fields>
            <GetOperation>
              <parameters />
              <sqlText>SET NOCOUNT ON
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED

DECLARE	@UserId		INT 
DECLARE @CV_APPTYPE_EXCHANGE_ONEPASS INT = 137
SELECT	@UserId = id FROM UMUsers WHERE login = @sys_username

DECLARE @CV_FLAG_COMMCELL_GROUP VARBINARY(8) = 0x40000
DECLARE	@ObjectType	INT = 2572		-- SERVER_GROUP_NAME_ITEM

IF OBJECT_ID('tempdb.dbo.#UserObjects') IS NOT NULL
	DROP TABLE #UserObjects

create table  #UserObjects ( 
	[capabilities]  bigint	NOT null, 
	[flag]			int NOT null default 0, 
	[commCellId]    int	NOT null default 2, 
	[clientGroupId] int	NOT null default 0, 
	[clientId]      int	NOT null default 0, 
	[appTypeId]     int	NOT null default 0, 
	[instanceId]    int	NOT null default 0, 
	[backupsetId]   int	NOT null default 0, 
	[subClientId]   int	NOT null default 0, 
	[mediaAgentId]  int	NOT null default 0, 
	[libraryId]     int	NOT null default 0, 
	[archGroupId]   int	NOT null default 0, 
	[vtContainerId] int	NOT null default 0, 
	[vtPolicyId]    int	NOT null default 0, 
	[vtShelfId]     int	NOT null default 0, 
	[reviewSetId]   int	NOT null default 0, 
	[querySetId]	int	NOT null default 0, 
	[downloadSetId] int	NOT null default 0, 
	[ermId]   		int	NOT null default 0, 
	[legalHoldId]   int	NOT null default 0, 
	[tagId]			int	NOT null default 0, 
	[cdPolicyId]    int	NOT null default 0, 
	[complianceReportId]   int	NOT null default 0, 
	[taskId]        int	NOT null default 0, 
	[workflowId]    int	NOT null default 0, 
	[logMonitoringPolicyId] int	NOT null default 0, 
	[arrayId]       int	NOT null default 0, 
	[cloudId]       int	NOT null default 0, 
	[userGroupId]   int	NOT null default 0, 
	[providerId]    int	NOT null default 0, 
	[entityId1]     int	NOT null default 0, 
	[entityId2]     int	NOT null default 0, 
	[entityId3]     int	NOT null default 0, 
	[entityId4]     int	NOT null default 0, 
	[entityId5]     int	NOT null default 0, 
	[entityId6]     int	NOT null default 0, 
	[entityId7]     int	NOT null default 0, 
	[entityId8]     int	NOT null default 0, 
	[entityId9]     int	NOT null default 0  )

EXEC sec_getUserObjects @UserId, @ObjectType, 0, '#UserObjects'

DECLARE @clientGroups TABLE (groupId INT, groupName NVARCHAR(255))

IF EXISTS (SELECT * FROM #UserObjects WHERE commCellId = 2 AND clientGroupId = 0)
	INSERT INTO @clientGroups (groupId, groupName)
	SELECT	CG.id, CG.name
	FROM	APP_ClientGroup CG WITH (NOLOCK)
        WHERE CG.Flag &amp; @CV_FLAG_COMMCELL_GROUP = 0
ELSE
	INSERT INTO @clientGroups (groupId, groupName)
	SELECT	CG.id, CG.name
	FROM	#UserObjects O
			INNER JOIN APP_ClientGroup CG WITH (NOLOCK) ON O.clientGroupId = CG.id 
        AND CG.Flag &amp; @CV_FLAG_COMMCELL_GROUP = 0
	WHERE	O.commCellId = 2 AND O.clientGroupId &gt; 0

SELECT groupId, groupName FROM @clientGroups WHERE groupId IN (SELECT DISTINCT clientGroupId FROM App_ClientGroupAssoc WITH (NOLOCK) WHERE clientId in (
SELECT id FROM App_Client WITH (NOLOCK) WHERE id IN (SELECT DISTINCT clientId FROM APP_Application WITH (NOLOCK)
WHERE subclientStatus &amp; 0x04 != 0x04 /*DELETED*/ AND subclientStatus &amp; 0x00020 != 0x00020 /*HIDDEN*/)
AND specialClientFlags &amp; 0x02 &lt;&gt; 0 /*Pseudo client*/))

IF OBJECT_ID('tempdb.dbo.#UserObjects') IS NOT NULL
	DROP TABLE #UserObjects</sqlText>
              <timeout>5</timeout>
              <postQueryFilter>true</postQueryFilter>
              <rDataSetQuery />
              <rPlotQuery />
            </GetOperation>
            <description>Backup Health Report for Office 365 Clients.</description>
            <databaseName>CommServ</databaseName>
            <queryPlan>
              <offline>false</offline>
              <collectionType>HTTP</collectionType>
              <retentionDays>1</retentionDays>
              <versions>
                <CommCellVersion>ALL</CommCellVersion>
              </versions>
              <dynamicCollection>false</dynamicCollection>
              <frequency>60</frequency>
              <direct>false</direct>
            </queryPlan>
            <version>144</version>
            <guid>ca913a5e-152a-44c0-d028-6a9e26e648b8</guid>
            <hidden>true</hidden>
            <revision />
            <computedColumns>
              <scriptName>R</scriptName>
              <script />
              <columnList />
            </computedColumns>
          </DataSet>
          <DataSet>
            <dataSet>
              <dataSetName>Exchange Client SLA</dataSetName>
              <dataSetGuid>580a59f2-6033-4d8a-849d-d787d1b9b701</dataSetGuid>
            </dataSet>
            <endpoint>DATABASE</endpoint>
            <shared>false</shared>
            <dataSources>
              <DataSource>
                <connectionType>COMMCELL</connectionType>
                <endpoint>DATABASE</endpoint>
                <commCell>
                  <commCellName>$ALL$</commCellName>
                </commCell>
              </DataSource>
            </dataSources>
            <allColumns>false</allColumns>
            <fields>
              <Column>
                <name>sys_rowid</name>
                <dataField>$row_number$</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Data Source</name>
                <dataField>Data Source</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Client</name>
                <dataField>Client</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Client Status</name>
                <dataField>Client Status</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Index Status</name>
                <dataField>Index Status</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Last Indexed Backup JobId</name>
                <dataField>Last Indexed Backup JobId</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Last Index Time</name>
                <dataField>Last Index Time</dataField>
                <type>TimeStamp</type>
              </Column>
              <Column>
                <name>Last Index Error Time</name>
                <dataField>Last Index Error Time</dataField>
                <type>TimeStamp</type>
              </Column>
              <Column>
                <name>Last Discovery Time</name>
                <dataField>Last Discovery Time</dataField>
                <type>TimeStamp</type>
              </Column>
              <Column>
                <name>Last Backup Run Time</name>
                <dataField>Last Backup Run Time</dataField>
                <type>TimeStamp</type>
              </Column>
              <Column>
                <name>Last Backup Job ID</name>
                <dataField>Last Backup Job ID</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Associated Mailboxes</name>
                <dataField>Associated Mailboxes</dataField>
                <type>Long</type>
              </Column>
              <Column>
                <name>Mailboxes Backed-up</name>
                <dataField>Mailboxes Backed-up</dataField>
                <type>Long</type>
              </Column>
              <Column>
                <name>Mailboxes Not Backed-up</name>
                <dataField>Mailboxes Not Backed-up</dataField>
                <type>Long</type>
              </Column>
              <Column>
                <name>Mailboxes Backed-up (at least once)</name>
                <dataField>Mailboxes Backed-up (at least once)</dataField>
                <type>Long</type>
              </Column>
              <Column>
                <name>Mailboxes Never Backed-up</name>
                <dataField>Mailboxes Never Backed-up</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Mailboxes Recently Added</name>
                <dataField>Mailboxes Recently Added</dataField>
                <type>Long</type>
              </Column>
              <Column>
                <name>Mailboxes Need Attention</name>
                <dataField>Mailboxes Need Attention</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Application Size</name>
                <dataField>Application Size</dataField>
                <type>Long</type>
              </Column>
              <Column>
                <name>Number of Emails</name>
                <dataField>Number of Emails</dataField>
                <type>Long</type>
              </Column>
              <Column>
                <name>Indexed Emails</name>
                <dataField>Indexed Emails</dataField>
                <type>Long</type>
              </Column>
              <Column>
                <name>Azure Apps Associated</name>
                <dataField>Azure Apps Associated</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Azure Apps Not Authorized</name>
                <dataField>Azure Apps Not Authorized</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Azure Apps To Be Added</name>
                <dataField>Azure Apps To Be Added</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Last Verify Connection Time</name>
                <dataField>Last Verify Connection Time</dataField>
                <type>TimeStamp</type>
              </Column>
              <Column>
                <name>Max Streams</name>
                <dataField>Max Streams</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Access Node Group</name>
                <dataField>Access Node Group</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Index Server</name>
                <dataField>Index Server</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Active Jobs</name>
                <dataField>Active Jobs</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>joburl</name>
                <dataField>joburl</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>backupjoburl</name>
                <dataField>backupjoburl</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>clienturl</name>
                <dataField>clienturl</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>activejobsurl</name>
                <dataField>activejobsurl</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>accessNodeGroupUrl</name>
                <dataField>accessNodeGroupUrl</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>indexserverurl</name>
                <dataField>indexserverurl</dataField>
                <type>String</type>
              </Column>
            </fields>
            <GetOperation>
              <parameters>
                <Parameter>
                  <name>Clients</name>
                  <dataType>Integer</dataType>
                  <isList>true</isList>
                  <values>
                    <string>=input.ExchangeClients</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>ClientGroups</name>
                  <dataType>Integer</dataType>
                  <isList>true</isList>
                  <values>
                    <string>=input.ClientGroups</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>timeframe</name>
                  <dataType>DateRange</dataType>
                  <values>
                    <string>=input.Timeframe</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>Options</name>
                  <dataType>String</dataType>
                  <isList>true</isList>
                  <values>
                    <string>=input.Options</string>
                  </values>
                </Parameter>
              </parameters>
              <sqlText>DECLARE @CV_APPTYPE_EXCHANGE_ONEPASS INT = 137



DECLARE @MAILBOX_USER INT = 1

DECLARE @MAILBOX_SHARED INT = 3

DECLARE @MAILBOX_GROUP INT = 36



DECLARE @MAX_USERS_FOR_FIVE_CONNECTIONS INT = 10000

DECLARE @TENANT_DIACTIVEVATED INT = 101

DECLARE @LICENSE_RELEASED INT = 102

DECLARE @EXCLUDED_FROM_SLA INT = 103



DECLARE @userId INT = (SELECT TOP 1 id FROM UMUsers WITH (NOLOCK) WHERE login = @sys_username)

DECLARE @companyId INT

DECLARE @includeBackupDisabledClients INT = 0



DECLARE @recentlyAddedNumberOfDays INT = 7

DECLARE @recentlyAddedRefTime INT = dbo.getunixtime(DATEADD(HOUR, -@recentlyAddedNumberOfDays*24 , GETUTCDATE()))



IF OBJECT_ID('tempdb.dbo.#listClientIds_Exchange') IS NOT NULL

	DROP TABLE #listClientIds_Exchange



CREATE TABLE #listClientIds_Exchange (clientId INT, subclientId INT, backupsetId INT, instanceId INT, isBackupDisabled INT DEFAULT 0, isO365Client INT DEFAULT 0)

CREATE NONCLUSTERED INDEX #listClientIds_Exchange_c_s_b_i_ids ON #listClientIds_Exchange(clientId, subclientId, backupsetId, instanceId)



IF EXISTS (SELECT Options FROM @Options WHERE Options = 'Show backup disabled clients')

	SET @includeBackupDisabledClients = 1



SET @companyId = dbo.AppGetOrganizationForUser(@userId)



IF OBJECT_ID('tempdb.dbo.#temp__clientIds') IS NOT NULL

	DROP TABLE #temp__clientIds



CREATE TABLE #temp__clientIds

(

	clientId            INT,

	appTypeId           INT,

	instanceId          INT,

	backupsetId         INT,

	subclientId         INT

)



IF NOT EXISTS (SELECT Clients FROM @Clients) AND NOT EXISTS (SELECT ClientGroups FROM @ClientGroups)

BEGIN 

	IF @companyId &gt; 0

	BEGIN

		INSERT INTO #temp__clientIds (clientId)

		SELECT DISTINCT CGA.clientId

		FROM UMDSProviders UMDS WITH (NOLOCK)

		JOIN App_CompanyProp CP WITH (NOLOCK) ON CP.attrName = 'Associated Smart Client Group' AND CP.modified = 0 AND UMDS.id = CP.componentNameId

		JOIN APP_ClientGroupAssoc CGA WITH (NOLOCK) ON CAST(CGA.clientGroupId AS NVARCHAR(16)) = CP.attrVal

		JOIN APP_ClientGroup CG WITH (NOLOCK) ON CGA.clientGroupId = CG.id

		WHERE CP.componentNameId = @companyId AND CG.flag &amp; 0x1000 &gt; 0



		-- include clients belongs to logged in users company

		INSERT INTO #listClientIds_Exchange (clientId)

		SELECT DISTINCT TC.clientId

		FROM #temp__clientIds TC

		INNER JOIN APP_Application AA WITH (NOLOCK) ON TC.clientId = AA.clientId

		WHERE AA.appTypeId = @CV_APPTYPE_EXCHANGE_ONEPASS AND subclientStatus &amp; 0x04 != 0x04 /*DELETED*/ AND subclientStatus &amp; 0x00020 != 0x00020 /*HIDDEN*/

	END

	ELSE

	BEGIN

		EXEC sec_getIdaObjectsForUser @userId, 3 /*Client Entity*/, 0, 0, '#temp__clientIds', 1



		-- include all clients user has access to

		INSERT INTO #listClientIds_Exchange (clientId)

		SELECT DISTINCT TC.clientId

		FROM #temp__clientIds TC

		INNER JOIN APP_Application AA WITH (NOLOCK) ON TC.clientId = AA.clientId

		WHERE AA.appTypeId = @CV_APPTYPE_EXCHANGE_ONEPASS AND subclientStatus &amp; 0x04 != 0x04 /*DELETED*/ AND subclientStatus &amp; 0x00020 != 0x00020 /*HIDDEN*/

	END

END

ELSE

BEGIN

	INSERT INTO #listClientIds_Exchange (clientId)

	SELECT DISTINCT Clients FROM @Clients

	UNION

	SELECT DISTINCT CG.clientId FROM App_ClientGroupAssoc CG WITH (NOLOCK)

	INNER JOIN APP_Application AA WITH (NOLOCK) ON CG.clientId = AA.clientId AND AA.appTypeId = @CV_APPTYPE_EXCHANGE_ONEPASS

	WHERE clientGroupId IN (SELECT ClientGroups FROM @ClientGroups)

	AND subclientStatus &amp; 0x04 != 0x04 /*DELETED*/ AND subclientStatus &amp; 0x00020 != 0x00020 /*HIDDEN*/



	EXEC dbo.sec_getIdaObjectsForUser @userId, 3 /*Client Entity*/, 0, 0, '#temp__clientIds', 1



	DELETE FROM #listClientIds_Exchange

	WHERE clientId NOT IN (SELECT clientId FROM #temp__clientIds)

END



IF OBJECT_ID('tempdb.dbo.#temp__clientIds') IS NOT NULL

	DROP TABLE #temp__clientIds



DELETE #listClientIds_Exchange

FROM #listClientIds_Exchange C INNER JOIN App_Client AC WITH (NOLOCK) ON C.clientId = AC.id

WHERE AC.specialClientFlags &amp; 0x02 = 0 /*Not Pseudo client*/



DECLARE @csTimeZoneId			INT = 0

DECLARE @csTimeZone				NVARCHAR(1024) = ''

DECLARE @browserBias			INT = 0

DECLARE @browserTimeZoneId		INT = 0



SET @browserTimeZoneId = (SELECT TOP 1 TimeZoneID FROM SchedTimeZone WITH (NOLOCK) WHERE TimeZoneName LIKE '%' + @sys_timezone + '%')

SELECT @browserBias = Bias FROM SchedTimeZone WITH (NOLOCK) WHERE TimeZoneID = @browserTimeZoneId



SELECT @csTimeZoneId = (SELECT TOP 1 attrVal FROM APP_ClientProp WITH (NOLOCK) WHERE attrName = 'Commcell timezone Id' AND modified = 0)

IF ISNULL(@csTimeZoneId, 0) = 0

	SELECT @csTimeZoneId = (SELECT TOP 1 attrVal FROM APP_ClientProp WITH (NOLOCK) WHERE componentNameId = 2 AND attrName = 'timezone Id' AND modified = 0)

SET @csTimeZone = (SELECT TOP 1 TimeZoneName FROM SchedTimeZone WITH (NOLOCK) WHERE TimeZoneID = @csTimeZoneId)



DECLARE @startTime BIGINT = DATEDIFF(SS, '1970-01-01', dbo.LocalToUTCDateTimeConversionManaged(ISNULL(@timeframe_from,'1970-01-01 00:00:00.000'), @csTimeZone))



UPDATE #listClientIds_Exchange

SET subclientId = S.subclientId, backupsetId = S.backupSet, instanceId = S.instance

FROM (SELECT MIN(id) AS subclientId, clientId, backupSet, instance

		FROM APP_Application WITH (NOLOCK)

		WHERE clientId IN (SELECT clientId FROM #listClientIds_Exchange) AND appTypeId = @CV_APPTYPE_EXCHANGE_ONEPASS

		GROUP BY clientId, backupSet, instance

	) S WHERE #listClientIds_Exchange.clientId = S.clientId



UPDATE #listClientIds_Exchange

SET isO365Client = (CASE WHEN AIP.attrVal = 4/*O365 Client*/ THEN 1 ELSE 0 END)

FROM APP_IDAProp AIP WITH (NOLOCK)

INNER JOIN App_IdaName AIN WITH (NOLOCK) ON AIP.componentNameId = AIN.id

INNER JOIN #listClientIds_Exchange TE ON AIN.clientId = TE.clientId

WHERE AIP.attrName = 'Exchange Environment Type' AND AIP.modified = 0 AND AIN.appTypeId = @CV_APPTYPE_EXCHANGE_ONEPASS



UPDATE #listClientIds_Exchange

SET isBackupDisabled = JA.action

FROM JMJobAction JA WITH (NOLOCK)

INNER JOIN #listClientIds_Exchange TE ON TE.subclientId = JA.appId

WHERE JA.clientId = 1 AND JA.mediaAgentID = 1 AND JA.appType = 0 AND JA.optype = 4



UPDATE #listClientIds_Exchange

SET isBackupDisabled = @LICENSE_RELEASED

FROM APP_Application(NOLOCK) AA

WHERE AA.id = #listClientIds_Exchange.subclientId AND subclientStatus &amp; 0x02 = 0x02



UPDATE #listClientIds_Exchange

SET isBackupDisabled = @EXCLUDED_FROM_SLA

FROM APP_SubClientProp ASP WITH (NOLOCK)

WHERE ASP.componentNameId = #listClientIds_Exchange.subclientId AND ASP.attrName = 'Exclude From SLA' AND ASP.attrVal = 1 AND ASP.modified = 0



UPDATE #listClientIds_Exchange

SET isBackupDisabled = @TENANT_DIACTIVEVATED

WHERE clientId IN (SELECT DISTINCT CGA.clientId

	FROM UMDSProviders UMDS WITH (NOLOCK)

	JOIN App_CompanyProp CP WITH (NOLOCK) ON CP.attrName = 'Associated Smart Client Group' AND CP.modified = 0 AND UMDS.id = CP.componentNameId

	JOIN APP_ClientGroupAssoc CGA WITH (NOLOCK) ON CAST(CGA.clientGroupId AS NVARCHAR(16)) = CP.attrVal

	WHERE UMDS.flags &amp; 0x0010 = 0x0010 OR enabled = 0)



IF @includeBackupDisabledClients = 0

	DELETE FROM #listClientIds_Exchange WHERE isBackupDisabled IN (1, @TENANT_DIACTIVEVATED, @LICENSE_RELEASED, @EXCLUDED_FROM_SLA)



IF OBJECT_ID('tempdb.dbo.#temp_unprotected_mailboxes_sla') IS NOT NULL

	DROP TABLE #temp_unprotected_mailboxes_sla



CREATE TABLE #temp_unprotected_mailboxes_sla

(

	created BIGINT,

	backupReferenceTime BIGINT,

	mailboxType INT,

	isProtected INT,

	clientId INT

)

CREATE CLUSTERED INDEX #Idx1_temp_unprotected_mailboxes_sla_clientId ON #temp_unprotected_mailboxes_sla(clientId)



INSERT INTO #temp_unprotected_mailboxes_sla (created, backupReferenceTime, mailboxType, isProtected, clientId)

SELECT created, backupReferenceTime, msExchRecipientTypeDetails,

(CASE WHEN (backupReferenceTime &lt; @startTime OR backupReferenceTime IS NULL) THEN 0/*unprotected*/ ELSE 1/*protected*/ END), TE.clientId

FROM APP_EmailConfigPolicyAssoc E WITH (NOLOCK)

INNER JOIN #listClientIds_Exchange TE ON TE.subclientId = E.subClientId

WHERE discoverByType = 1 AND E.modified = 0 AND E.status = 0 /*Active*/ AND E.smtpAdrress IS NOT NULL AND E.mailBoxType = 1



IF OBJECT_ID('tempdb.dbo.#exchange_client_sla') IS NOT NULL

	DROP TABLE #exchange_client_sla



CREATE TABLE #exchange_client_sla

(

	clientId INT UNIQUE CLUSTERED,

	clientName NVARCHAR(255),

	clientDisplayName NVARCHAR(255),

	totalEntities BIGINT,

	slaMissedEntities BIGINT,

	neverBackedUp INT,

	recentlyAddedEntities BIGINT,

	needAttention INT,

	clientStatus NVARCHAR(32) DEFAULT 'Active',

	lastIndexPlaybackTime BIGINT,

	lastIndexBkpJobId INT,

	lastIndexErrorTime BIGINT,

	lastDiscoverTime BIGINT,

	lastBackupJobRunTime BIGINT,

	lastBackupJobId BIGINT,

	applicationSize BIGINT,

	numberOfItems BIGINT,

	itemsContentIndexed BIGINT,

	azureApps INT DEFAULT 0,

	authoziedAzureApps INT DEFAULT 0,

	lastVerifyConnectionTime BIGINT,

	streams INT,

	isModernAuthEnabled INT,

	accessNodeGroupId INT,

	accessNodeGroupDisplayName NVARCHAR(255),

	indexServerId INT,

	indexServerCloudId INT,

	indexServerName NVARCHAR(255),

	indexServerDisplayName NVARCHAR(255),

	clienturl NVARCHAR(2048),

	activejobsurl NVARCHAR(2048),

	indexServerUrl NVARCHAR(2048),

	accessNodeGroupUrl NVARCHAR(2048)

)



INSERT INTO #exchange_client_sla (clientId, totalEntities, slaMissedEntities, neverBackedUp, recentlyAddedEntities, needAttention)

SELECT 

clientId,

COUNT(*),

SUM(CASE WHEN isProtected = 0 THEN 1 ELSE 0 END),

SUM(CASE WHEN backupReferenceTime IS NULL OR backupReferenceTime = 0 THEN 1 ELSE 0 END),

SUM(CASE WHEN created IS NOT NULL AND created &gt;= @recentlyAddedRefTime THEN 1 ELSE 0 END),

SUM(CASE WHEN (backupReferenceTime IS NULL OR backupReferenceTime = 0) AND @recentlyAddedRefTime &gt; created THEN 1 ELSE 0 END)

FROM #temp_unprotected_mailboxes_sla

GROUP BY clientId



INSERT INTO #exchange_client_sla (clientId, totalEntities, slaMissedEntities, neverBackedUp, recentlyAddedEntities, needAttention)

SELECT clientId, 0, 0, 0, 0, 0

FROM #listClientIds_Exchange TE

WHERE TE.clientId NOT IN (SELECT clientId FROM #exchange_client_sla) AND isO365Client = 1



UPDATE #exchange_client_sla

SET clientName = AC.name, clientDisplayName = AC.displayName

FROM APP_Client AC WITH (NOLOCK)

WHERE #exchange_client_sla.clientId = AC.id



UPDATE #exchange_client_sla

SET lastIndexPlaybackTime = Idx.playbackTime, lastIndexBkpJobId = Idx.bkpJobId, lastIndexErrorTime = Idx.errorTime, applicationSize = Idx.backupSize, numberOfItems = idx.numberOfItems, itemsContentIndexed = Idx.itemsContentIndexed

FROM

(

	SELECT I.properties.value('Indexing_DbStats[1]/@lastPlayedBkpTime', 'BIGINT') AS playbackTime, I.properties.value('(Indexing_DbStats/apps)[1]/@lastPlayedBkpJobId', 'INT') AS bkpJobId, 

	I.properties.value('Indexing_DbStats[1]/@lastIdxErrorTime', 'INT') AS errorTime, TE.clientId AS clientId,

	ISNULL(I.properties.value('(Indexing_DbStats/apps/stat)[1]/@applicationSize', 'BIGINT'), 0) AS backupSize, ISNULL(I.properties.value('(Indexing_DbStats/apps/stat)[1]/@itemsIndexed', 'BIGINT'), 0) AS numberOfItems,

	ISNULL(I.properties.value('(Indexing_DbStats/apps/stat)[1]/@itemsContentIndexed', 'BIGINT'), 0) AS itemsContentIndexed

	FROM IdxDbState I WITH (NOLOCK)

	INNER JOIN App_IndexDbInfo AI WITH (NOLOCK) ON I.dbid = AI.id

	INNER JOIN #listClientIds_Exchange TE ON AI.backupSetId = TE.backupsetId

) Idx WHERE Idx.clientId = #exchange_client_sla.clientId



UPDATE #exchange_client_sla

SET lastDiscoverTime = DS.value('App_Office365DiscoverState[1]/@lastCacheUpdateTime', 'BIGINT')

FROM

(

	SELECT AIN.clientId AS clientId, CAST(CAST(attrVal AS VARCHAR(MAX)) AS XML) AS DS

	FROM App_IdaProp AIP WITH (NOLOCK)

	INNER JOIN App_IdaName AIN WITH (NOLOCK) ON AIP.componentNameId = AIN.id AND AIN.appTypeId = @CV_APPTYPE_EXCHANGE_ONEPASS

	WHERE AIN.clientId IN (select clientId FROM #listClientIds_Exchange) AND AIP.attrName = 'Discovery State' AND AIP.modified = 0

) D WHERE D.clientId = #exchange_client_sla.clientId



UPDATE #exchange_client_sla

SET lastBackupJobRunTime = LBJ.value('(lastBackupJobInfo/endTime)[1]/@time', 'BIGINT'), lastBackupJobId = LBJ.value('(lastBackupJobInfo)[1]/@jobID', 'BIGINT')

FROM

(

	SELECT AIN.clientId AS clientId, CAST(CAST(attrVal AS VARCHAR(MAX)) AS XML) AS LBJ

	FROM App_IdaProp AIP WITH (NOLOCK)

	INNER JOIN App_IdaName AIN WITH (NOLOCK) ON AIP.componentNameId = AIN.id AND AIN.appTypeId = @CV_APPTYPE_EXCHANGE_ONEPASS

	WHERE AIN.clientId IN (select clientId FROM #listClientIds_Exchange) AND AIP.attrName = 'Last Backup Job Info' AND AIP.modified = 0

) D WHERE D.clientId = #exchange_client_sla.clientId



IF @includeBackupDisabledClients = 1

	UPDATE #exchange_client_sla

	SET clientStatus = (CASE 

							WHEN isBackupDisabled = 1 THEN 'Backup Activity is Disabled'

							WHEN isBackupDisabled = @TENANT_DIACTIVEVATED THEN 'Tenant Deactivated/Disabled'

							WHEN isBackupDisabled = @LICENSE_RELEASED THEN 'License Released'

							WHEN isBackupDisabled = @EXCLUDED_FROM_SLA THEN 'Excluded From SLA'

							ELSE 'Active'

						END)

	FROM #listClientIds_Exchange

	WHERE #exchange_client_sla.clientId = #listClientIds_Exchange.clientId AND isBackupDisabled IN (1, @TENANT_DIACTIVEVATED, @LICENSE_RELEASED, @EXCLUDED_FROM_SLA)



UPDATE #exchange_client_sla

SET isModernAuthEnabled = ISNULL(CAST(AIP.attrVal AS INT), 0)

FROM #listClientIds_Exchange TE

INNER JOIN App_IdaName AIN WITH (NOLOCK) ON TE.clientId = AIN.clientId

INNER JOIN App_IdaProp AIP WITH (NOLOCK) ON AIN.id = AIP.componentNameId

WHERE #exchange_client_sla.clientId = TE.clientId AND attrName = 'Exchange Modern Auth' AND AIP.modified = 0 AND AIN.appTypeId = @CV_APPTYPE_EXCHANGE_ONEPASS



UPDATE #exchange_client_sla

SET azureApps = CAST(CAST(AIP.attrVal AS VARCHAR(MAX)) AS XML).value('count(/App_Office365AzureConnections/azureApps)', 'int'),

	authoziedAzureApps = CAST(CAST(AIP.attrVal AS VARCHAR(MAX)) AS XML).value('count(/App_Office365AzureConnections//*[@appStatus="1"])', 'int')

FROM #listClientIds_Exchange TE

INNER JOIN App_IdaName AIN WITH (NOLOCK) ON TE.clientId = AIN.clientId

INNER JOIN App_IdaProp AIP WITH (NOLOCK) ON AIN.id = AIP.componentNameId

WHERE #exchange_client_sla.clientId = TE.clientId AND attrName = 'Exchange Azure Connections' AND AIP.modified = 0 AND AIN.appTypeId = @CV_APPTYPE_EXCHANGE_ONEPASS



UPDATE #exchange_client_sla

SET authoziedAzureApps = CAST(CAST(AIP.attrVal AS VARCHAR(MAX)) AS XML).value('count(/App_Office365AzureConnectionsStatus/azureAppList//*[@appStatus="1"])', 'int'),

    lastVerifyConnectionTime = CAST(CAST(AIP.attrVal AS VARCHAR(MAX)) AS XML).value('(//@lastAzureAppStatusUpdate)[1]', 'BIGINT')

FROM #listClientIds_Exchange TE

INNER JOIN App_IdaName AIN WITH (NOLOCK) ON TE.clientId = AIN.clientId

INNER JOIN App_IdaProp AIP WITH (NOLOCK) ON AIN.id = AIP.componentNameId

WHERE #exchange_client_sla.clientId = TE.clientId AND attrName = 'Office365 Azure Connections Status' AND AIP.modified = 0 AND AIN.appTypeId = @CV_APPTYPE_EXCHANGE_ONEPASS



UPDATE #exchange_client_sla

SET streams = CAST(attrVal AS INT)

FROM #listClientIds_Exchange TE

INNER JOIN APP_SubClientProp ASP WITH (NOLOCK) ON TE.subclientId = ASP.componentNameId

WHERE #exchange_client_sla.clientId = TE.clientId AND attrName = 'sys:nStreamsExchange' AND modified = 0



UPDATE #exchange_client_sla

SET accessNodeGroupId = CAST(CAST(attrVal AS VARCHAR(MAX)) AS XML).value('(//@clientGroupId)[1]', 'int'),

	accessNodeGroupDisplayName = CAST(CAST(attrVal AS VARCHAR(MAX)) AS XML).value('(//@clientGroupName)[1]', 'nvarchar(max)')

FROM #listClientIds_Exchange TE

INNER JOIN APP_IDAName AIN WITH (NOLOCK) ON TE.clientId = AIN.clientId

INNER JOIN APP_IDAProp AIP WITH (NOLOCK) ON AIN.id = AIP.componentNameId

WHERE #exchange_client_sla.clientId = TE.clientId AND attrName = 'OnePass Member Servers' AND AIP.modified = 0 AND AIN.appTypeId = @CV_APPTYPE_EXCHANGE_ONEPASS



UPDATE #exchange_client_sla

SET indexServerId = AIP.attrVal

FROM #listClientIds_Exchange TE 

INNER JOIN App_IdaName AIN WITH (NOLOCK) ON TE.clientId = AIN.clientId AND AIN.appTypeId = @CV_APPTYPE_EXCHANGE_ONEPASS

INNER JOIN App_IdaProp AIP WITH (NOLOCK) ON AIP.componentNameId = AIN.id

WHERE #exchange_client_sla.clientId = TE.clientId AND AIP.attrName = 'OnePass Index Server' AND AIP.modified = 0



UPDATE #exchange_client_sla

SET indexServerCloudId = ISNULL(DC.cloudId, 0)

FROM DM2Cloud DC WITH (NOLOCK)

WHERE #exchange_client_sla.indexServerId = DC.pseudoClientId



UPDATE #exchange_client_sla

SET indexServerName = AC.name, indexServerDisplayName = AC.displayName

FROM APP_Client AC WITH (NOLOCK)

WHERE #exchange_client_sla.indexServerId = AC.id



UPDATE #exchange_client_sla

SET clienturl = (CASE WHEN TE.isO365Client = 1 

					THEN '#/office365/clientDetails/' + clientName + '/' + CAST(TE.clientId AS NVARCHAR(64)) + '/' + CAST(TE.subclientId AS NVARCHAR(64)) + '/users?backupsetId=' + CAST(TE.backupsetId AS NVARCHAR(64))

					ELSE '#/exchange/clientDetails/' + clientName + '/' + CAST(TE.clientId AS NVARCHAR(64)) + '/' + CAST(TE.subclientId AS NVARCHAR(64)) + '/users?backupsetName=User%20Mailbox&amp;backupsetId=' + CAST(TE.backupsetId AS NVARCHAR(64))

				END),

	activejobsurl = '#/activeJobs?backupsetId=' + CAST(TE.backupsetId AS NVARCHAR(64)) + '&amp;activeJobs=0&amp;serverName=' + clientName + '&amp;serverId=' + CAST(TE.clientId AS NVARCHAR(64)) + '&amp;applicationId=137',

	indexServerUrl = '#/indexServer/configuration/' + CAST(indexServerId AS NVARCHAR(64)) + '?name=' + indexServerName + '&amp;cloudId=' + CAST(indexServerCloudId AS NVARCHAR(64)),

	accessNodeGroupUrl = '#/clientGroupDetails/' + CAST(accessNodeGroupId AS NVARCHAR(64))

FROM #listClientIds_Exchange TE

WHERE #exchange_client_sla.clientId = TE.clientId



SELECT

clientDisplayName AS 'Client',

clientStatus AS 'Client Status',

(CASE WHEN lastIndexPlaybackTime IS NOT NULL AND lastIndexPlaybackTime &gt;= @startTime THEN 'UpToDate' ELSE 'Pending playback' END) AS 'Index Status',

(CASE WHEN lastIndexBkpJobId IS NOT NULL AND lastIndexBkpJobId &gt; 0 THEN CAST(lastIndexBkpJobId AS VARCHAR(64)) ELSE '' END) AS 'Last Indexed Backup JobId',

(CASE WHEN lastIndexPlaybackTime IS NOT NULL AND lastIndexPlaybackTime &gt; 0 

	THEN (SELECT DATEADD(ss, lastIndexPlaybackTime + @browserBias, CAST('1970-01-01 00:00' AS DATETIME)))

END) AS 'Last Index Time',

(CASE WHEN lastIndexErrorTime IS NOT NULL AND lastIndexErrorTime &gt; 0 

	THEN (SELECT DATEADD(ss, lastIndexErrorTime + @browserBias, CAST('1970-01-01 00:00' AS DATETIME)))

END) AS 'Last Index Error Time',

(CASE WHEN lastDiscoverTime IS NOT NULL AND lastDiscoverTime &gt; 0 

	THEN (SELECT DATEADD(ss, lastDiscoverTime + @browserBias, CAST('1970-01-01 00:00' AS DATETIME)))

END) AS 'Last Discovery Time',

(CASE WHEN ISNULL(lastBackupJobRunTime, 0) &gt; 0 

	THEN (SELECT DATEADD(ss, lastBackupJobRunTime + @browserBias, CAST('1970-01-01 00:00' AS DATETIME)))

END) AS 'Last Backup Run Time',

(CASE

	WHEN ISNULL(lastBackupJobId, 0) &gt; 0 THEN CAST(lastBackupJobId AS VARCHAR(64))

	ELSE ''

END) AS 'Last Backup Job ID',

totalEntities AS 'Associated Mailboxes',

(totalEntities - slaMissedEntities) AS 'Mailboxes Backed-up',

slaMissedEntities AS 'Mailboxes Not Backed-up',

(totalEntities - neverBackedUp) AS 'Mailboxes Backed-up (at least once)',

neverBackedUp AS 'Mailboxes Never Backed-up',

recentlyAddedEntities AS 'Mailboxes Recently Added',

needAttention AS 'Mailboxes Need Attention',

applicationSize AS 'Application Size',

numberOfItems AS 'Number of Emails',

itemsContentIndexed AS 'Indexed Emails',

azureApps AS 'Azure Apps Associated',

azureApps - authoziedAzureApps AS 'Azure Apps Not Authorized',

(CASE 

	WHEN isModernAuthEnabled = 1 AND totalEntities &lt; @MAX_USERS_FOR_FIVE_CONNECTIONS AND azureApps &lt; 5 THEN 5 - azureApps

	WHEN isModernAuthEnabled = 1 AND totalEntities &gt;= @MAX_USERS_FOR_FIVE_CONNECTIONS AND azureApps &lt; 10 THEN 10 - azureApps

	ELSE 0 

END) AS 'Azure Apps To Be Added',

(CASE

	WHEN ISNULL(lastVerifyConnectionTime, 0) &gt; 0 THEN (SELECT DATEADD(ss, lastVerifyConnectionTime + @browserBias, CAST('1970-01-01 00:00' AS DATETIME)))

END) AS 'Last Verify Connection Time',

streams AS 'Max Streams',

ISNULL(accessNodeGroupDisplayName, '') AS 'Access Node Group',

ISNULL(indexServerDisplayName, '') AS 'Index Server',

'Active Jobs' AS 'Active Jobs',

(CASE WHEN lastIndexBkpJobId IS NOT NULL AND lastIndexBkpJobId &gt; 0 

	THEN '#/jobs/' + CAST(lastIndexBkpJobId AS NVARCHAR(256))

	ELSE ''

END) AS 'joburl',

(CASE WHEN ISNULL(lastBackupJobId, 0) &gt; 0

	THEN '#/jobs/' + CAST(lastBackupJobId AS NVARCHAR(256))

	ELSE ''

END) AS 'backupjoburl',

clienturl AS 'clienturl',

activejobsurl AS 'activejobsurl',

ISNULL(accessNodeGroupUrl, '') AS 'accessNodeGroupUrl',

indexserverurl AS 'indexserverurl'

FROM #exchange_client_sla

ORDER BY totalEntities DESC



IF OBJECT_ID('tempdb.dbo.#listClientIds_Exchange') IS NOT NULL

	DROP TABLE #listClientIds_Exchange



IF OBJECT_ID('tempdb.dbo.#exchange_client_sla') IS NOT NULL

	DROP TABLE #exchange_client_sla



IF OBJECT_ID('tempdb.dbo.#temp_unprotected_mailboxes_sla') IS NOT NULL

	DROP TABLE #temp_unprotected_mailboxes_sla</sqlText>
              <timeout>5</timeout>
              <postQueryFilter>true</postQueryFilter>
              <rDataSetQuery />
              <rPlotQuery />
            </GetOperation>
            <description>Backup Health Report for Office 365 Clients.</description>
            <databaseName>CommServ</databaseName>
            <queryPlan>
              <offline>false</offline>
              <collectionType>HTTP</collectionType>
              <retentionDays>1</retentionDays>
              <versions>
                <CommCellVersion>ALL</CommCellVersion>
              </versions>
              <dynamicCollection>false</dynamicCollection>
              <frequency>60</frequency>
              <direct>false</direct>
            </queryPlan>
            <version>144</version>
            <guid>580a59f2-6033-4d8a-849d-d787d1b9b701</guid>
            <hidden>true</hidden>
            <revision />
            <computedColumns>
              <scriptName>R</scriptName>
              <script />
              <columnList />
            </computedColumns>
          </DataSet>
          <DataSet>
            <dataSet>
              <dataSetName>Clients Discovery</dataSetName>
              <dataSetGuid>0e1f9ee2-72a6-4fb7-aef0-ee3c3b33d5ee</dataSetGuid>
            </dataSet>
            <endpoint>DATASET</endpoint>
            <shared>false</shared>
            <dataSources>
              <DataSource>
                <connectionType>COMMCELL</connectionType>
                <commCell>
                  <commCellName>$LocalCommCell$</commCellName>
                </commCell>
              </DataSource>
            </dataSources>
            <allColumns>false</allColumns>
            <fields>
              <Column>
                <name>sys_rowid</name>
                <dataField>$row_number$</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Data Source</name>
                <dataField>Data Source</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Client</name>
                <dataField>Client</dataField>
                <type>String</type>
              </Column>
            </fields>
            <GetOperation>
              <parameters>
                <Parameter>
                  <name>Clients</name>
                  <dataType>Integer</dataType>
                  <isList>true</isList>
                  <values>
                    <string>=input.ExchangeClients</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>ClientGroups</name>
                  <dataType>Integer</dataType>
                  <isList>true</isList>
                  <values>
                    <string>=input.ClientGroups</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>timeframe</name>
                  <dataType>DateRange</dataType>
                  <values>
                    <string>=input.Timeframe</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>Options</name>
                  <dataType>String</dataType>
                  <isList>true</isList>
                  <values>
                    <string>=input.Options</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>natimeframe</name>
                  <dataType>DateRange</dataType>
                  <values>
                    <string>=input.NATimeRange</string>
                  </values>
                </Parameter>
              </parameters>
              <sqlText>SELECT Client FROM :[Exchange Client SLA]
WHERE [Last Discovery Time] &lt; @natimeframe_from OR [Last Discovery Time] IS NULL</sqlText>
              <timeout>5</timeout>
              <postQueryFilter>true</postQueryFilter>
              <rDataSetQuery />
              <rPlotQuery />
            </GetOperation>
            <description>Backup Health Report for Office 365 Clients.</description>
            <databaseName>CommServ</databaseName>
            <queryPlan>
              <offline>false</offline>
              <retentionDays>1</retentionDays>
              <versions>
                <CommCellVersion>ALL</CommCellVersion>
              </versions>
              <dynamicCollection>false</dynamicCollection>
              <frequency>60</frequency>
              <direct>true</direct>
            </queryPlan>
            <version>85</version>
            <guid>0e1f9ee2-72a6-4fb7-aef0-ee3c3b33d5ee</guid>
            <hidden>true</hidden>
            <revision />
          </DataSet>
          <DataSet>
            <dataSet>
              <dataSetName>Clients Index</dataSetName>
              <dataSetGuid>d0c48c4b-5297-41c5-eb32-7d49c3329bcc</dataSetGuid>
            </dataSet>
            <endpoint>DATASET</endpoint>
            <shared>false</shared>
            <dataSources>
              <DataSource>
                <connectionType>COMMCELL</connectionType>
                <commCell>
                  <commCellName>$LocalCommCell$</commCellName>
                </commCell>
              </DataSource>
            </dataSources>
            <allColumns>false</allColumns>
            <fields>
              <Column>
                <name>sys_rowid</name>
                <dataField>$row_number$</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Data Source</name>
                <dataField>Data Source</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Client</name>
                <dataField>Client</dataField>
                <type>String</type>
              </Column>
            </fields>
            <GetOperation>
              <parameters>
                <Parameter>
                  <name>Clients</name>
                  <dataType>Integer</dataType>
                  <isList>true</isList>
                  <values>
                    <string>=input.ExchangeClients</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>ClientGroups</name>
                  <dataType>Integer</dataType>
                  <isList>true</isList>
                  <values>
                    <string>=input.ClientGroups</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>timeframe</name>
                  <dataType>DateRange</dataType>
                  <values>
                    <string>=input.Timeframe</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>Options</name>
                  <dataType>String</dataType>
                  <isList>true</isList>
                  <values>
                    <string>=input.Options</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>natimeframe</name>
                  <dataType>DateRange</dataType>
                  <values>
                    <string>=input.NATimeRange</string>
                  </values>
                </Parameter>
              </parameters>
              <sqlText>SELECT Client FROM :[Exchange Client SLA]
WHERE [Last Index Time] &lt; @natimeframe_from OR [Last Index Time] IS NULL</sqlText>
              <timeout>5</timeout>
              <postQueryFilter>true</postQueryFilter>
              <rDataSetQuery />
              <rPlotQuery />
            </GetOperation>
            <description>Backup Health Report for Office 365 Clients.</description>
            <databaseName>CommServ</databaseName>
            <queryPlan>
              <offline>false</offline>
              <retentionDays>1</retentionDays>
              <versions>
                <CommCellVersion>ALL</CommCellVersion>
              </versions>
              <dynamicCollection>false</dynamicCollection>
              <frequency>60</frequency>
              <direct>true</direct>
            </queryPlan>
            <version>84</version>
            <guid>d0c48c4b-5297-41c5-eb32-7d49c3329bcc</guid>
            <hidden>true</hidden>
            <revision />
          </DataSet>
        </dataSet>
      </dataSets>
      <inputs>
        <RptInput>
          <id>CommCell</id>
          <displayName>CommCell</displayName>
          <defaultValue>2</defaultValue>
          <type>Commcell</type>
          <controlType>ListBox</controlType>
          <required>false</required>
          <allowMultipleSelection>true</allowMultipleSelection>
          <fromDataSet>true</fromDataSet>
          <dataSetEntity>
            <dataSetName>CommcellList</dataSetName>
            <dataSetGuid>36711099-c17b-4857-b2d6-2d26e52c6aec</dataSetGuid>
          </dataSetEntity>
          <labelField>CCHostName</labelField>
          <valueField>id</valueField>
          <dependsOn />
          <relativeOptions />
        </RptInput>
        <RptInput>
          <id>ExchangeClients</id>
          <displayName>Exchange Clients</displayName>
          <defaultValue />
          <type>Integer</type>
          <controlType>ListBox</controlType>
          <required>false</required>
          <allowMultipleSelection>true</allowMultipleSelection>
          <hideAllSelection>true</hideAllSelection>
          <fromDataSet>true</fromDataSet>
          <dataSetEntity>
            <dataSetId>1467</dataSetId>
            <dataSetName>Clients</dataSetName>
            <dataSetGuid>93d702e9-9993-4480-95b6-219fd0b50979</dataSetGuid>
          </dataSetEntity>
          <labelField>displayName</labelField>
          <valueField>id</valueField>
          <dependsOn />
          <relativeOptions />
          <sort>
            <columnId>displayName</columnId>
            <direction>Asc</direction>
          </sort>
        </RptInput>
        <RptInput>
          <id>ClientGroups</id>
          <displayName>Companies/Client Groups</displayName>
          <type>Integer</type>
          <controlType>ListBox</controlType>
          <required>false</required>
          <allowMultipleSelection>true</allowMultipleSelection>
          <hideAllSelection>true</hideAllSelection>
          <fromDataSet>true</fromDataSet>
          <dataSetEntity>
            <dataSetId>1469</dataSetId>
            <dataSetName>Exchange Client Groups</dataSetName>
            <dataSetGuid>ca913a5e-152a-44c0-d028-6a9e26e648b8</dataSetGuid>
          </dataSetEntity>
          <labelField>groupName</labelField>
          <valueField>groupId</valueField>
          <dependsOn />
          <relativeOptions />
          <sort>
            <columnId>groupName</columnId>
            <direction>Asc</direction>
          </sort>
        </RptInput>
        <RptInput>
          <id>Timeframe</id>
          <displayName>Time frame</displayName>
          <defaultValue>-P3D P0D</defaultValue>
          <possibleValueLabels>
            <string>Last 1 Days</string>
            <string>Last 2 Days</string>
            <string>Last 3 Days</string>
            <string>Last 7 Days</string>
            <string>Last 30 Days</string>
          </possibleValueLabels>
          <possibleValues>
            <string>-P1D P0D</string>
            <string>-P2D P0D</string>
            <string>-P3D P0D</string>
            <string>-P7D P0D</string>
            <string>-P30D P0D</string>
          </possibleValues>
          <type>DateRange</type>
          <controlType>DateRange</controlType>
          <required>false</required>
          <allowMultipleSelection>false</allowMultipleSelection>
          <fromDataSet>false</fromDataSet>
          <includeTime>false</includeTime>
          <dependsOn />
          <relativeOptions>
            <string>Last</string>
          </relativeOptions>
          <relativeUnits>
            <string>Days</string>
          </relativeUnits>
        </RptInput>
        <RptInput>
          <id>Options</id>
          <displayName>Options</displayName>
          <possibleValueLabels>
            <string>Show backup disabled clients</string>
            <string>Show all mailboxes</string>
          </possibleValueLabels>
          <possibleValues>
            <string>Show backup disabled clients</string>
            <string>Show all mailboxes</string>
          </possibleValues>
          <type>String</type>
          <controlType>ListBox</controlType>
          <required>false</required>
          <allowMultipleSelection>false</allowMultipleSelection>
          <fromDataSet>false</fromDataSet>
          <dependsOn />
          <relativeOptions />
        </RptInput>
        <RptInput>
          <id>NATimeRange</id>
          <displayName>Need Attention Time Range</displayName>
          <defaultValue>-P7D P0D</defaultValue>
          <possibleValueLabels>
            <string>Last 7 Days</string>
          </possibleValueLabels>
          <possibleValues>
            <string>-P7D P0D</string>
          </possibleValues>
          <type>DateRange</type>
          <controlType>DateRange</controlType>
          <required>false</required>
          <fromDataSet>false</fromDataSet>
          <hidden>true</hidden>
          <dependsOn />
          <relativeOptions>
            <string>Last</string>
          </relativeOptions>
          <relativeUnits>
            <string>Days</string>
          </relativeUnits>
        </RptInput>
      </inputs>
      <body>{
    "reportComponents": [
        {
            "type": "HITS",
            "dataSet": {
                "dataSetId": 1221,
                "dataSetName": "Exchange Client SLA",
                "dataSetGuid": "580a59f2-6033-4d8a-849d-d787d1b9b701",
                "originalDataSetName": "Exchange Client SLA"
            },
            "title": {
                "text": ""
            },
            "id": "Hits1620293333956",
            "mobile": {
                "visible": "On",
                "listItemClick": {},
                "customListLayout": null
            },
            "hideComponent": false,
            "blankComponent": false,
            "filters": {
                "builder": {},
                "viewer": {}
            },
            "visible": {},
            "orientation": "vertical",
            "color": {
                "backgroundColor": "#ffffff"
            },
            "iconPosition": "left",
            "hideHeader": true,
            "measureDataField": [
                {
                    "column": "Associated Mailboxes",
                    "type": "Long",
                    "showNumberOps": true,
                    "aggrType": "Sum",
                    "captionPosition": "top",
                    "color": {
                        "captionColor": "#000",
                        "countColor": "#000"
                    },
                    "alignment": "center",
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    },
                    "displayText": "Associated Mailboxes"
                }
            ],
            "isGroupBy": true,
            "hideborder": false,
            "hideLoadingAnimation": false,
            "toolTip": "Total number of active mailboxes associated to the client(s)",
            "iconHtml": "",
            "additionalProperties": false
        },
        {
            "type": "HITS",
            "dataSet": {
                "dataSetId": 1221,
                "dataSetName": "Exchange Client SLA",
                "dataSetGuid": "580a59f2-6033-4d8a-849d-d787d1b9b701",
                "originalDataSetName": "Exchange Client SLA"
            },
            "title": {
                "text": ""
            },
            "id": "Hits1620293341250",
            "mobile": {
                "visible": "On",
                "listItemClick": {},
                "customListLayout": null
            },
            "hideComponent": false,
            "blankComponent": false,
            "filters": {
                "builder": {},
                "viewer": {}
            },
            "color": {
                "backgroundColor": "#ffffff"
            },
            "iconPosition": "left",
            "hideHeader": true,
            "measureDataField": [
                {
                    "column": "Mailboxes Backed-up",
                    "type": "Long",
                    "showNumberOps": true,
                    "aggrType": "Sum",
                    "captionPosition": "top",
                    "color": {
                        "captionColor": "#000",
                        "countColor": "#000"
                    },
                    "alignment": "center",
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    },
                    "displayText": "Mailboxes Backed-up"
                }
            ],
            "isGroupBy": true,
            "toolTip": "Total number of mailboxes backed-up in the selected time period",
            "visible": {},
            "orientation": "vertical",
            "additionalProperties": false
        },
        {
            "type": "HITS",
            "dataSet": {
                "dataSetId": 1221,
                "dataSetName": "Exchange Client SLA",
                "dataSetGuid": "580a59f2-6033-4d8a-849d-d787d1b9b701",
                "originalDataSetName": "Exchange Client SLA"
            },
            "title": {
                "text": ""
            },
            "id": "Hits1620293346865",
            "mobile": {
                "visible": "On",
                "listItemClick": {},
                "customListLayout": null
            },
            "hideComponent": false,
            "blankComponent": false,
            "filters": {
                "builder": {},
                "viewer": {}
            },
            "color": {
                "backgroundColor": "#ffffff"
            },
            "iconPosition": "left",
            "hideHeader": true,
            "measureDataField": [
                {
                    "column": "Mailboxes Not Backed-up",
                    "type": "Long",
                    "showNumberOps": true,
                    "aggrType": "Sum",
                    "captionPosition": "top",
                    "color": {
                        "captionColor": "#000",
                        "countColor": "#000"
                    },
                    "alignment": "center",
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    },
                    "displayText": "Mailboxes Not Backed-up"
                }
            ],
            "isGroupBy": true,
            "toolTip": "Total number of mailboxes not backed-up in the selected time period",
            "additionalProperties": false
        },
        {
            "type": "HITS",
            "dataSet": {
                "dataSetId": 1497,
                "dataSetName": "Exchange Client SLA",
                "dataSetGuid": "580a59f2-6033-4d8a-849d-d787d1b9b701",
                "originalDataSetName": "Exchange Client SLA"
            },
            "title": {
                "text": ""
            },
            "id": "Hits1623238901811",
            "mobile": {
                "visible": "On",
                "listItemClick": {},
                "customListLayout": null
            },
            "hideComponent": false,
            "blankComponent": false,
            "filters": {
                "builder": {},
                "viewer": {}
            },
            "color": {
                "backgroundColor": "#ffffff"
            },
            "iconPosition": "left",
            "hideHeader": true,
            "measureDataField": [
                {
                    "column": "Mailboxes Backed-up (at least once)",
                    "type": "Long",
                    "showNumberOps": true,
                    "aggrType": "Sum",
                    "captionPosition": "top",
                    "color": {
                        "captionColor": "#000",
                        "countColor": "#000"
                    },
                    "alignment": "center",
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    },
                    "displayText": "Mailboxes Backed-up (at least once)"
                }
            ],
            "isGroupBy": true,
            "toolTip": "Total number of mailboxes backed-up at least once",
            "additionalProperties": false,
            "visible": {
                "type": "all",
                "expression": "=!(cv.isAdminOnCommcellLevel || cv.isMspAdmin || cv.isMspUser)"
            },
            "orientation": "vertical"
        },
        {
            "type": "HITS",
            "dataSet": {
                "dataSetId": 1221,
                "dataSetName": "Exchange Client SLA",
                "dataSetGuid": "580a59f2-6033-4d8a-849d-d787d1b9b701",
                "originalDataSetName": "Exchange Client SLA"
            },
            "title": {
                "text": ""
            },
            "id": "Hits1620293351486",
            "mobile": {
                "visible": "On",
                "listItemClick": {},
                "customListLayout": null
            },
            "hideComponent": false,
            "blankComponent": false,
            "filters": {
                "builder": {},
                "viewer": {}
            },
            "color": {
                "backgroundColor": "#ffffff"
            },
            "iconPosition": "left",
            "hideHeader": true,
            "measureDataField": [
                {
                    "column": "Mailboxes Never Backed-up",
                    "type": "Integer",
                    "showNumberOps": true,
                    "aggrType": "Sum",
                    "captionPosition": "top",
                    "color": {
                        "captionColor": "#000",
                        "countColor": "#000"
                    },
                    "alignment": "center",
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    },
                    "displayText": "Mailboxes Never Backed-up"
                }
            ],
            "isGroupBy": true,
            "toolTip": "Total number of mailboxes never backed-up",
            "additionalProperties": false,
            "visible": {
                "type": "all",
                "expression": "=!(cv.isAdminOnCommcellLevel || cv.isMspAdmin || cv.isMspUser)"
            }
        },
        {
            "type": "HITS",
            "dataSet": {
                "dataSetId": 1497,
                "dataSetName": "Exchange Client SLA",
                "dataSetGuid": "580a59f2-6033-4d8a-849d-d787d1b9b701",
                "originalDataSetName": "Exchange Client SLA"
            },
            "title": {
                "text": ""
            },
            "id": "Hits1623238925058",
            "mobile": {
                "visible": "On",
                "listItemClick": {},
                "customListLayout": null
            },
            "hideComponent": false,
            "blankComponent": false,
            "filters": {
                "builder": {},
                "viewer": {}
            },
            "color": {
                "backgroundColor": "#ffffff"
            },
            "iconPosition": "left",
            "hideHeader": true,
            "measureDataField": [
                {
                    "column": "Mailboxes Recently Added",
                    "type": "Long",
                    "showNumberOps": true,
                    "aggrType": "Sum",
                    "captionPosition": "top",
                    "color": {
                        "captionColor": "#000",
                        "countColor": "#000"
                    },
                    "alignment": "center",
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    },
                    "displayText": "Mailboxes Recently Added"
                }
            ],
            "isGroupBy": true,
            "toolTip": "Total number of mailboxes added in the last 7 days (This is a tentative value and might not be accurate)",
            "additionalProperties": false,
            "visible": {
                "type": "all",
                "expression": "=!(cv.isAdminOnCommcellLevel || cv.isMspAdmin || cv.isMspUser)"
            }
        },
        {
            "type": "PANEL",
            "dataSet": {
                "dataSetName": "Clients Discovery"
            },
            "title": {
                "text": ""
            },
            "id": "PanelComponent1653561281212",
            "hideHeader": true,
            "panelComponents": [
                {
                    "type": "HITS",
                    "dataSet": {
                        "dataSetId": 1460,
                        "dataSetName": "Exchange Client SLA",
                        "dataSetGuid": "580a59f2-6033-4d8a-849d-d787d1b9b701"
                    },
                    "title": {
                        "text": ""
                    },
                    "id": "Hits1653561448679",
                    "isSelected": false,
                    "mobile": {
                        "visible": "On",
                        "listItemClick": {},
                        "customListLayout": null
                    },
                    "layout": {
                        "Hits1653561448679": {
                            "desktop": {
                                "position": {
                                    "0": 0,
                                    "1": 4
                                },
                                "size": {
                                    "x": 4,
                                    "y": 2
                                }
                            }
                        }
                    },
                    "hideComponent": false,
                    "blankComponent": false,
                    "filters": {
                        "builder": {},
                        "viewer": {}
                    },
                    "visible": {},
                    "orientation": "vertical",
                    "color": {
                        "backgroundColor": "#ffffff"
                    },
                    "iconPosition": "left",
                    "hideHeader": true,
                    "measureDataField": [
                        {
                            "column": "Mailboxes Need Attention",
                            "type": "Integer",
                            "showNumberOps": true,
                            "aggrType": "Sum",
                            "captionPosition": "top",
                            "color": {
                                "captionColor": "#000",
                                "countColor": "#000"
                            },
                            "alignment": "center",
                            "cellExpression": "",
                            "displayText": "Mailboxes Needs Attention"
                        }
                    ],
                    "isComponentLoading": false,
                    "isGroupBy": true,
                    "toolTip": "Mailboxes associated to a client for at least more than 7 days and are never backed-up"
                },
                {
                    "type": "HITS",
                    "dataSet": {
                        "dataSetId": 1496,
                        "dataSetName": "Clients Discovery",
                        "dataSetGuid": "0e1f9ee2-72a6-4fb7-aef0-ee3c3b33d5ee"
                    },
                    "title": {
                        "text": ""
                    },
                    "id": "Hits1653566411588",
                    "isSelected": false,
                    "mobile": {
                        "visible": "On",
                        "listItemClick": {},
                        "customListLayout": null
                    },
                    "layout": {
                        "Hits1653566411588": {
                            "desktop": {
                                "position": {
                                    "0": 0,
                                    "1": 0
                                },
                                "size": {
                                    "x": 4,
                                    "y": 2
                                }
                            }
                        }
                    },
                    "hideComponent": false,
                    "blankComponent": false,
                    "filters": {
                        "builder": {},
                        "viewer": {}
                    },
                    "visible": {},
                    "orientation": "vertical",
                    "color": {
                        "backgroundColor": "#ffffff"
                    },
                    "iconPosition": "left",
                    "hideHeader": true,
                    "measureDataField": [
                        {
                            "column": "Client",
                            "type": "String",
                            "aggrType": "Count",
                            "captionPosition": "top",
                            "color": {
                                "captionColor": "#000",
                                "countColor": "#000"
                            },
                            "alignment": "center",
                            "cellExpression": "",
                            "displayText": "Discovery Needs Attention"
                        }
                    ],
                    "isComponentLoading": false,
                    "isGroupBy": true,
                    "toolTip": "Clients with last discover time older than 7 days"
                },
                {
                    "type": "HITS",
                    "dataSet": {
                        "dataSetId": 1497,
                        "dataSetName": "Clients Index",
                        "dataSetGuid": "d0c48c4b-5297-41c5-eb32-7d49c3329bcc"
                    },
                    "title": {
                        "text": ""
                    },
                    "id": "Hits1653566452826",
                    "isSelected": false,
                    "mobile": {
                        "visible": "On",
                        "listItemClick": {},
                        "customListLayout": null
                    },
                    "layout": {
                        "Hits1653566452826": {
                            "desktop": {
                                "position": {
                                    "0": 0,
                                    "1": 8
                                },
                                "size": {
                                    "x": 4,
                                    "y": 2
                                }
                            }
                        }
                    },
                    "hideComponent": false,
                    "blankComponent": false,
                    "filters": {
                        "builder": {},
                        "viewer": {}
                    },
                    "visible": {},
                    "orientation": "vertical",
                    "color": {
                        "backgroundColor": "#ffffff"
                    },
                    "iconPosition": "left",
                    "hideHeader": true,
                    "measureDataField": [
                        {
                            "column": "Client",
                            "type": "String",
                            "aggrType": "CountDistinct",
                            "captionPosition": "top",
                            "color": {
                                "captionColor": "#000",
                                "countColor": "#000"
                            },
                            "alignment": "center",
                            "cellExpression": "",
                            "displayText": "Index Needs Attention"
                        }
                    ],
                    "isComponentLoading": false,
                    "isGroupBy": true,
                    "toolTip": "Clients with last playback time older than 7 days"
                }
            ],
            "mobile": {
                "visible": "On",
                "listItemClick": {},
                "customListLayout": null
            },
            "hideComponent": false,
            "blankComponent": false,
            "filters": {
                "builder": {},
                "viewer": {}
            },
            "visible": {
                "type": "custom",
                "expression": "=(cv.isAdminOnCommcellLevel || cv.isMspAdmin || cv.isMspUser)"
            },
            "layout": [],
            "visibility": {
                "enabled": false,
                "expression": "=!((rpt.input.ExchangeClients == \"\" || rpt.input.ExchangeClients == \"[]\") &amp;&amp; (rpt.input.ClientGroups == \"\" || rpt.input.ClientGroups == \"[]\"))"
            },
            "removeBorders": false
        },
        {
            "type": "TABLE",
            "dataSet": {
                "dataSetId": 1423,
                "dataSetName": "Exchange Client SLA",
                "dataSetGuid": "580a59f2-6033-4d8a-849d-d787d1b9b701"
            },
            "title": {
                "text": "Exchange Clients"
            },
            "id": "Table1620184628959",
            "pageSize": "10",
            "columns": [
                {
                    "dataField": "sys_rowid",
                    "displayName": "sys_rowid",
                    "id": "sys_rowid",
                    "type": "Long",
                    "origType": "String",
                    "visible": true,
                    "hidden": true,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Data Source",
                    "displayName": "CommCell",
                    "id": "DataSource",
                    "type": "String",
                    "origType": "String",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": false
                },
                {
                    "dataField": "Client",
                    "displayName": "Client",
                    "id": "Client",
                    "type": "String",
                    "origType": "",
                    "visible": true,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": false,
                    "additionalProperties": false,
                    "cellExpression": ":=\nvar redirectURL = customReports.appName === \"webconsole\" ? ( location.origin + '/adminconsole/' + row['clienturl'] ) : row['clienturl']\nreturn '&lt;a href=\"'+redirectURL+'\"&gt;'+cellData+'&lt;/a&gt;'"
                },
                {
                    "dataField": "Client Status",
                    "displayName": "Client Status",
                    "id": "ClientStatus",
                    "type": "String",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Index Status",
                    "displayName": "Index Status",
                    "id": "IndexStatus",
                    "type": "String",
                    "origType": "String",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Last Indexed Backup JobId",
                    "displayName": "Last indexed backup jobid",
                    "id": "Lastindexedbackupjobid",
                    "type": "String",
                    "origType": "String",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": ":=\nvar redirectURL = customReports.appName === \"webconsole\" ? ( location.origin + '/adminconsole/' + row['joburl'] ) : row['joburl']\nreturn '&lt;a href=\"'+redirectURL+'\"&gt;'+cellData+'&lt;/a&gt;'"
                },
                {
                    "dataField": "Last Index Time",
                    "displayName": "Last index time",
                    "id": "Lastindextime",
                    "type": "TimeStamp",
                    "origType": "String",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Last Index Error Time",
                    "displayName": "Last index error time",
                    "id": "Lastindexerrortime",
                    "type": "TimeStamp",
                    "origType": "String",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Last Discovery Time",
                    "displayName": "Last discovery time",
                    "id": "Lastdiscoverytime",
                    "type": "TimeStamp",
                    "origType": "TimeStamp",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Last Backup Run Time",
                    "displayName": "Last Backup Run Time",
                    "id": "LastBackupRunTime",
                    "type": "TimeStamp",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Last Backup Job ID",
                    "displayName": "Last Backup Job ID",
                    "id": "LastBackupJobID",
                    "type": "String",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": ":=\nvar redirectURL = customReports.appName === \"webconsole\" ? ( location.origin + '/adminconsole/' + row['backupjoburl'] ) : row['backupjoburl']\nreturn '&lt;a href=\"'+redirectURL+'\"&gt;'+cellData+'&lt;/a&gt;'"
                },
                {
                    "dataField": "Associated Mailboxes",
                    "displayName": "Associated Mailboxes",
                    "id": "AssociatedMailboxes",
                    "type": "Long",
                    "origType": "",
                    "visible": true,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "width": 200.026,
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    }
                },
                {
                    "dataField": "Mailboxes Backed-up",
                    "displayName": "Mailboxes Backed-up",
                    "id": "MailboxesBackedup",
                    "type": "Long",
                    "origType": "",
                    "visible": true,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    }
                },
                {
                    "dataField": "Mailboxes Not Backed-up",
                    "displayName": "Mailboxes Not Backed-up",
                    "id": "MailboxesNotBackedup",
                    "type": "Long",
                    "origType": "",
                    "visible": true,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    }
                },
                {
                    "dataField": "Mailboxes Backed-up (at least once)",
                    "displayName": "Mailboxes Backed-up (at least once)",
                    "id": "MailboxesBackedupatleastonce",
                    "type": "Long",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Mailboxes Never Backed-up",
                    "displayName": "Mailboxes Never Backed-up",
                    "id": "MailboxesNeverBackedup",
                    "type": "Integer",
                    "origType": "",
                    "visible": true,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    }
                },
                {
                    "dataField": "Mailboxes Recently Added",
                    "displayName": "Mailboxes Recently Added",
                    "id": "MailboxesRecentlyAdded",
                    "type": "Long",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Mailboxes Need Attention",
                    "displayName": "Mailboxes Need Attention",
                    "id": "MailboxesNeedAttention",
                    "type": "Integer",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Application Size",
                    "displayName": "Application Size",
                    "id": "ApplicationSize",
                    "type": "Long",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": {
                        "type": "size",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    }
                },
                {
                    "dataField": "Number of Emails",
                    "displayName": "Number of Emails",
                    "id": "NumberofEmails",
                    "type": "Long",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    }
                },
                {
                    "dataField": "Indexed Emails",
                    "displayName": "Indexed Emails",
                    "id": "IndexedEmails",
                    "type": "Long",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    }
                },
                {
                    "dataField": "Azure Apps Associated",
                    "displayName": "Azure Apps Associated",
                    "id": "AzureAppsAssociated",
                    "type": "Integer",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Azure Apps Not Authorized",
                    "displayName": "Azure Apps Not Authorized",
                    "id": "AzureAppsNotAuthorized",
                    "type": "Integer",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Azure Apps To Be Added",
                    "displayName": "Azure Apps To Be Added",
                    "id": "AzureAppsToBeAdded",
                    "type": "Integer",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Last Verify Connection Time",
                    "displayName": "Last Verify Connection Time",
                    "id": "LastVerifyConnectionTime",
                    "type": "TimeStamp",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Max Streams",
                    "displayName": "Max Streams",
                    "id": "MaxStreams",
                    "type": "Integer",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Access Node Group",
                    "displayName": "Access Node Group",
                    "id": "AccessNodeGroup",
                    "type": "String",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": false,
                    "additionalProperties": false,
                    "cellExpression": ":=\nif ((cv.isAdminOnCommcellLevel || cv.isMspAdmin || cv.isMspUser) &amp;&amp; cellData !== \"\")\n{\n\tvar redirectURL = customReports.appName === \"webconsole\" ? ( location.origin + '/adminconsole/' + row['accessNodeGroupUrl'] ) : row['accessNodeGroupUrl']\n\treturn '&lt;a href=\"'+redirectURL+'\"&gt;'+cellData+'&lt;/a&gt;'\n}\nelse\n{\n    return \"N/A\"\n}"
                },
                {
                    "dataField": "Index Server",
                    "displayName": "Index Server",
                    "id": "IndexServer",
                    "type": "String",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": false,
                    "additionalProperties": false,
                    "cellExpression": ":=\nif ((cv.isAdminOnCommcellLevel || cv.isMspAdmin || cv.isMspUser) &amp;&amp; cellData !== \"\")\n{\n\tvar redirectURL = customReports.appName === \"webconsole\" ? ( location.origin + '/adminconsole/' + row['indexserverurl'] ) : row['indexserverurl']\n\treturn '&lt;a href=\"'+redirectURL+'\"&gt;'+cellData+'&lt;/a&gt;'\n}\nelse\n{\n    return \"N/A\"\n}"
                },
                {
                    "dataField": "Active Jobs",
                    "displayName": "Active Jobs",
                    "id": "ActiveJobs",
                    "type": "String",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": ":=\nvar redirectURL = customReports.appName === \"webconsole\" ? ( location.origin + '/adminconsole/' + row['activejobsurl'] ) : row['activejobsurl']\nreturn '&lt;a href=\"'+redirectURL+'\"&gt;'+cellData+'&lt;/a&gt;'"
                },
                {
                    "dataField": "joburl",
                    "displayName": "joburl",
                    "id": "joburl",
                    "type": "String",
                    "origType": "String",
                    "visible": true,
                    "hidden": true,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": false
                },
                {
                    "dataField": "backupjoburl",
                    "displayName": "backupjoburl",
                    "id": "backupjoburl",
                    "type": "String",
                    "origType": "",
                    "visible": true,
                    "hidden": true,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": false
                },
                {
                    "dataField": "clienturl",
                    "displayName": "clienturl",
                    "id": "clienturl",
                    "type": "String",
                    "origType": "",
                    "visible": true,
                    "hidden": true,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": false
                },
                {
                    "dataField": "activejobsurl",
                    "displayName": "activejobsurl",
                    "id": "activejobsurl",
                    "type": "String",
                    "origType": "",
                    "visible": true,
                    "hidden": true,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": false
                },
                {
                    "dataField": "accessNodeGroupUrl",
                    "displayName": "accessNodeGroupUrl",
                    "id": "accessNodeGroupUrl",
                    "type": "String",
                    "origType": "",
                    "visible": true,
                    "hidden": true,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": false
                },
                {
                    "dataField": "indexserverurl",
                    "displayName": "indexserverurl",
                    "id": "indexserverurl",
                    "type": "String",
                    "origType": "",
                    "visible": true,
                    "hidden": true,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": false
                }
            ],
            "allColumns": true,
            "dataSetName": "",
            "styles": {
                "chartPlotOptions": {
                    "isShowGridlines": true,
                    "isSmoothLines": true,
                    "isShowLineMarkers": true,
                    "autoConvertYValues": true,
                    "isShowLabels": false,
                    "legendPosition": "right"
                }
            },
            "mobile": {
                "visible": "On",
                "listItemClick": {},
                "customListLayout": null
            },
            "hideComponent": false,
            "blankComponent": false,
            "filters": {
                "builder": {},
                "viewer": {}
            },
            "showFilterByDefault": false,
            "visible": {},
            "orientation": "vertical",
            "enableHorizontalScroll": false
        },
        {
            "type": "TABLE",
            "dataSet": {
                "dataSetId": 1405,
                "dataSetName": "Exchange Mailbox Details",
                "dataSetGuid": "282b5ae7-a371-4c1c-f7fa-9fb4f7e7cfd4",
                "originalDataSetName": "Mailbox Details"
            },
            "title": {
                "text": ":= return (rpt.input.Options === 'Show all mailboxes' ? 'Mailboxes' : 'Mailboxes Not Backed-up')"
            },
            "id": "Table1594892772019",
            "pageSize": 20,
            "columns": [
                {
                    "dataField": "sys_rowid",
                    "displayName": "sys_rowid",
                    "id": "sys_rowid",
                    "type": "Long",
                    "origType": "",
                    "visible": true,
                    "hidden": true,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Data Source",
                    "displayName": "CommCell",
                    "id": "DataSource",
                    "type": "String",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true
                },
                {
                    "dataField": "Name",
                    "displayName": "Name",
                    "id": "Name",
                    "type": "Integer",
                    "origType": "",
                    "visible": true,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Email Address",
                    "displayName": "Email Address",
                    "id": "EmailAddress",
                    "type": "Integer",
                    "origType": "",
                    "visible": true,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true
                },
                {
                    "dataField": "Last Backup",
                    "displayName": "Last backup",
                    "id": "Lastbackup",
                    "type": "Integer",
                    "origType": "",
                    "visible": true,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Last Backup Status",
                    "displayName": "Last Backup Status",
                    "id": "LastBackupStatus",
                    "type": "Integer",
                    "origType": "",
                    "visible": true,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Failure Reason",
                    "displayName": "Failure Reason",
                    "id": "FailureReason",
                    "type": "Integer",
                    "origType": "",
                    "visible": true,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Last Backup Attempt",
                    "displayName": "Last backup attempt",
                    "id": "Lastbackupattempt",
                    "type": "Integer",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": false
                },
                {
                    "dataField": "Last Backup Attempt JobId",
                    "displayName": "Last Backup Attempt JobId",
                    "id": "LastBackupAttemptJobId",
                    "type": "Integer",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Client",
                    "displayName": "Client",
                    "id": "Client",
                    "type": "Integer",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Added to content on",
                    "displayName": "Added to content on",
                    "id": "Addedtocontenton",
                    "type": "Integer",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Mailbox Type",
                    "displayName": "Mailbox Type",
                    "id": "MailboxType",
                    "type": "Integer",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Backup Size",
                    "displayName": "Backup Size",
                    "id": "BackupSize",
                    "type": "Integer",
                    "origType": "",
                    "visible": true,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": {
                        "type": "size",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    }
                },
                {
                    "dataField": "Number Of Emails",
                    "displayName": "Number of Emails",
                    "id": "NumberOfEmails",
                    "type": "Integer",
                    "origType": "",
                    "visible": true,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    }
                },
                {
                    "dataField": "Failed Items",
                    "displayName": "Failed Items",
                    "id": "FailedItems",
                    "type": "Integer",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    }
                }
            ],
            "allColumns": true,
            "dataSetName": "",
            "styles": {
                "chartPlotOptions": {
                    "isShowGridlines": true,
                    "isSmoothLines": true,
                    "isShowLineMarkers": true,
                    "autoConvertYValues": true,
                    "isShowLabels": false,
                    "legendPosition": "right"
                }
            },
            "mobile": {
                "visible": "On",
                "listItemClick": {},
                "customListLayout": null
            },
            "filters": {
                "builder": {},
                "viewer": {}
            },
            "showFilterByDefault": false,
            "enableHorizontalScroll": false,
            "visible": {
                "type": "custom",
                "expression": "=!((rpt.input.ExchangeClients == \"\" || rpt.input.ExchangeClients == \"[]\") &amp;&amp; (rpt.input.ClientGroups == \"\" || rpt.input.ClientGroups == \"[]\"))"
            },
            "orientation": "vertical",
            "hideComponent": false,
            "blankComponent": false
        }
    ],
    "filters": {
        "builder": {},
        "viewer": {}
    },
    "autoRefreshTime": 10,
    "reportLayout": {
        "gridsterOpts": {
            "columns": 12
        },
        "Table1594892772019": {
            "mobile": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    8,
                    0
                ]
            },
            "tablet": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    8,
                    0
                ]
            },
            "desktop": {
                "size": {
                    "x": 12,
                    "y": 3
                },
                "position": [
                    16,
                    0
                ]
            }
        },
        "Table1620184628959": {
            "mobile": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    8,
                    0
                ]
            },
            "tablet": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    8,
                    0
                ]
            },
            "desktop": {
                "size": {
                    "x": 12,
                    "y": 9
                },
                "position": [
                    7,
                    0
                ]
            }
        },
        "Hits1620293333956": {
            "mobile": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    0,
                    0
                ]
            },
            "tablet": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    0,
                    0
                ]
            },
            "desktop": {
                "size": {
                    "x": 4,
                    "y": 2
                },
                "position": [
                    0,
                    0
                ]
            }
        },
        "Hits1620293341250": {
            "mobile": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    0,
                    3
                ]
            },
            "tablet": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    0,
                    3
                ]
            },
            "desktop": {
                "size": {
                    "x": 4,
                    "y": 2
                },
                "position": [
                    0,
                    4
                ]
            }
        },
        "Hits1620293346865": {
            "mobile": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    0,
                    6
                ]
            },
            "tablet": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    0,
                    6
                ]
            },
            "desktop": {
                "size": {
                    "x": 4,
                    "y": 2
                },
                "position": [
                    0,
                    8
                ]
            }
        },
        "Hits1620293351486": {
            "mobile": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    0,
                    9
                ]
            },
            "tablet": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    0,
                    9
                ]
            },
            "desktop": {
                "size": {
                    "x": 4,
                    "y": 2
                },
                "position": [
                    2,
                    4
                ]
            }
        },
        "Hits1623238901811": {
            "mobile": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    2,
                    0
                ]
            },
            "tablet": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    2,
                    0
                ]
            },
            "desktop": {
                "size": {
                    "x": 4,
                    "y": 2
                },
                "position": [
                    2,
                    0
                ]
            }
        },
        "Hits1623238925058": {
            "mobile": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    2,
                    8
                ]
            },
            "tablet": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    2,
                    8
                ]
            },
            "desktop": {
                "size": {
                    "x": 4,
                    "y": 2
                },
                "position": [
                    2,
                    8
                ]
            }
        },
        "PanelComponent1653561281212": {
            "desktop": {
                "size": {
                    "y": 3,
                    "x": 12
                },
                "position": {
                    "0": 4,
                    "1": 0
                }
            }
        }
    }
}</body>
    </Page>
    <Page>
      <pageName>OneDrive</pageName>
      <isDefault>false</isDefault>
      <pageTitle>
        <text>OneDrive</text>
      </pageTitle>
      <dataSets>
        <dataSet>
          <DataSet>
            <dataSet>
              <dataSetName>Clients</dataSetName>
              <dataSetGuid>4b3a8d39-09a2-4477-98c9-bd395e6f73d4</dataSetGuid>
            </dataSet>
            <endpoint>DATABASE</endpoint>
            <shared>false</shared>
            <dataSources>
              <DataSource>
                <connectionType>COMMCELL</connectionType>
                <endpoint>DATABASE</endpoint>
                <commCell>
                  <commCellName>$ALL$</commCellName>
                </commCell>
              </DataSource>
            </dataSources>
            <allColumns>false</allColumns>
            <fields>
              <Column>
                <name>sys_rowid</name>
                <dataField>$row_number$</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Data Source</name>
                <dataField>Data Source</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>id</name>
                <dataField>id</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>displayName</name>
                <dataField>displayName</dataField>
                <type>String</type>
              </Column>
            </fields>
            <GetOperation>
              <parameters />
              <sqlText>-- Constants

DECLARE @CV_APPTYPE_ONEDRIVE INT = 134

DECLARE @INSTANCE_ONEDRIVE INT = 7



-- variables

DECLARE @userId INT

DECLARE @companyId INT

DECLARE @clientIds TABLE (clientId INT)



-- read inputs

SELECT @userId = id FROM UMUsers WHERE login = @sys_username

SET @companyId = dbo.AppGetOrganizationForUser(@userId)



IF @companyId &gt; 0

			BEGIN

				DECLARE @OrgClients table (clientId INT,  tenantId INT , tenant nvarchar(40))            

				

				INSERT INTO @OrgClients 

				SELECT A.clientId, D.id , D.domainName

				from APP_ClientGroupAssoc A WITH (NOLOCK)

				JOIN APP_ClientGroup B WITH (NOLOCK) ON A.clientGroupId = B.id 

				JOIN App_CompanyProp C WITH (NOLOCK) ON C.attrName = 'Associated Smart Client Group' AND CAST(A.clientGroupId AS nvarchar(MAX)) = C.attrVal AND C.modIFied = 0

				JOIN UMDSProviders D WITH (NOLOCK) ON C.componentNameId = D.id

				WHERE (C.componentNameId = @companyId) AND  B.flag&amp;0x1000 &gt; 0



				INSERT INTO @clientIds (clientId) SELECT clientId FROM @OrgClients

			END

		ELSE

			BEGIN

				IF OBJECT_ID('tempdb.dbo.#temp_clientIds') IS NOT NULL

					DROP TABLE #temp_clientIds



				CREATE TABLE #temp_clientIds

				(

					clientId            INT,

					appTypeId           INT,

					instanceId          INT,

					backupsetId         INT,

					subclientId         INT

				)



				EXEC sec_getIdaObjectsForUser @userId, 3/*Client Entity*/, 0, 0, '#temp_clientIds', 1



				INSERT INTO @clientIds (clientId) SELECT clientId FROM #temp_clientIds

			END



DELETE FROM @clientIds WHERE clientId NOT IN 

(SELECT DISTINCT clientId FROM APP_Application AA WITH (NOLOCK)

INNER JOIN App_InstanceProp AI WITH (NOLOCK) ON AA.instance = AI.componentNameId

WHERE appTypeId = @CV_APPTYPE_ONEDRIVE AND attrName = 'Cloud Apps Instance Type' AND attrVal = @INSTANCE_ONEDRIVE

AND subclientStatus &amp; 0x04 != 0x04 /*DELETED*/ AND subclientStatus &amp; 0x00020 != 0x00020 /*HIDDEN*/)



DELETE FROM @clientIds

WHERE clientId NOT IN 

(SELECT componentNameId FROM App_ClientProp WITH (NOLOCK) WHERE attrName = 'Office 365 Pseudo Client' AND attrVal = 1 /*V2 client*/ AND modified = 0

AND componentNameId IN (SELECT clientId FROM @clientIds))



SELECT id, displayName FROM APP_Client WITH (NOLOCK) WHERE id IN (select clientId FROM @clientIds) AND specialClientFlags &amp; 0x02 &lt;&gt; 0 /*Pseudo client*/



IF OBJECT_ID('tempdb.dbo.#temp_clientIds') IS NOT NULL

	DROP TABLE #temp_clientIds</sqlText>
              <timeout>5</timeout>
              <postQueryFilter>true</postQueryFilter>
              <rDataSetQuery />
              <rPlotQuery />
            </GetOperation>
            <description>Backup Health Report for Office 365 Clients.</description>
            <databaseName>CommServ</databaseName>
            <queryPlan>
              <offline>false</offline>
              <collectionType>HTTP</collectionType>
              <retentionDays>1</retentionDays>
              <versions>
                <CommCellVersion>ALL</CommCellVersion>
              </versions>
              <dynamicCollection>false</dynamicCollection>
              <frequency>60</frequency>
              <direct>false</direct>
            </queryPlan>
            <version>144</version>
            <guid>4b3a8d39-09a2-4477-98c9-bd395e6f73d4</guid>
            <hidden>true</hidden>
            <revision />
            <computedColumns>
              <scriptName>R</scriptName>
              <script />
              <columnList />
            </computedColumns>
          </DataSet>
          <DataSet>
            <dataSet>
              <dataSetName>OneDrive Mailbox details</dataSetName>
              <dataSetGuid>0e7d384a-b165-4821-de45-810bedeab80b</dataSetGuid>
            </dataSet>
            <endpoint>DATABASE</endpoint>
            <shared>false</shared>
            <dataSources>
              <DataSource>
                <connectionType>COMMCELL</connectionType>
                <endpoint>DATABASE</endpoint>
                <commCell>
                  <commCellName>$ALL$</commCellName>
                </commCell>
              </DataSource>
            </dataSources>
            <allColumns>true</allColumns>
            <fields>
              <Column>
                <name>sys_rowid</name>
                <dataField>$row_number$</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Data Source</name>
                <dataField>Data Source</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Name</name>
                <dataField>Name</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Email Address</name>
                <dataField>Email Address</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Last Backup</name>
                <dataField>Last Backup</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Last Backup Status</name>
                <dataField>Last Backup Status</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Failure Reason</name>
                <dataField>Failure Reason</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Last Backup Attempt</name>
                <dataField>Last Backup Attempt</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Last Backup Attempt JobId</name>
                <dataField>Last Backup Attempt JobId</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Client</name>
                <dataField>Client</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Added to content on</name>
                <dataField>Added to content on</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Backup Size</name>
                <dataField>Backup Size</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Number Of Items</name>
                <dataField>Number Of Items</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Failed Items</name>
                <dataField>Failed Items</dataField>
                <type>Integer</type>
              </Column>
            </fields>
            <GetOperation>
              <parameters>
                <Parameter>
                  <name>Clients</name>
                  <dataType>Integer</dataType>
                  <isList>true</isList>
                  <values>
                    <string>=input.OneDriveClients</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>Timeframe</name>
                  <dataType>DateRange</dataType>
                  <values>
                    <string>=input.Timeframe</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>ClientGroups</name>
                  <dataType>Integer</dataType>
                  <isList>true</isList>
                  <values>
                    <string>=input.ClientGroups</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>Options</name>
                  <dataType>String</dataType>
                  <isList>true</isList>
                  <values>
                    <string>=input.Options</string>
                  </values>
                </Parameter>
              </parameters>
              <sqlText>/*Validity check*/

IF NOT EXISTS (SELECT Clients FROM @Clients) AND NOT EXISTS (SELECT ClientGroups FROM @ClientGroups)

BEGIN

	/*SELECT dummy columns to maintain consistency in report columns output*/

	SELECT 

		Clients AS [Name],

		Clients AS [Email Address],

		Clients AS [Last Backup],

		Clients AS [Last Backup Status],

		Clients AS [Failure Reason],

		Clients AS [Last Backup Attempt],

		Clients AS [Last Backup Attempt JobId],

		Clients AS [Client],

		Clients AS [Added to content on],

		Clients AS [Backup Size],

		Clients AS [Number Of Items],

		Clients AS [Failed Items]

	FROM @Clients



	RETURN

END



-- constants

DECLARE @CV_APPTYPE_CLOUD_APPS INT = 134



DECLARE @STATUS_NOT_AVAILABLE INT = 0

DECLARE @STATUS_FAILED INT = 1

DECLARE @STATUS_SKIPPED INT = 2

DECLARE @STATUS_SUCCESS INT = 3

DECLARE @STATUS_SUSPENDED INT = 4

DECLARE @STATUS_COMPLETED_WITH_ERRORS INT = 5

DECLARE @STATUS_PARTIALLY_PROCESSED INT = 6

DECLARE @STATUS_NEVER_BACKED_UP INT = 501



DECLARE @numberOfDays INT = 7

DECLARE @depthRefTime INT = dbo.getunixtime(DATEADD(HOUR, -@numberOfDays*24 , GETUTCDATE()))



-- variables

DECLARE @userId INT = (SELECT TOP 1 id FROM UMUsers WITH (NOLOCK) WHERE login = @sys_username)

DECLARE @companyId INT

DECLARE @includeBackupDisabledClients INT = 0

DECLARE @includeAllUsers INT = 0



IF OBJECT_ID('tempdb.dbo.#listClientIds_OneDrive') IS NOT NULL

	DROP TABLE #listClientIds_OneDrive



CREATE TABLE #listClientIds_OneDrive (clientId INT, subclientId INT, backupsetId INT, instanceId INT)

CREATE NONCLUSTERED INDEX #listClientIds_OneDrive_c_s_b_i_ids ON #listClientIds_OneDrive(clientId, subclientId, backupsetId, instanceId)



INSERT INTO #listClientIds_OneDrive (clientId) 

SELECT DISTINCT Clients FROM @Clients

UNION

SELECT DISTINCT CG.clientId FROM App_ClientGroupAssoc CG WITH (NOLOCK)

INNER JOIN APP_Application AA WITH (NOLOCK) ON CG.clientId = AA.clientId AND AA.appTypeId = @CV_APPTYPE_CLOUD_APPS

WHERE clientGroupId IN (SELECT ClientGroups FROM @ClientGroups)

AND subclientStatus &amp; 0x04 != 0x04 /*DELETED*/ AND subclientStatus &amp; 0x00020 != 0x00020 /*HIDDEN*/



IF OBJECT_ID('tempdb.dbo.#temp__clientIds') IS NOT NULL

	DROP TABLE #temp__clientIds



CREATE TABLE #temp__clientIds

(

	clientId            INT,

	appTypeId           INT,

	instanceId          INT,

	backupsetId         INT,

	subclientId         INT

)



SET @companyId = dbo.AppGetOrganizationForUser(@userId)



IF @companyId &gt; 0

BEGIN

	INSERT INTO #temp__clientIds (clientId)

	SELECT DISTINCT CGA.clientId

	FROM UMDSProviders UMDS WITH (NOLOCK)

	JOIN App_CompanyProp CP WITH (NOLOCK) ON CP.attrName = 'Associated Smart Client Group' AND CP.modified = 0 AND UMDS.id = CP.componentNameId

	JOIN APP_ClientGroupAssoc CGA WITH (NOLOCK) ON CAST(CGA.clientGroupId AS NVARCHAR(16)) = CP.attrVal

	JOIN APP_ClientGroup CG WITH (NOLOCK) ON CGA.clientGroupId = CG.id

	WHERE CP.componentNameId = @companyId AND CG.flag &amp; 0x1000 &gt; 0

END

ELSE

BEGIN

	EXEC dbo.sec_getIdaObjectsForUser @userId, 3 /*Client Entity*/, 0, 0, '#temp__clientIds', 1

END



DELETE #listClientIds_OneDrive

FROM #listClientIds_OneDrive C 

INNER JOIN App_Client AC WITH (NOLOCK) ON C.clientId = AC.id

WHERE AC.specialClientFlags &amp; 0x02 = 0 /*Not Pseudo client*/ OR C.clientId NOT IN (SELECT clientId FROM #temp__clientIds)



IF OBJECT_ID('tempdb.dbo.#temp__clientIds') IS NOT NULL

	DROP TABLE #temp__clientIds



DELETE #listClientIds_OneDrive

FROM #listClientIds_OneDrive TOD INNER JOIN App_Client AC WITH (NOLOCK) ON TOD.clientId = AC.id

WHERE AC.specialClientFlags &amp; 0x02 = 0 /*Pseudo client*/

			

DELETE FROM #listClientIds_OneDrive

WHERE clientId NOT IN 

(SELECT componentNameId FROM App_ClientProp WITH (NOLOCK) WHERE attrName = 'Office 365 Pseudo Client' AND attrVal = 1 /*V2 client*/ AND modified = 0

AND componentNameId IN (SELECT clientId FROM #listClientIds_OneDrive))



DELETE FROM #listClientIds_OneDrive

WHERE clientId NOT IN

(SELECT C.clientId FROM #listClientIds_OneDrive C 

INNER JOIN APP_Application AA WITH (NOLOCK) ON C.clientId = AA.clientId

INNER JOIN APP_InstanceProp AI WITH (NOLOCK) ON AA.instance = AI.componentNameId

WHERE appTypeId = @CV_APPTYPE_CLOUD_APPS AND attrName = 'Cloud Apps Instance Type' AND attrVal = 7 /*OneDrive*/)



DECLARE @csTimeZoneId			INT = 0

DECLARE @csTimeZone				NVARCHAR(1024) = ''

DECLARE @browserBias			INT = 0

DECLARE @browserTimeZoneId		INT = 0



SET @browserTimeZoneId = (SELECT TOP 1 TimeZoneID FROM SchedTimeZone WITH (NOLOCK) WHERE TimeZoneName LIKE '%' + @sys_timezone + '%')

SELECT @browserBias = Bias FROM SchedTimeZone WITH (NOLOCK) WHERE TimeZoneID = @browserTimeZoneId



SELECT @csTimeZoneId = (SELECT TOP 1 attrVal FROM APP_ClientProp WITH (NOLOCK) WHERE attrName = 'Commcell timezone Id' AND modified = 0)

IF ISNULL(@csTimeZoneId, 0) = 0

	SELECT @csTimeZoneId = (SELECT TOP 1 attrVal FROM APP_ClientProp WITH (NOLOCK) WHERE componentNameId = 2 AND attrName = 'timezone Id' AND modified = 0)

SET @csTimeZone = (SELECT TOP 1 TimeZoneName FROM SchedTimeZone WITH (NOLOCK) WHERE TimeZoneID = @csTimeZoneId)



DECLARE @startTime BIGINT = DATEDIFF(SS, '1970-01-01', dbo.LocalToUTCDateTimeConversionManaged(ISNULL(@timeframe_from,'1970-01-01 00:00:00.000'), @csTimeZone))



IF EXISTS (SELECT Options FROM @Options WHERE Options = 'Show backup disabled clients')

	SET @includeBackupDisabledClients = 1



IF EXISTS (SELECT Options FROM @Options WHERE Options = 'Show all users')

	SET @includeAllUsers = 1



UPDATE #listClientIds_OneDrive

SET subclientId = S.subclientId, backupsetId = S.backupSet, instanceId = S.instance

FROM (SELECT MIN(id) AS subclientId, clientId, backupSet, instance

		FROM APP_Application WITH (NOLOCK)

		WHERE clientId IN (SELECT clientId FROM #listClientIds_OneDrive)

		GROUP BY clientId, backupSet, instance

	) S WHERE #listClientIds_OneDrive.clientId = S.clientId



IF @includeBackupDisabledClients = 0

BEGIN

	DELETE FROM #listClientIds_OneDrive

	WHERE subclientId IN 

	(

		/*Delete license released clients*/

		SELECT AA.id

		FROM App_Application AA WITH (NOLOCK)

		INNER JOIN #listClientIds_OneDrive TT ON AA.id = TT.subclientId 

		WHERE subclientStatus &amp; 0x02 = 0x02

		UNION

		/*Delete excluded from SLA clients*/

		SELECT ASP.componentNameId

		FROM APP_SubClientProp ASP WITH (NOLOCK)

		JOIN #listClientIds_OneDrive TE ON ASP.componentNameId = TE.subclientId

		WHERE ASP.attrName = 'Exclude From SLA' AND ASP.attrVal = 1 AND ASP.modified = 0

		UNION

		/*Delete backup disabled clients*/

		SELECT JA.appId

		FROM JMJobAction JA WITH (NOLOCK) 

		JOIN #listClientIds_OneDrive TE ON JA.appId = TE.subclientId

		WHERE JA.clientId = 1 AND JA.mediaAgentID = 1 AND JA.appType = 0 AND JA.optype = 4 AND JA.action = 1

	)



	/*Delete clients associated with deactivated tenants*/

	DELETE FROM #listClientIds_OneDrive 

	WHERE clientId IN (SELECT DISTINCT CGA.clientId

	FROM UMDSProviders UMDS WITH (NOLOCK)

	JOIN App_CompanyProp CP WITH (NOLOCK) ON CP.attrName = 'Associated Smart Client Group' AND CP.modified = 0 AND UMDS.id = CP.componentNameId

	JOIN APP_ClientGroupAssoc CGA WITH (NOLOCK) ON CAST(CGA.clientGroupId AS NVARCHAR(16)) = CP.attrVal

	WHERE UMDS.flags &amp; 0x0010 = 0x0010 OR enabled = 0)

END



IF OBJECT_ID('tempdb.dbo.#temp_unprotected_mailboxes_onedrive') IS NOT NULL

	DROP TABLE #temp_unprotected_mailboxes_onedrive



CREATE TABLE #temp_unprotected_mailboxes_onedrive

(

	displayName NVARCHAR(512),

	smtpAddress NVARCHAR(512),

	userGUID NVARCHAR(128),

	created BIGINT,

	backupReferenceTime BIGINT,

	clientId INT,

	mailboxSize BIGINT,

	numberOfItems BIGINT,

	isProtected INT

)



INSERT INTO #temp_unprotected_mailboxes_onedrive (displayName, smtpAddress, userGUID, created, backupReferenceTime, clientId, mailboxSize, numberOfItems, isProtected)

SELECT CU.displayName, CU.smtpAddress, UPPER(CU.userGUID), created, CU.backupReferenceTime, TOD.clientId, CU.userAccountSize, CU.numberOfItems, 0

FROM App_CloudAppUserDetails CU WITH (NOLOCK)

INNER JOIN #listClientIds_OneDrive TOD ON CU.subClientId = TOD.subclientId

WHERE CU.discoverByType = 1 AND CU.modified = 0 AND CU.status = 0 /*Active*/ AND CU.smtpAddress IS NOT NULL

AND (CASE 

		WHEN @includeAllUsers = 1 THEN 1

		WHEN (backupReferenceTime &lt; @startTime OR backupReferenceTime IS NULL) THEN 1

		ELSE 0

	END) = 1



CREATE CLUSTERED INDEX #temp_unprotected_mailboxes_od_smtp_clientId ON #temp_unprotected_mailboxes_onedrive (clientId, userGUID)



IF OBJECT_ID('tempdb.dbo.#upm_temp_mailbox_summary_onedrive') IS NOT NULL

	DROP TABLE #upm_temp_mailbox_summary_onedrive



CREATE TABLE #upm_temp_mailbox_summary_onedrive

(

	smtpAddress NVARCHAR(512),

	userGUID NVARCHAR(128),

	status INT, 

	failureReason NVARCHAR(MAX),

	failedItems INT,

	jobId INT,

	jobStartTime BIGINT,

	jobEndTime BIGINT,

	clientId INT

)



CREATE CLUSTERED INDEX #upm_temp_mailbox_summary_od_smtp_cId_jId ON #upm_temp_mailbox_summary_onedrive(jobId, clientId, userGUID)



IF OBJECT_ID('tempdb.dbo.#upm_temp_job_summary_onedrive') IS NOT NULL

	DROP TABLE #upm_temp_job_summary_onedrive



CREATE TABLE #upm_temp_job_summary_onedrive

(

	clientId INT,

	jobId INT,

	jobStartTime BIGINT,

	jobEndTime BIGINT,

	data XML

)



CREATE CLUSTERED INDEX #ump_job_summary_client_jobId ON #upm_temp_job_summary_onedrive(clientId, jobId)



INSERT INTO #upm_temp_job_summary_onedrive

SELECT TE.clientId, JM.jobId, JS.servStartDate, JS.servEndDate, JM.data

FROM  JMMisc JM WITH (NOLOCK)

INNER JOIN JMBkpStats JS WITH (NOLOCK) ON JM.jobId = JS.jobId AND JS.servEndDate &gt;= @depthRefTime AND JS.commcellId = 2

INNER JOIN #listClientIds_OneDrive TE ON TE.subclientId = JS.appId

WHERE JS.opType = 4 /*Backup*/ AND JM.itemType = 28



INSERT INTO #upm_temp_mailbox_summary_onedrive

SELECT 

	M.NA.value('@SMTP', 'NVARCHAR(512)'),

	UPPER(REPLACE(M.NA.value('@GUID', 'NVARCHAR(128)'), '-', 'X')),

	M.NA.value('@status', 'INT'),

	M.NA.value('@FailureReason', 'NVARCHAR(MAX)'),

	M.NA.value('@FailedMessages', 'INT'),

	jobId, jobStartTime, jobEndTime, clientId

FROM #upm_temp_job_summary_onedrive U

CROSS APPLY data.nodes('./JobManager_ExchMbJobInfo/SourceMailboxStats') M(NA)

WHERE M.NA.value('@status', 'INT') &lt;&gt; @STATUS_SUCCESS -- Skip successful mailboxes



DELETE dup FROM 

(SELECT ROW_NUMBER() OVER (PARTITION BY userGUID, clientId ORDER BY jobId DESC) cnt FROM #upm_temp_mailbox_summary_onedrive) dup

WHERE dup.cnt &gt; 1



SELECT

displayName AS 'Name',

smtpAddress AS 'Email Address',

(CASE WHEN lastBackup IS NOT NULL AND lastBackup &gt; 0

	THEN (SELECT DATEADD(ss, lastBackup + @browserBias, CAST('1970-01-01 00:00:00' AS DATETIME)))

END) AS 'Last Backup', 

(CASE mailboxStatus 

	WHEN @STATUS_FAILED THEN 'Failed'

	WHEN @STATUS_SKIPPED THEN 'Skipped'

	WHEN @STATUS_SUCCESS THEN 'Successful'

	WHEN @STATUS_SUSPENDED THEN 'Suspended'

	WHEN @STATUS_COMPLETED_WITH_ERRORS THEN 'Completed with errors'

	WHEN @STATUS_PARTIALLY_PROCESSED THEN 'Partially Processed'

	WHEN @STATUS_NEVER_BACKED_UP THEN 'Never backed-up'

	WHEN @STATUS_NOT_AVAILABLE THEN 'Not Available'

END) AS 'Last Backup Status',

(CASE WHEN mailboxStatus NOT IN (@STATUS_SUCCESS, @STATUS_NOT_AVAILABLE) THEN failureReason END) AS 'Failure Reason',

(CASE 

	WHEN mailboxStatus = @STATUS_SUCCESS THEN (SELECT DATEADD(ss, lastBackup + @browserBias, CAST('1970-01-01 00:00:00' AS DATETIME)))

	WHEN mailboxStatus &lt;&gt; @STATUS_NOT_AVAILABLE THEN lastAttempt

END) AS 'Last Backup Attempt',

(CASE WHEN mailboxStatus NOT IN (@STATUS_SUCCESS, @STATUS_NOT_AVAILABLE) THEN jobId END) AS 'Last Backup Attempt JobId',

clientName AS 'Client',

(CASE WHEN created IS NOT NULL AND created &gt; 0

	THEN (SELECT DATEADD(ss, created + @browserBias, CAST('1970-01-01 00:00:00' AS DATETIME)))

END) AS 'Added to content on',

(CASE WHEN mailboxSize IS NULL THEN 0 ELSE mailboxSize END) AS 'Backup Size',

(CASE WHEN numberOfItems IS NULL THEN 0 ELSE numberOfItems END) AS 'Number Of Items',

(CASE WHEN mailboxStatus &lt;&gt; @STATUS_NOT_AVAILABLE THEN ISNULL(failedItems, 0) ELSE 0 END) AS 'Failed Items'

FROM 

(

	SELECT UP.displayName, UP.smtpAddress, UP.created,

	(SELECT DATEADD(ss, jobStartTime + @browserBias, CAST('1970-01-01 00:00:00' AS DATETIME))) AS [lastAttempt],

	backupReferenceTime AS [lastBackup],

	(CASE 

		WHEN MS.status IS NOT NULL AND (ISNULL(MS.jobStartTime, 0) &gt;= ISNULL(backupReferenceTime, 0) 

										OR ISNULL(backupReferenceTime, 0) BETWEEN ISNULL(MS.jobStartTime, 0) AND ISNULL(MS.jobEndTime, 0)) THEN MS.status

		WHEN ISNULL(backupReferenceTime, 0) &gt;= @depthRefTime THEN @STATUS_SUCCESS

		WHEN ISNULL(backupReferenceTime, 0) = 0 THEN @STATUS_NEVER_BACKED_UP 

		ELSE @STATUS_NOT_AVAILABLE 

	END) AS [mailboxStatus],

	UP.clientId, AC.displayName AS [clientName], jobId, failureReason, failedItems, mailboxSize, numberOfItems

	FROM #temp_unprotected_mailboxes_onedrive UP 

	LEFT JOIN App_Client AC WITH (NOLOCK) ON UP.clientId = AC.id

	LEFT JOIN #upm_temp_mailbox_summary_onedrive MS ON UP.userGUID = MS.userGUID AND UP.clientId = MS.clientId

	--WHERE (status = @STATUS_SKIPPED OR (MS.jobStartTime IS NULL OR MS.jobStartTime &gt; (CASE WHEN UP.backupReferenceTime IS NULL THEN 0 ELSE UP.backupReferenceTime END)))

) R

--ORDER BY jobId DESC, lastBackup DESC



IF OBJECT_ID('tempdb.dbo.#listClientIds_OneDrive') IS NOT NULL

	DROP TABLE #listClientIds_OneDrive



IF OBJECT_ID('tempdb.dbo.#upm_temp_mailbox_summary_onedrive') IS NOT NULL

	DROP TABLE #upm_temp_mailbox_summary_onedrive



IF OBJECT_ID('tempdb.dbo.#upm_temp_mailbox_summary_onedrive') IS NOT NULL

	DROP TABLE #upm_temp_mailbox_summary_onedrive



IF OBJECT_ID('tempdb.dbo.#temp_unprotected_mailboxes_onedrive') IS NOT NULL

	DROP TABLE #temp_unprotected_mailboxes_onedrive

</sqlText>
              <timeout>5</timeout>
              <postQueryFilter>true</postQueryFilter>
              <rDataSetQuery />
              <rPlotQuery />
            </GetOperation>
            <description>Backup Health Report for Office 365 Clients.</description>
            <databaseName>CommServ</databaseName>
            <queryPlan>
              <offline>false</offline>
              <collectionType>HTTP</collectionType>
              <retentionDays>1</retentionDays>
              <versions>
                <CommCellVersion>ALL</CommCellVersion>
              </versions>
              <dynamicCollection>false</dynamicCollection>
              <frequency>60</frequency>
              <direct>false</direct>
            </queryPlan>
            <version>144</version>
            <guid>0e7d384a-b165-4821-de45-810bedeab80b</guid>
            <hidden>true</hidden>
            <revision />
            <computedColumns>
              <scriptName>R</scriptName>
              <script />
              <columnList />
            </computedColumns>
          </DataSet>
          <DataSet>
            <dataSet>
              <dataSetName>OneDrive Client Groups</dataSetName>
              <dataSetGuid>c2dbc9d8-9a36-4da8-9692-8b0d05c493da</dataSetGuid>
            </dataSet>
            <endpoint>DATABASE</endpoint>
            <shared>false</shared>
            <dataSources>
              <DataSource>
                <connectionType>COMMCELL</connectionType>
                <endpoint>DATABASE</endpoint>
                <commCell>
                  <commCellName>$ALL$</commCellName>
                </commCell>
              </DataSource>
            </dataSources>
            <allColumns>false</allColumns>
            <fields>
              <Column>
                <name>sys_rowid</name>
                <dataField>$row_number$</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Data Source</name>
                <dataField>Data Source</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>groupId</name>
                <dataField>groupId</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>groupName</name>
                <dataField>groupName</dataField>
                <type>String</type>
              </Column>
            </fields>
            <GetOperation>
              <parameters />
              <sqlText>SET NOCOUNT ON
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED

DECLARE	@UserId		INT 
DECLARE @CV_APPTYPE_EXCHANGE_ONEPASS INT = 137
SELECT	@UserId = id FROM UMUsers WHERE login = @sys_username

DECLARE @CV_FLAG_COMMCELL_GROUP VARBINARY(8) = 0x40000
DECLARE	@ObjectType	INT = 2572		-- SERVER_GROUP_NAME_ITEM

IF OBJECT_ID('tempdb.dbo.#UserObjects') IS NOT NULL
	DROP TABLE #UserObjects

create table  #UserObjects ( 
	[capabilities]  bigint	NOT null, 
	[flag]			int NOT null default 0, 
	[commCellId]    int	NOT null default 2, 
	[clientGroupId] int	NOT null default 0, 
	[clientId]      int	NOT null default 0, 
	[appTypeId]     int	NOT null default 0, 
	[instanceId]    int	NOT null default 0, 
	[backupsetId]   int	NOT null default 0, 
	[subClientId]   int	NOT null default 0, 
	[mediaAgentId]  int	NOT null default 0, 
	[libraryId]     int	NOT null default 0, 
	[archGroupId]   int	NOT null default 0, 
	[vtContainerId] int	NOT null default 0, 
	[vtPolicyId]    int	NOT null default 0, 
	[vtShelfId]     int	NOT null default 0, 
	[reviewSetId]   int	NOT null default 0, 
	[querySetId]	int	NOT null default 0, 
	[downloadSetId] int	NOT null default 0, 
	[ermId]   		int	NOT null default 0, 
	[legalHoldId]   int	NOT null default 0, 
	[tagId]			int	NOT null default 0, 
	[cdPolicyId]    int	NOT null default 0, 
	[complianceReportId]   int	NOT null default 0, 
	[taskId]        int	NOT null default 0, 
	[workflowId]    int	NOT null default 0, 
	[logMonitoringPolicyId] int	NOT null default 0, 
	[arrayId]       int	NOT null default 0, 
	[cloudId]       int	NOT null default 0, 
	[userGroupId]   int	NOT null default 0, 
	[providerId]    int	NOT null default 0, 
	[entityId1]     int	NOT null default 0, 
	[entityId2]     int	NOT null default 0, 
	[entityId3]     int	NOT null default 0, 
	[entityId4]     int	NOT null default 0, 
	[entityId5]     int	NOT null default 0, 
	[entityId6]     int	NOT null default 0, 
	[entityId7]     int	NOT null default 0, 
	[entityId8]     int	NOT null default 0, 
	[entityId9]     int	NOT null default 0  )

EXEC sec_getUserObjects @UserId, @ObjectType, 0, '#UserObjects'

DECLARE @clientGroups TABLE (groupId INT, groupName NVARCHAR(255))

IF EXISTS (SELECT * FROM #UserObjects WHERE commCellId = 2 AND clientGroupId = 0)
	INSERT INTO @clientGroups (groupId, groupName)
	SELECT	CG.id, CG.name
	FROM	APP_ClientGroup CG WITH (NOLOCK)
        WHERE CG.Flag &amp; @CV_FLAG_COMMCELL_GROUP = 0
ELSE
	INSERT INTO @clientGroups (groupId, groupName)
	SELECT	CG.id, CG.name
	FROM	#UserObjects O
			INNER JOIN APP_ClientGroup CG WITH (NOLOCK) ON O.clientGroupId = CG.id 
        AND CG.Flag &amp; @CV_FLAG_COMMCELL_GROUP = 0
	WHERE	O.commCellId = 2 AND O.clientGroupId &gt; 0

SELECT groupId, groupName FROM @clientGroups WHERE groupId IN (SELECT DISTINCT clientGroupId FROM App_ClientGroupAssoc WITH (NOLOCK) WHERE clientId in (
SELECT id FROM App_Client WITH (NOLOCK) WHERE id IN (SELECT DISTINCT clientId FROM APP_Application WITH (NOLOCK)
WHERE subclientStatus &amp; 0x04 != 0x04 /*DELETED*/ AND subclientStatus &amp; 0x00020 != 0x00020 /*HIDDEN*/)
AND specialClientFlags &amp; 0x02 &lt;&gt; 0 /*Pseudo client*/))

IF OBJECT_ID('tempdb.dbo.#UserObjects') IS NOT NULL
	DROP TABLE #UserObjects</sqlText>
              <timeout>5</timeout>
              <postQueryFilter>true</postQueryFilter>
              <rDataSetQuery />
              <rPlotQuery />
            </GetOperation>
            <description>Backup Health Report for Office 365 Clients.</description>
            <databaseName>CommServ</databaseName>
            <queryPlan>
              <offline>false</offline>
              <collectionType>HTTP</collectionType>
              <retentionDays>1</retentionDays>
              <versions>
                <CommCellVersion>ALL</CommCellVersion>
              </versions>
              <dynamicCollection>false</dynamicCollection>
              <frequency>60</frequency>
              <direct>false</direct>
            </queryPlan>
            <version>144</version>
            <guid>c2dbc9d8-9a36-4da8-9692-8b0d05c493da</guid>
            <hidden>true</hidden>
            <revision />
            <computedColumns>
              <scriptName>R</scriptName>
              <script />
              <columnList />
            </computedColumns>
          </DataSet>
          <DataSet>
            <dataSet>
              <dataSetName>OneDrive Client SLA</dataSetName>
              <dataSetGuid>6ed2002f-2afd-4a4a-b468-901d12ffc14e</dataSetGuid>
            </dataSet>
            <endpoint>DATABASE</endpoint>
            <shared>false</shared>
            <dataSources>
              <DataSource>
                <connectionType>COMMCELL</connectionType>
                <endpoint>DATABASE</endpoint>
                <commCell>
                  <commCellName>$ALL$</commCellName>
                </commCell>
              </DataSource>
            </dataSources>
            <allColumns>false</allColumns>
            <fields>
              <Column>
                <name>sys_rowid</name>
                <dataField>$row_number$</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Data Source</name>
                <dataField>Data Source</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Client</name>
                <dataField>Client</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Client Status</name>
                <dataField>Client Status</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Index Status</name>
                <dataField>Index Status</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Last Indexed Backup JobId</name>
                <dataField>Last Indexed Backup JobId</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Last index time</name>
                <dataField>Last index time</dataField>
                <type>TimeStamp</type>
              </Column>
              <Column>
                <name>Last Index Error Time</name>
                <dataField>Last Index Error Time</dataField>
                <type>TimeStamp</type>
              </Column>
              <Column>
                <name>Last Discovery Time</name>
                <dataField>Last Discovery Time</dataField>
                <type>TimeStamp</type>
              </Column>
              <Column>
                <name>Last Backup Run Time</name>
                <dataField>Last Backup Run Time</dataField>
                <type>TimeStamp</type>
              </Column>
              <Column>
                <name>Last Backup Job ID</name>
                <dataField>Last Backup Job ID</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Associated Users</name>
                <dataField>Associated Users</dataField>
                <type>Long</type>
              </Column>
              <Column>
                <name>Users Backed-up</name>
                <dataField>Users Backed-up</dataField>
                <type>Long</type>
              </Column>
              <Column>
                <name>Users Not Backed-up</name>
                <dataField>Users Not Backed-up</dataField>
                <type>Long</type>
              </Column>
              <Column>
                <name>Users Never Backed-up</name>
                <dataField>Users Never Backed-up</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Users Backed-up (at least once)</name>
                <dataField>Users Backed-up (at least once)</dataField>
                <type>Long</type>
              </Column>
              <Column>
                <name>Users Recently Added</name>
                <dataField>Users Recently Added</dataField>
                <type>Long</type>
              </Column>
              <Column>
                <name>Users Need Attention</name>
                <dataField>Users Need Attention</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Application Size</name>
                <dataField>Application Size</dataField>
                <type>Long</type>
              </Column>
              <Column>
                <name>Number of Items</name>
                <dataField>Number of Items</dataField>
                <type>Long</type>
              </Column>
              <Column>
                <name>Indexed Items</name>
                <dataField>Indexed Items</dataField>
                <type>Long</type>
              </Column>
              <Column>
                <name>Azure Apps Associated</name>
                <dataField>Azure Apps Associated</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Azure Apps Not Authorized</name>
                <dataField>Azure Apps Not Authorized</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Azure Apps To Be Added</name>
                <dataField>Azure Apps To Be Added</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Last Verify Connection Time</name>
                <dataField>Last Verify Connection Time</dataField>
                <type>TimeStamp</type>
              </Column>
              <Column>
                <name>Max Streams</name>
                <dataField>Max Streams</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Access Node Group</name>
                <dataField>Access Node Group</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Index Server</name>
                <dataField>Index Server</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Active Jobs</name>
                <dataField>Active Jobs</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>joburl</name>
                <dataField>joburl</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>backupjoburl</name>
                <dataField>backupjoburl</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>clienturl</name>
                <dataField>clienturl</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>activejobsurl</name>
                <dataField>activejobsurl</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>accessNodeGroupUrl</name>
                <dataField>accessNodeGroupUrl</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>indexserverurl</name>
                <dataField>indexserverurl</dataField>
                <type>String</type>
              </Column>
            </fields>
            <GetOperation>
              <parameters>
                <Parameter>
                  <name>Clients</name>
                  <dataType>Integer</dataType>
                  <isList>true</isList>
                  <values>
                    <string>=input.OneDriveClients</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>ClientGroups</name>
                  <dataType>Integer</dataType>
                  <isList>true</isList>
                  <values>
                    <string>=input.ClientGroups</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>timeframe</name>
                  <dataType>DateRange</dataType>
                  <values>
                    <string>=input.Timeframe</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>Options</name>
                  <dataType>String</dataType>
                  <isList>true</isList>
                  <values>
                    <string>=input.Options</string>
                  </values>
                </Parameter>
              </parameters>
              <sqlText>-- constants

DECLARE @CV_APPTYPE_CLOUD_APPS INT = 134

DECLARE @MAX_USERS_FOR_FIVE_CONNECTIONS INT = 10000

DECLARE @TENANT_DIACTIVEVATED INT = 101

DECLARE @LICENSE_RELEASED INT = 102

DECLARE @EXCLUDED_FROM_SLA INT = 103



-- variables

DECLARE @userId INT = (SELECT TOP 1 id FROM UMUsers WITH (NOLOCK) WHERE login = @sys_username)

DECLARE @companyId INT

DECLARE @includeBackupDisabledClients INT = 0



DECLARE @recentlyAddedNumberOfDays INT = 7

DECLARE @recentlyAddedRefTime INT = dbo.getunixtime(DATEADD(HOUR, -@recentlyAddedNumberOfDays*24 , GETUTCDATE()))



IF OBJECT_ID('tempdb.dbo.#listClientIds_OneDrive') IS NOT NULL

	DROP TABLE #listClientIds_OneDrive



CREATE TABLE #listClientIds_OneDrive (clientId INT, subclientId INT, backupsetId INT, instanceId INT, isBackupDisabled INT DEFAULT 0)

CREATE NONCLUSTERED INDEX #listClientIds_OneDrive_c_s_b_i_ids ON #listClientIds_OneDrive(clientId, subclientId, backupsetId, instanceId)



-- read inputs

SET @companyId = dbo.AppGetOrganizationForUser(@userId)



IF OBJECT_ID('tempdb.dbo.#temp__clientIds') IS NOT NULL

	DROP TABLE #temp__clientIds



CREATE TABLE #temp__clientIds

(

	clientId            INT,

	appTypeId           INT,

	instanceId          INT,

	backupsetId         INT,

	subclientId         INT

)



IF NOT EXISTS (SELECT Clients FROM @Clients) AND NOT EXISTS (SELECT ClientGroups FROM @ClientGroups)

BEGIN 

	IF @companyId &gt; 0

	BEGIN

		INSERT INTO #temp__clientIds (clientId)

		SELECT DISTINCT CGA.clientId

		FROM UMDSProviders UMDS WITH (NOLOCK)

		JOIN App_CompanyProp CP WITH (NOLOCK) ON CP.attrName = 'Associated Smart Client Group' AND CP.modified = 0

		JOIN APP_ClientGroupAssoc CGA WITH (NOLOCK) ON CAST(CGA.clientGroupId AS NVARCHAR(16)) = CP.attrVal

		JOIN APP_ClientGroup CG WITH (NOLOCK) ON CGA.clientGroupId = CG.id

		WHERE CP.componentNameId = @companyId AND CG.flag &amp; 0x1000 &gt; 0



		-- include clients belongs to logged in users company

		INSERT INTO #listClientIds_OneDrive (clientId)

		SELECT DISTINCT TC.clientId

		FROM #temp__clientIds TC

		INNER JOIN APP_Application AA WITH (NOLOCK) ON TC.clientId = AA.clientId

		WHERE AA.appTypeId = @CV_APPTYPE_CLOUD_APPS AND subclientStatus &amp; 0x04 != 0x04 /*DELETED*/ AND subclientStatus &amp; 0x00020 != 0x00020 /*HIDDEN*/

	END

	ELSE

	BEGIN

		EXEC sec_getIdaObjectsForUser @userId, 3 /*Client Entity*/, 0, 0, '#temp__clientIds', 1



		-- include all clients user has access to

		INSERT INTO #listClientIds_OneDrive (clientId)

		SELECT DISTINCT TC.clientId

		FROM #temp__clientIds TC

		INNER JOIN APP_Application AA WITH (NOLOCK) ON TC.clientId = AA.clientId

		WHERE AA.appTypeId = @CV_APPTYPE_CLOUD_APPS AND subclientStatus &amp; 0x04 != 0x04 /*DELETED*/ AND subclientStatus &amp; 0x00020 != 0x00020 /*HIDDEN*/

	END

END

ELSE

BEGIN

	INSERT INTO #listClientIds_OneDrive (clientId)

	SELECT DISTINCT Clients FROM @Clients

	UNION

	SELECT DISTINCT CG.clientId FROM App_ClientGroupAssoc CG WITH (NOLOCK)

	INNER JOIN APP_Application AA WITH (NOLOCK) ON CG.clientId = AA.clientId AND AA.appTypeId = @CV_APPTYPE_CLOUD_APPS

	WHERE clientGroupId IN (SELECT ClientGroups FROM @ClientGroups)

	AND subclientStatus &amp; 0x04 != 0x04 /*DELETED*/ AND subclientStatus &amp; 0x00020 != 0x00020 /*HIDDEN*/



	EXEC dbo.sec_getIdaObjectsForUser @userId, 3 /*Client Entity*/, 0, 0, '#temp__clientIds', 1



	DELETE FROM #listClientIds_OneDrive

	WHERE clientId NOT IN (SELECT clientId FROM #temp__clientIds)

END



IF OBJECT_ID('tempdb.dbo.#temp__clientIds') IS NOT NULL

	DROP TABLE #temp__clientIds



DELETE #listClientIds_OneDrive

FROM #listClientIds_OneDrive C INNER JOIN App_Client AC WITH (NOLOCK) ON C.clientId = AC.id

WHERE AC.specialClientFlags &amp; 0x02 = 0 /*Not Pseudo client*/



DELETE FROM #listClientIds_OneDrive

WHERE clientId NOT IN 

(SELECT componentNameId FROM App_ClientProp WITH (NOLOCK) WHERE attrName = 'Office 365 Pseudo Client' AND attrVal = 1 /*V2 client*/ AND modified = 0

AND componentNameId IN (SELECT clientId FROM #listClientIds_OneDrive))



DELETE FROM #listClientIds_OneDrive

WHERE clientId NOT IN

(SELECT C.clientId FROM #listClientIds_OneDrive C 

INNER JOIN APP_Application AA WITH (NOLOCK) ON C.clientId = AA.clientId

INNER JOIN APP_InstanceProp AI WITH (NOLOCK) ON AA.instance = AI.componentNameId

WHERE appTypeId = @CV_APPTYPE_CLOUD_APPS AND attrName = 'Cloud Apps Instance Type' AND attrVal = 7 /*OneDrive*/)



DECLARE @csTimeZoneId			INT = 0

DECLARE @csTimeZone				NVARCHAR(1024) = ''

DECLARE @browserBias			INT = 0

DECLARE @browserTimeZoneId		INT = 0



SET @browserTimeZoneId = (SELECT TOP 1 TimeZoneID FROM SchedTimeZone WITH (NOLOCK) WHERE TimeZoneName LIKE '%' + @sys_timezone + '%')

SELECT @browserBias = Bias FROM SchedTimeZone WITH (NOLOCK) WHERE TimeZoneID = @browserTimeZoneId



SELECT @csTimeZoneId = (SELECT TOP 1 attrVal FROM APP_ClientProp WITH (NOLOCK) WHERE attrName = 'Commcell timezone Id' AND modified = 0)

IF ISNULL(@csTimeZoneId, 0) = 0

	SELECT @csTimeZoneId = (SELECT TOP 1 attrVal FROM APP_ClientProp WITH (NOLOCK) WHERE componentNameId = 2 AND attrName = 'timezone Id' AND modified = 0)

SET @csTimeZone = (SELECT TOP 1 TimeZoneName FROM SchedTimeZone WITH (NOLOCK) WHERE TimeZoneID = @csTimeZoneId)



DECLARE @startTime BIGINT = DATEDIFF(SS, '1970-01-01', dbo.LocalToUTCDateTimeConversionManaged(ISNULL(@timeframe_from,'1970-01-01 00:00:00.000'), @csTimeZone))



IF EXISTS (SELECT Options FROM @Options WHERE Options = 'Show backup disabled clients')

	SET @includeBackupDisabledClients = 1



UPDATE #listClientIds_OneDrive

SET subclientId = S.subclientId, backupsetId = S.backupSet, instanceId = S.instance

FROM (SELECT MIN(id) AS subclientId, clientId, backupSet, instance

		FROM APP_Application WITH (NOLOCK)

		WHERE clientId IN (SELECT clientId FROM #listClientIds_OneDrive)

		GROUP BY clientId, backupSet, instance

	) S WHERE #listClientIds_OneDrive.clientId = S.clientId



UPDATE #listClientIds_OneDrive

SET isBackupDisabled = JA.action

FROM JMJobAction JA WITH (NOLOCK)

INNER JOIN #listClientIds_OneDrive TOD ON TOD.subclientId = JA.appId

WHERE JA.clientId = 1 AND JA.mediaAgentID = 1 AND JA.appType = 0 AND JA.optype = 4



UPDATE #listClientIds_OneDrive

SET isBackupDisabled = @LICENSE_RELEASED

FROM APP_Application(NOLOCK) AA

WHERE AA.id = #listClientIds_OneDrive.subclientId AND subclientStatus &amp; 0x02 = 0x02



UPDATE #listClientIds_OneDrive

SET isBackupDisabled = @EXCLUDED_FROM_SLA

FROM APP_SubClientProp ASP WITH (NOLOCK)

WHERE ASP.componentNameId = #listClientIds_OneDrive.subclientId AND ASP.attrName = 'Exclude From SLA' AND ASP.attrVal = 1 AND ASP.modified = 0



UPDATE #listClientIds_OneDrive

SET isBackupDisabled = @TENANT_DIACTIVEVATED

WHERE clientId IN (SELECT DISTINCT CGA.clientId

	FROM UMDSProviders UMDS WITH (NOLOCK)

	JOIN App_CompanyProp CP WITH (NOLOCK) ON CP.attrName = 'Associated Smart Client Group' AND CP.modified = 0 AND UMDS.id = CP.componentNameId

	JOIN APP_ClientGroupAssoc CGA WITH (NOLOCK) ON CAST(CGA.clientGroupId AS NVARCHAR(16)) = CP.attrVal

	WHERE UMDS.flags &amp; 0x0010 = 0x0010 OR enabled = 0)	



IF @includeBackupDisabledClients = 0

	DELETE FROM #listClientIds_OneDrive WHERE isBackupDisabled IN (1, @TENANT_DIACTIVEVATED, @LICENSE_RELEASED, @EXCLUDED_FROM_SLA)



IF OBJECT_ID('tempdb.dbo.#temp_unprotected_mailboxes_onedrive_sla') IS NOT NULL

	DROP TABLE #temp_unprotected_mailboxes_onedrive_sla



CREATE TABLE #temp_unprotected_mailboxes_onedrive_sla

(

	created BIGINT,

	backupReferenceTime BIGINT,

	clientId INT,

	isProtected INT

)

CREATE CLUSTERED INDEX #Idx1_temp_um_od_sla_clientId ON #temp_unprotected_mailboxes_onedrive_sla (clientId)



INSERT INTO #temp_unprotected_mailboxes_onedrive_sla (created, backupReferenceTime, clientId, isProtected)

SELECT created, CU.backupReferenceTime, TOD.clientId,

(CASE WHEN (backupReferenceTime &lt; @startTime OR backupReferenceTime IS NULL) THEN 0/*unprotected*/ ELSE 1/*protected*/ END)

FROM App_CloudAppUserDetails CU WITH (NOLOCK)

INNER JOIN #listClientIds_OneDrive TOD ON TOD.subclientId = CU.subClientId

WHERE CU.discoverByType = 1 AND CU.modified = 0 AND CU.status = 0 /*Active*/ AND CU.smtpAddress IS NOT NULL



IF OBJECT_ID('tempdb.dbo.#onedrive_client_sla') IS NOT NULL

	DROP TABLE #onedrive_client_sla



CREATE TABLE #onedrive_client_sla

(

	clientId INT UNIQUE CLUSTERED,

	clientName NVARCHAR(255),

	clientDisplayName NVARCHAR(255),

	totalEntities BIGINT,

	slaMissedEntities BIGINT,

	neverBackedUp INT,

	recentlyAddedEntities BIGINT,

	needAttention INT,

	clientStatus NVARCHAR(32) DEFAULT 'Active',

	lastIndexPlaybackTime BIGINT,

	lastIndexBkpJobId INT,

	lastIndexErrorTime BIGINT,

	lastDiscoverTime BIGINT,

	lastBackupJobRunTime BIGINT,

	lastBackupJobId BIGINT,

	applicationSize BIGINT,

	numberOfItems BIGINT,

	itemsContentIndexed BIGINT,

	azureApps INT DEFAULT 0,

	authoziedAzureApps INT DEFAULT 0,

	lastVerifyConnectionTime BIGINT,

	streams INT,

	isModernAuthEnabled INT DEFAULT 1,

	accessNodeGroupId INT,

	accessNodeGroupDisplayName NVARCHAR(255),

	indexServerId INT,

	indexServerCloudId INT,

	indexServerName NVARCHAR(255),

	indexServerDisplayName NVARCHAR(255),

	clienturl NVARCHAR(2048),

	activejobsurl NVARCHAR(2048),

	indexserverurl NVARCHAR(2048),

	accessNodeGroupUrl NVARCHAR(2048)

)



INSERT INTO #onedrive_client_sla (clientId, totalEntities, slaMissedEntities, neverBackedUp, recentlyAddedEntities, needAttention)

SELECT

clientId,

COUNT(*),

SUM(CASE WHEN isProtected = 0 THEN 1 ELSE 0 END),

SUM(CASE WHEN backupReferenceTime IS NULL OR backupReferenceTime = 0 THEN 1 ELSE 0 END),

SUM(CASE WHEN created IS NOT NULL AND created &gt;= @recentlyAddedRefTime THEN 1 ELSE 0 END),

SUM(CASE WHEN (backupReferenceTime IS NULL OR backupReferenceTime = 0) AND @recentlyAddedRefTime &gt; created THEN 1 ELSE 0 END)

FROM #temp_unprotected_mailboxes_onedrive_sla

GROUP BY clientId



INSERT INTO #onedrive_client_sla (clientId, totalEntities, slaMissedEntities, neverBackedUp, recentlyAddedEntities, needAttention)

SELECT clientId, 0, 0, 0, 0, 0

FROM #listClientIds_OneDrive TOD

WHERE TOD.clientId NOT IN (SELECT clientId FROM #onedrive_client_sla)



UPDATE #onedrive_client_sla

SET clientName = AC.name, clientDisplayName = AC.displayName

FROM APP_Client AC WITH (NOLOCK)

WHERE #onedrive_client_sla.clientId = AC.id



UPDATE #onedrive_client_sla

SET lastIndexPlaybackTime = Idx.playbackTime, lastIndexBkpJobId = Idx.bkpJobId, lastIndexErrorTime = Idx.errorTime, applicationSize = Idx.backupSize, numberOfItems = Idx.numberOfItems, itemsContentIndexed = Idx.itemsContentIndexed

FROM

(

	SELECT I.properties.value('Indexing_DbStats[1]/@lastPlayedBkpTime', 'BIGINT') AS playbackTime, I.properties.value('(Indexing_DbStats/apps)[1]/@lastPlayedBkpJobId', 'INT') AS bkpJobId, 

	I.properties.value('Indexing_DbStats[1]/@lastIdxErrorTime', 'INT') AS errorTime, TOD.clientId AS clientId,

	ISNULL(I.properties.value('(Indexing_DbStats/apps/stat)[1]/@applicationSize', 'BIGINT'), 0) AS backupSize, ISNULL(I.properties.value('(Indexing_DbStats/apps/stat)[1]/@itemsIndexed', 'BIGINT'), 0) AS numberOfItems,

	ISNULL(I.properties.value('(Indexing_DbStats/apps/stat)[1]/@itemsContentIndexed', 'BIGINT'), 0) AS itemsContentIndexed

	FROM IdxDbState I WITH (NOLOCK)

	INNER JOIN App_IndexDbInfo AI WITH (NOLOCK) ON I.dbid = AI.id

	INNER JOIN #listClientIds_OneDrive TOD ON TOD.backupsetId = AI.backupSetId

) Idx WHERE Idx.clientId = #onedrive_client_sla.clientId



UPDATE #onedrive_client_sla

SET lastDiscoverTime = DS.value('App_Office365DiscoverState[1]/@lastCacheUpdateTime', 'BIGINT')

FROM

(

	SELECT TOD.clientId AS clientId, CAST(CAST(attrVal AS VARCHAR(MAX)) AS XML) DS

	FROM App_InstanceProp AIP WITH (NOLOCK)

	INNER JOIN #listClientIds_OneDrive TOD ON AIP.componentNameId = TOD.instanceId

	WHERE AIP.attrName = 'Discovery State' AND AIP.modified = 0 

	AND created = (SELECT MAX(created) FROM APP_InstanceProp WITH (NOLOCK) WHERE componentNameId = AIP.componentNameId AND attrName = 'Discovery State' AND modified = 0)

) D WHERE D.clientId = #onedrive_client_sla.clientId



UPDATE #onedrive_client_sla

SET lastBackupJobRunTime = LBJ.value('(lastBackupJobInfo/endTime)[1]/@time', 'BIGINT'), lastBackupJobId = LBJ.value('(lastBackupJobInfo)[1]/@jobID', 'BIGINT')

FROM

(

	SELECT AIN.clientId AS clientId, CAST(CAST(attrVal AS VARCHAR(MAX)) AS XML) AS LBJ

	FROM App_IdaProp AIP WITH (NOLOCK)

	INNER JOIN App_IdaName AIN WITH (NOLOCK) ON AIP.componentNameId = AIN.id AND AIN.appTypeId = @CV_APPTYPE_CLOUD_APPS

	WHERE AIN.clientId IN (select clientId FROM #listClientIds_OneDrive) AND AIP.attrName = 'Last Backup Job Info' AND AIP.modified = 0

) D WHERE D.clientId = #onedrive_client_sla.clientId



IF @includeBackupDisabledClients = 1

	UPDATE #onedrive_client_sla

	SET clientStatus = (CASE 

							WHEN isBackupDisabled = 1 THEN 'Backup Activity is Disabled'

							WHEN isBackupDisabled = @TENANT_DIACTIVEVATED THEN 'Tenant Deactivated/Disabled'

							WHEN isBackupDisabled = @LICENSE_RELEASED THEN 'License Released'

							WHEN isBackupDisabled = @EXCLUDED_FROM_SLA THEN 'Excluded From SLA'

							ELSE 'Active'

						END)

	FROM #listClientIds_OneDrive

	WHERE #onedrive_client_sla.clientId = #listClientIds_OneDrive.clientId AND isBackupDisabled IN (1, @TENANT_DIACTIVEVATED, @LICENSE_RELEASED, @EXCLUDED_FROM_SLA)



UPDATE #onedrive_client_sla

SET azureApps = CAST(CAST(AIP.attrVal AS VARCHAR(MAX)) AS XML).value('count(/App_Office365AzureConnections/azureApps)', 'int'),

	authoziedAzureApps = CAST(CAST(AIP.attrVal AS VARCHAR(MAX)) AS XML).value('count(/App_Office365AzureConnections//*[@appStatus="1"])', 'int')

FROM #listClientIds_OneDrive TOD

INNER JOIN App_InstanceProp AIP WITH (NOLOCK) ON TOD.instanceId = AIP.componentNameId

WHERE #onedrive_client_sla.clientId = TOD.clientId AND attrName = 'OneDrive Azure Connections' AND modified = 0



UPDATE #onedrive_client_sla

SET authoziedAzureApps = CAST(CAST(AIP.attrVal AS VARCHAR(MAX)) AS XML).value('count(/App_Office365AzureConnectionsStatus/azureAppList//*[@appStatus="1"])', 'int'),

    lastVerifyConnectionTime = CAST(CAST(AIP.attrVal AS VARCHAR(MAX)) AS XML).value('(//@lastAzureAppStatusUpdate)[1]', 'BIGINT')

FROM #listClientIds_OneDrive TOD

INNER JOIN App_InstanceProp AIP WITH (NOLOCK) ON TOD.instanceId = AIP.componentNameId

WHERE #onedrive_client_sla.clientId = TOD.clientId AND attrName = 'Office365 Azure Connections Status' AND modified = 0



UPDATE #onedrive_client_sla

SET streams = CAST(attrVal AS INT)

FROM #listClientIds_OneDrive TE

INNER JOIN APP_SubClientProp ASP WITH (NOLOCK) ON TE.subclientId = ASP.componentNameId

WHERE #onedrive_client_sla.clientId = TE.clientId AND attrName = 'sys:nStreams' AND modified = 0



UPDATE #onedrive_client_sla

SET accessNodeGroupId = CAST(CAST(attrVal AS VARCHAR(MAX)) AS XML).value('(//@clientGroupId)[1]', 'int'),

	accessNodeGroupDisplayName = CAST(CAST(attrVal AS VARCHAR(MAX)) AS XML).value('(//@clientGroupName)[1]', 'nvarchar(max)')

FROM #listClientIds_OneDrive TOD

INNER JOIN APP_InstanceProp AIP WITH (NOLOCK) ON TOD.instanceId = AIP.componentNameId

WHERE #onedrive_client_sla.clientId = TOD.clientId AND attrName = 'Proxy Clients' AND AIP.modified = 0



UPDATE #onedrive_client_sla

SET indexServerId = AIP.attrVal

FROM #listClientIds_OneDrive TOD

INNER JOIN App_InstanceProp AIP WITH (NOLOCK) ON TOD.instanceId = AIP.componentNameId

WHERE #onedrive_client_sla.clientId = TOD.clientId AND AIP.attrName = 'OneDrive Index Server' AND AIP.modified = 0



UPDATE #onedrive_client_sla

SET indexServerCloudId = ISNULL(DC.cloudId, 0)

FROM DM2Cloud DC WITH (NOLOCK)

WHERE #onedrive_client_sla.indexServerId = DC.pseudoClientId



UPDATE #onedrive_client_sla

SET indexServerName = AC.name, indexServerDisplayName = AC.displayName

FROM APP_Client AC WITH (NOLOCK)

WHERE #onedrive_client_sla.indexServerId = AC.id



UPDATE #onedrive_client_sla

SET clienturl = '#/office365/clientDetails/' + indexServerName + '/' + CAST(TOD.clientId AS NVARCHAR(64)) + '/' + CAST(TOD.subclientId AS NVARCHAR(64)) + '/users?backupsetId=' + CAST(TOD.backupsetId AS NVARCHAR(64)),

	activejobsurl = '#/activeJobs?activeJobs=0&amp;serverName=' + indexServerName + '&amp;serverId=' + CAST(TOD.clientId AS NVARCHAR(64)) + '&amp;applicationId=134',

	indexserverUrl = '#/indexServer/configuration/' + CAST(indexServerId AS NVARCHAR(64)) + '?name=' + indexServerName + '&amp;cloudId=' + CAST(indexServerCloudId AS NVARCHAR(64)),

	accessNodeGroupUrl = '#/clientGroupDetails/' + CAST(accessNodeGroupId AS NVARCHAR(64))

FROM #listClientIds_OneDrive TOD

WHERE #onedrive_client_sla.clientId = TOD.clientId



SELECT

clientDisplayName AS 'Client',

clientStatus AS 'Client Status',

(CASE WHEN lastIndexPlaybackTime IS NOT NULL AND lastIndexPlaybackTime &gt;= @startTime THEN 'UpToDate' ELSE 'Pending playback' END) AS 'Index Status',

(CASE WHEN lastIndexBkpJobId IS NOT NULL AND lastIndexBkpJobId &gt; 0 THEN CAST(lastIndexBkpJobId AS VARCHAR(64)) ELSE '' END) AS 'Last Indexed Backup JobId',

(CASE WHEN lastIndexPlaybackTime IS NOT NULL AND lastIndexPlaybackTime &gt; 0 

	THEN (SELECT DATEADD(ss, lastIndexPlaybackTime + @browserBias, CAST('1970-01-01 00:00' AS DATETIME)))

END) AS 'Last index time',

(CASE WHEN lastIndexErrorTime IS NOT NULL AND lastIndexErrorTime &gt; 0 

	THEN (SELECT DATEADD(ss, lastIndexErrorTime + @browserBias, CAST('1970-01-01 00:00' AS DATETIME)))

END) AS 'Last Index Error Time',

(CASE WHEN lastDiscoverTime IS NOT NULL AND lastDiscoverTime &gt; 0 

	THEN (SELECT DATEADD(ss, lastDiscoverTime + @browserBias, CAST('1970-01-01 00:00' AS DATETIME)))

END) AS 'Last Discovery Time',

(CASE WHEN ISNULL(lastBackupJobRunTime, 0) &gt; 0 

	THEN (SELECT DATEADD(ss, lastBackupJobRunTime + @browserBias, CAST('1970-01-01 00:00' AS DATETIME)))

END) AS 'Last Backup Run Time',

(CASE

	WHEN ISNULL(lastBackupJobId, 0) &gt; 0 THEN CAST(lastBackupJobId AS VARCHAR(64))

	ELSE ''

END) AS 'Last Backup Job ID',

totalEntities AS 'Associated Users',

(totalEntities - slaMissedEntities) AS 'Users Backed-up',

slaMissedEntities AS 'Users Not Backed-up',

neverBackedUp AS 'Users Never Backed-up',

(totalEntities - neverBackedUp) AS 'Users Backed-up (at least once)',

recentlyAddedEntities AS 'Users Recently Added',

needAttention AS 'Users Need Attention',

applicationSize AS 'Application Size',

numberOfItems AS 'Number of Items',

itemsContentIndexed AS 'Indexed Items',

azureApps AS 'Azure Apps Associated',

azureApps - authoziedAzureApps AS 'Azure Apps Not Authorized',

(CASE 

	WHEN isModernAuthEnabled = 1 AND totalEntities &lt; @MAX_USERS_FOR_FIVE_CONNECTIONS AND azureApps &lt; 5 THEN 5 - azureApps

	WHEN isModernAuthEnabled = 1 AND totalEntities &gt;= @MAX_USERS_FOR_FIVE_CONNECTIONS AND azureApps &lt; 10 THEN 10 - azureApps

	ELSE 0 

END) AS 'Azure Apps To Be Added',

(CASE

	WHEN ISNULL(lastVerifyConnectionTime, 0) &gt; 0 THEN (SELECT DATEADD(ss, lastVerifyConnectionTime + @browserBias, CAST('1970-01-01 00:00' AS DATETIME)))

END) AS 'Last Verify Connection Time',

streams AS 'Max Streams',

ISNULL(accessNodeGroupDisplayName, '') AS 'Access Node Group',

ISNULL(indexServerDisplayName, '') AS 'Index Server',

'Active Jobs' AS 'Active Jobs',

(CASE WHEN lastIndexBkpJobId IS NOT NULL AND lastIndexBkpJobId &gt; 0 

	THEN '#/jobs/' + CAST(lastIndexBkpJobId AS NVARCHAR(256))

	ELSE ''

END) AS 'joburl',

(CASE WHEN ISNULL(lastBackupJobId, 0) &gt; 0

	THEN '#/jobs/' + CAST(lastBackupJobId AS NVARCHAR(256))

	ELSE ''

END) AS 'backupjoburl',

clienturl AS 'clienturl',

activejobsurl AS 'activejobsurl',

ISNULL(accessNodeGroupUrl, '') AS 'accessNodeGroupUrl',

indexserverurl AS 'indexserverurl'

FROM #onedrive_client_sla

ORDER BY totalEntities DESC



IF OBJECT_ID('tempdb.dbo.#listClientIds_OneDrive') IS NOT NULL

	DROP TABLE #listClientIds_OneDrive



IF OBJECT_ID('tempdb.dbo.#temp_unprotected_mailboxes_onedrive_sla') IS NOT NULL

	DROP TABLE #temp_unprotected_mailboxes_onedrive_sla



IF OBJECT_ID('tempdb.dbo.#onedrive_client_sla') IS NOT NULL

	DROP TABLE #onedrive_client_sla</sqlText>
              <timeout>5</timeout>
              <postQueryFilter>true</postQueryFilter>
              <rDataSetQuery />
              <rPlotQuery />
            </GetOperation>
            <description>Backup Health Report for Office 365 Clients.</description>
            <databaseName>CommServ</databaseName>
            <queryPlan>
              <offline>false</offline>
              <collectionType>HTTP</collectionType>
              <retentionDays>1</retentionDays>
              <versions>
                <CommCellVersion>ALL</CommCellVersion>
              </versions>
              <dynamicCollection>false</dynamicCollection>
              <frequency>60</frequency>
              <direct>false</direct>
            </queryPlan>
            <version>144</version>
            <guid>6ed2002f-2afd-4a4a-b468-901d12ffc14e</guid>
            <hidden>true</hidden>
            <revision />
            <computedColumns>
              <scriptName>R</scriptName>
              <script />
              <columnList />
            </computedColumns>
          </DataSet>
          <DataSet>
            <dataSet>
              <dataSetName>Client Discovery</dataSetName>
              <dataSetGuid>485a1e12-bc39-422c-b57b-5f667dbbe4b7</dataSetGuid>
            </dataSet>
            <endpoint>DATASET</endpoint>
            <shared>false</shared>
            <dataSources>
              <DataSource>
                <connectionType>COMMCELL</connectionType>
                <commCell>
                  <commCellName>$LocalCommCell$</commCellName>
                </commCell>
              </DataSource>
            </dataSources>
            <allColumns>false</allColumns>
            <fields>
              <Column>
                <name>sys_rowid</name>
                <dataField>$row_number$</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Data Source</name>
                <dataField>Data Source</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Client</name>
                <dataField>Client</dataField>
                <type>String</type>
              </Column>
            </fields>
            <GetOperation>
              <parameters>
                <Parameter>
                  <name>Clients</name>
                  <dataType>Integer</dataType>
                  <isList>true</isList>
                  <values>
                    <string>=input.OneDriveClients</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>ClientGroups</name>
                  <dataType>Integer</dataType>
                  <isList>true</isList>
                  <values>
                    <string>=input.ClientGroups</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>timeframe</name>
                  <dataType>DateRange</dataType>
                  <values>
                    <string>=input.Timeframe</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>Options</name>
                  <dataType>String</dataType>
                  <isList>true</isList>
                  <values>
                    <string>=input.Options</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>natimeframe</name>
                  <dataType>DateRange</dataType>
                  <values>
                    <string>=input.NATimeRange</string>
                  </values>
                </Parameter>
              </parameters>
              <sqlText>SELECT Client FROM :[OneDrive Client SLA]
WHERE [Last Discovery Time] &lt; @natimeframe_from OR [Last Discovery Time] IS NULL</sqlText>
              <timeout>5</timeout>
              <postQueryFilter>true</postQueryFilter>
              <rDataSetQuery />
              <rPlotQuery />
            </GetOperation>
            <description>Backup Health Report for Office 365 Clients.</description>
            <databaseName>CommServ</databaseName>
            <queryPlan>
              <offline>false</offline>
              <retentionDays>1</retentionDays>
              <versions>
                <CommCellVersion>ALL</CommCellVersion>
              </versions>
              <dynamicCollection>false</dynamicCollection>
              <frequency>60</frequency>
              <direct>true</direct>
            </queryPlan>
            <version>64</version>
            <guid>485a1e12-bc39-422c-b57b-5f667dbbe4b7</guid>
            <revision />
          </DataSet>
          <DataSet>
            <dataSet>
              <dataSetName>Clients Index</dataSetName>
              <dataSetGuid>f28d865a-69a1-4992-828f-3a4ae8d9cf33</dataSetGuid>
            </dataSet>
            <endpoint>DATASET</endpoint>
            <shared>false</shared>
            <dataSources>
              <DataSource>
                <connectionType>COMMCELL</connectionType>
                <commCell>
                  <commCellName>$LocalCommCell$</commCellName>
                </commCell>
              </DataSource>
            </dataSources>
            <allColumns>false</allColumns>
            <fields>
              <Column>
                <name>sys_rowid</name>
                <dataField>$row_number$</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Data Source</name>
                <dataField>Data Source</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Client</name>
                <dataField>Client</dataField>
                <type>String</type>
              </Column>
            </fields>
            <GetOperation>
              <parameters>
                <Parameter>
                  <name>Clients</name>
                  <dataType>Integer</dataType>
                  <isList>true</isList>
                  <values>
                    <string>=input.OneDriveClients</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>ClientGroups</name>
                  <dataType>Integer</dataType>
                  <isList>true</isList>
                  <values>
                    <string>=input.ClientGroups</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>timeframe</name>
                  <dataType>DateRange</dataType>
                  <values>
                    <string>=input.Timeframe</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>Options</name>
                  <dataType>String</dataType>
                  <isList>true</isList>
                  <values>
                    <string>=input.Options</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>natimeframe</name>
                  <dataType>DateRange</dataType>
                  <isList>false</isList>
                  <values>
                    <string>=input.NATimeRange</string>
                  </values>
                </Parameter>
              </parameters>
              <sqlText>SELECT Client FROM :[OneDrive Client SLA]
WHERE [Last index time] &lt; @natimeframe_from OR [Last index time] IS NULL</sqlText>
              <timeout>5</timeout>
              <postQueryFilter>true</postQueryFilter>
              <rDataSetQuery />
              <rPlotQuery />
            </GetOperation>
            <description>Backup Health Report for Office 365 Clients.</description>
            <databaseName>CommServ</databaseName>
            <queryPlan>
              <offline>false</offline>
              <retentionDays>1</retentionDays>
              <versions>
                <CommCellVersion>ALL</CommCellVersion>
              </versions>
              <dynamicCollection>false</dynamicCollection>
              <frequency>60</frequency>
              <direct>true</direct>
            </queryPlan>
            <version>63</version>
            <guid>f28d865a-69a1-4992-828f-3a4ae8d9cf33</guid>
            <revision />
          </DataSet>
        </dataSet>
      </dataSets>
      <inputs>
        <RptInput>
          <id>CommCell</id>
          <displayName>CommCell</displayName>
          <defaultValue>2</defaultValue>
          <type>Commcell</type>
          <controlType>ListBox</controlType>
          <required>false</required>
          <allowMultipleSelection>true</allowMultipleSelection>
          <fromDataSet>true</fromDataSet>
          <dataSetEntity>
            <dataSetName>CommcellList</dataSetName>
            <dataSetGuid>36711099-c17b-4857-b2d6-2d26e52c6aec</dataSetGuid>
          </dataSetEntity>
          <labelField>CCHostName</labelField>
          <valueField>id</valueField>
          <dependsOn />
          <relativeOptions />
        </RptInput>
        <RptInput>
          <id>OneDriveClients</id>
          <displayName>OneDrive Clients</displayName>
          <defaultValue />
          <type>Integer</type>
          <controlType>ListBox</controlType>
          <required>false</required>
          <allowMultipleSelection>true</allowMultipleSelection>
          <hideAllSelection>true</hideAllSelection>
          <fromDataSet>true</fromDataSet>
          <dataSetEntity>
            <dataSetId>1471</dataSetId>
            <dataSetName>Clients</dataSetName>
            <dataSetGuid>4b3a8d39-09a2-4477-98c9-bd395e6f73d4</dataSetGuid>
          </dataSetEntity>
          <labelField>displayName</labelField>
          <valueField>id</valueField>
          <dependsOn />
          <relativeOptions />
          <sort>
            <columnId>displayName</columnId>
            <direction>Asc</direction>
          </sort>
        </RptInput>
        <RptInput>
          <id>ClientGroups</id>
          <displayName>Companies/Client Groups</displayName>
          <type>Integer</type>
          <controlType>ListBox</controlType>
          <required>false</required>
          <allowMultipleSelection>true</allowMultipleSelection>
          <hideAllSelection>true</hideAllSelection>
          <fromDataSet>true</fromDataSet>
          <dataSetEntity>
            <dataSetId>1473</dataSetId>
            <dataSetName>OneDrive Client Groups</dataSetName>
            <dataSetGuid>c2dbc9d8-9a36-4da8-9692-8b0d05c493da</dataSetGuid>
          </dataSetEntity>
          <labelField>groupName</labelField>
          <valueField>groupId</valueField>
          <dependsOn />
          <relativeOptions />
          <sort>
            <columnId>groupName</columnId>
            <direction>Asc</direction>
          </sort>
        </RptInput>
        <RptInput>
          <id>Timeframe</id>
          <displayName>Timeframe</displayName>
          <defaultValue>-P3D P0D</defaultValue>
          <possibleValueLabels>
            <string>Last 1 Days</string>
            <string>Last 2 Days</string>
            <string>Last 3 Days</string>
            <string>Last 7 Days</string>
            <string>Last 30 Days</string>
          </possibleValueLabels>
          <possibleValues>
            <string>-P1D P0D</string>
            <string>-P2D P0D</string>
            <string>-P3D P0D</string>
            <string>-P7D P0D</string>
            <string>-P30D P0D</string>
          </possibleValues>
          <type>DateRange</type>
          <controlType>DateRange</controlType>
          <required>false</required>
          <fromDataSet>false</fromDataSet>
          <dependsOn />
          <relativeOptions>
            <string>Last</string>
          </relativeOptions>
          <relativeUnits>
            <string>Days</string>
          </relativeUnits>
        </RptInput>
        <RptInput>
          <id>Options</id>
          <displayName>Options</displayName>
          <possibleValueLabels>
            <string>Show backup disabled clients</string>
            <string>Show all users</string>
          </possibleValueLabels>
          <possibleValues>
            <string>Show backup disabled clients</string>
            <string>Show all users</string>
          </possibleValues>
          <type>String</type>
          <controlType>ListBox</controlType>
          <required>false</required>
          <allowMultipleSelection>false</allowMultipleSelection>
          <fromDataSet>false</fromDataSet>
          <dependsOn />
          <relativeOptions />
        </RptInput>
        <RptInput>
          <id>NATimeRange</id>
          <displayName>Need Attention Time Range</displayName>
          <defaultValue>-P7D P0D</defaultValue>
          <possibleValueLabels>
            <string>Last 7 Days</string>
          </possibleValueLabels>
          <possibleValues>
            <string>-P7D P0D</string>
          </possibleValues>
          <type>DateRange</type>
          <controlType>DateRange</controlType>
          <required>false</required>
          <fromDataSet>false</fromDataSet>
          <hidden>true</hidden>
          <dependsOn />
          <relativeOptions>
            <string>Last</string>
          </relativeOptions>
          <relativeUnits>
            <string>Days</string>
          </relativeUnits>
        </RptInput>
      </inputs>
      <header />
      <body>{
    "reportComponents": [
        {
            "type": "HITS",
            "dataSet": {
                "dataSetId": 1223,
                "dataSetName": "OneDrive Client SLA",
                "dataSetGuid": "6ed2002f-2afd-4a4a-b468-901d12ffc14e",
                "originalDataSetName": "OneDrive Client SLA"
            },
            "title": {
                "text": ""
            },
            "id": "Hits1620293959316",
            "mobile": {
                "visible": "On",
                "listItemClick": {},
                "customListLayout": null
            },
            "hideComponent": false,
            "blankComponent": false,
            "filters": {
                "builder": {},
                "viewer": {}
            },
            "visible": {},
            "orientation": "vertical",
            "color": {
                "backgroundColor": "#ffffff"
            },
            "iconPosition": "left",
            "hideHeader": true,
            "measureDataField": [
                {
                    "column": "Associated Users",
                    "type": "Long",
                    "showNumberOps": true,
                    "aggrType": "Sum",
                    "captionPosition": "top",
                    "color": {
                        "captionColor": "#000",
                        "countColor": "#000"
                    },
                    "alignment": "center",
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    },
                    "displayText": "Associated Users"
                }
            ],
            "isGroupBy": true,
            "toolTip": "Total number of active users associated to the client(s)",
            "additionalProperties": false
        },
        {
            "type": "HITS",
            "dataSet": {
                "dataSetId": 1223,
                "dataSetName": "OneDrive Client SLA",
                "dataSetGuid": "6ed2002f-2afd-4a4a-b468-901d12ffc14e",
                "originalDataSetName": "OneDrive Client SLA"
            },
            "title": {
                "text": ""
            },
            "id": "Hits1620293966388",
            "mobile": {
                "visible": "On",
                "listItemClick": {},
                "customListLayout": null
            },
            "hideComponent": false,
            "blankComponent": false,
            "filters": {
                "builder": {},
                "viewer": {}
            },
            "color": {
                "backgroundColor": "#ffffff"
            },
            "iconPosition": "left",
            "hideHeader": true,
            "measureDataField": [
                {
                    "column": "Users Backed-up",
                    "type": "Long",
                    "showNumberOps": true,
                    "aggrType": "Sum",
                    "captionPosition": "top",
                    "color": {
                        "captionColor": "#000",
                        "countColor": "#000"
                    },
                    "alignment": "center",
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    },
                    "displayText": "Users Backed-up"
                }
            ],
            "isGroupBy": true,
            "toolTip": "Total number of users backed-up in the selected time period",
            "visible": {},
            "orientation": "vertical",
            "additionalProperties": false
        },
        {
            "type": "HITS",
            "dataSet": {
                "dataSetId": 1223,
                "dataSetName": "OneDrive Client SLA",
                "dataSetGuid": "6ed2002f-2afd-4a4a-b468-901d12ffc14e",
                "originalDataSetName": "OneDrive Client SLA"
            },
            "title": {
                "text": ""
            },
            "id": "Hits1620293969834",
            "mobile": {
                "visible": "On",
                "listItemClick": {},
                "customListLayout": null
            },
            "hideComponent": false,
            "blankComponent": false,
            "filters": {
                "builder": {},
                "viewer": {}
            },
            "color": {
                "backgroundColor": "#ffffff"
            },
            "iconPosition": "left",
            "hideHeader": true,
            "measureDataField": [
                {
                    "column": "Users Not Backed-up",
                    "type": "Long",
                    "showNumberOps": true,
                    "aggrType": "Sum",
                    "captionPosition": "top",
                    "color": {
                        "captionColor": "#000",
                        "countColor": "#000"
                    },
                    "alignment": "center",
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    },
                    "displayText": "Users Not Backed-up"
                }
            ],
            "isGroupBy": true,
            "toolTip": "Total number of users not  backed-up in the selected time period",
            "additionalProperties": false
        },
        {
            "type": "HITS",
            "dataSet": {
                "dataSetId": 1501,
                "dataSetName": "OneDrive Client SLA",
                "dataSetGuid": "6ed2002f-2afd-4a4a-b468-901d12ffc14e",
                "originalDataSetName": "OneDrive Client SLA"
            },
            "title": {
                "text": ""
            },
            "id": "Hits1623240083104",
            "mobile": {
                "visible": "On",
                "listItemClick": {},
                "customListLayout": null
            },
            "hideComponent": false,
            "blankComponent": false,
            "filters": {
                "builder": {},
                "viewer": {}
            },
            "visible": {},
            "orientation": "vertical",
            "color": {
                "backgroundColor": "#ffffff"
            },
            "iconPosition": "left",
            "hideHeader": true,
            "measureDataField": [
                {
                    "column": "Users Backed-up (at least once)",
                    "type": "Long",
                    "showNumberOps": true,
                    "aggrType": "Sum",
                    "captionPosition": "top",
                    "color": {
                        "captionColor": "#000",
                        "countColor": "#000"
                    },
                    "alignment": "center",
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    },
                    "displayText": "Users Backed-up (at least once)"
                }
            ],
            "isGroupBy": true,
            "toolTip": "Total number of users backed-up at least once",
            "additionalProperties": false
        },
        {
            "type": "HITS",
            "dataSet": {
                "dataSetId": 1223,
                "dataSetName": "OneDrive Client SLA",
                "dataSetGuid": "6ed2002f-2afd-4a4a-b468-901d12ffc14e",
                "originalDataSetName": "OneDrive Client SLA"
            },
            "title": {
                "text": ""
            },
            "id": "Hits1620293972979",
            "mobile": {
                "visible": "On",
                "listItemClick": {},
                "customListLayout": null
            },
            "hideComponent": false,
            "blankComponent": false,
            "filters": {
                "builder": {},
                "viewer": {}
            },
            "color": {
                "backgroundColor": "#ffffff"
            },
            "iconPosition": "left",
            "hideHeader": true,
            "measureDataField": [
                {
                    "column": "Users Never Backed-up",
                    "type": "Integer",
                    "showNumberOps": true,
                    "aggrType": "Sum",
                    "captionPosition": "top",
                    "color": {
                        "captionColor": "#000",
                        "countColor": "#000"
                    },
                    "alignment": "center",
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    },
                    "displayText": "Users Never Backed-up"
                }
            ],
            "isGroupBy": true,
            "toolTip": "Total number of users never backed-up",
            "additionalProperties": false
        },
        {
            "type": "HITS",
            "dataSet": {
                "dataSetId": 1501,
                "dataSetName": "OneDrive Client SLA",
                "dataSetGuid": "6ed2002f-2afd-4a4a-b468-901d12ffc14e",
                "originalDataSetName": "OneDrive Client SLA"
            },
            "title": {
                "text": ""
            },
            "id": "Hits1623240090935",
            "mobile": {
                "visible": "On",
                "listItemClick": {},
                "customListLayout": null
            },
            "hideComponent": false,
            "blankComponent": false,
            "filters": {
                "builder": {},
                "viewer": {}
            },
            "color": {
                "backgroundColor": "#ffffff"
            },
            "iconPosition": "left",
            "hideHeader": true,
            "measureDataField": [
                {
                    "column": "Users Recently Added",
                    "type": "Long",
                    "showNumberOps": true,
                    "aggrType": "Sum",
                    "captionPosition": "top",
                    "color": {
                        "captionColor": "#000",
                        "countColor": "#000"
                    },
                    "alignment": "center",
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    },
                    "displayText": "Users Recently Added"
                }
            ],
            "isGroupBy": true,
            "toolTip": "Users added in the last 7 days (This is a tentative value and might not be accurate)",
            "additionalProperties": false
        },
        {
            "type": "PANEL",
            "dataSet": {
                "dataSetName": "Client Discovery"
            },
            "title": {
                "text": ""
            },
            "id": "PanelComponent1653633401905",
            "hideHeader": true,
            "panelComponents": [
                {
                    "type": "HITS",
                    "dataSet": {
                        "dataSetName": "Client Discovery"
                    },
                    "title": {
                        "text": ""
                    },
                    "id": "Hits1653633407479",
                    "isSelected": false,
                    "mobile": {
                        "visible": "On",
                        "listItemClick": {},
                        "customListLayout": null
                    },
                    "layout": {
                        "Hits1653633407479": {
                            "desktop": {
                                "position": {
                                    "0": 0,
                                    "1": 0
                                },
                                "size": {
                                    "x": 4,
                                    "y": 2
                                }
                            }
                        }
                    },
                    "hideComponent": false,
                    "blankComponent": false,
                    "filters": {
                        "builder": {},
                        "viewer": {}
                    },
                    "visible": {},
                    "orientation": "vertical",
                    "color": {
                        "backgroundColor": "#ffffff"
                    },
                    "iconPosition": "left",
                    "hideHeader": true,
                    "measureDataField": [
                        {
                            "column": "Client",
                            "type": "String",
                            "aggrType": "Count",
                            "captionPosition": "top",
                            "color": {
                                "captionColor": "#000",
                                "countColor": "#000"
                            },
                            "alignment": "center",
                            "cellExpression": "",
                            "displayText": "Discovery Needs Attention"
                        }
                    ],
                    "isComponentLoading": false,
                    "isGroupBy": true,
                    "toolTip": "Clients with last discover time older than 7 days"
                },
                {
                    "type": "HITS",
                    "dataSet": {
                        "dataSetId": 1464,
                        "dataSetName": "OneDrive Client SLA",
                        "dataSetGuid": "6ed2002f-2afd-4a4a-b468-901d12ffc14e",
                        "originalDataSetName": "OneDrive Client SLA"
                    },
                    "title": {
                        "text": ""
                    },
                    "id": "Hits1653633551439",
                    "isSelected": false,
                    "mobile": {
                        "visible": "On",
                        "listItemClick": {},
                        "customListLayout": null
                    },
                    "layout": {
                        "Hits1653633551439": {
                            "desktop": {
                                "position": {
                                    "0": 0,
                                    "1": 4
                                },
                                "size": {
                                    "x": 4,
                                    "y": 2
                                }
                            }
                        }
                    },
                    "hideComponent": false,
                    "blankComponent": false,
                    "filters": {
                        "builder": {},
                        "viewer": {}
                    },
                    "color": {
                        "backgroundColor": "#ffffff"
                    },
                    "iconPosition": "left",
                    "hideHeader": true,
                    "measureDataField": [
                        {
                            "column": "Users Need Attention",
                            "type": "Integer",
                            "showNumberOps": true,
                            "aggrType": "Sum",
                            "captionPosition": "top",
                            "color": {
                                "captionColor": "#000",
                                "countColor": "#000"
                            },
                            "alignment": "center",
                            "cellExpression": "",
                            "displayText": "Users Needs Attention"
                        }
                    ],
                    "isComponentLoading": false,
                    "isGroupBy": true,
                    "visible": {},
                    "orientation": "vertical",
                    "toolTip": "Users associated to a client for at least more than 7 days and are never backed-up"
                },
                {
                    "type": "HITS",
                    "dataSet": {
                        "dataSetName": "Clients Index"
                    },
                    "title": {
                        "text": ""
                    },
                    "id": "Hits1653633565552",
                    "isSelected": false,
                    "mobile": {
                        "visible": "On",
                        "listItemClick": {},
                        "customListLayout": null
                    },
                    "layout": {
                        "Hits1653633565552": {
                            "desktop": {
                                "position": {
                                    "0": 0,
                                    "1": 8
                                },
                                "size": {
                                    "y": 2,
                                    "x": 4
                                }
                            }
                        }
                    },
                    "hideComponent": false,
                    "blankComponent": false,
                    "filters": {
                        "builder": {},
                        "viewer": {}
                    },
                    "visible": {},
                    "orientation": "vertical",
                    "color": {
                        "backgroundColor": "#ffffff"
                    },
                    "iconPosition": "left",
                    "hideHeader": true,
                    "measureDataField": [
                        {
                            "column": "Client",
                            "type": "String",
                            "aggrType": "Count",
                            "captionPosition": "top",
                            "color": {
                                "captionColor": "#000",
                                "countColor": "#000"
                            },
                            "alignment": "center",
                            "cellExpression": "",
                            "displayText": "Index Needs Attention"
                        }
                    ],
                    "isComponentLoading": false,
                    "isGroupBy": true,
                    "toolTip": "Clients with last playback time older than 7 days"
                }
            ],
            "mobile": {
                "visible": "On",
                "listItemClick": {},
                "customListLayout": null
            },
            "hideComponent": false,
            "blankComponent": false,
            "filters": {
                "builder": {},
                "viewer": {}
            },
            "visible": {
                "type": "custom",
                "expression": "=(cv.isAdminOnCommcellLevel || cv.isMspAdmin || cv.isMspUser)"
            },
            "layout": []
        },
        {
            "type": "TABLE",
            "dataSet": {
                "dataSetId": 1223,
                "dataSetName": "OneDrive Client SLA",
                "dataSetGuid": "6ed2002f-2afd-4a4a-b468-901d12ffc14e",
                "originalDataSetName": "OneDrive Client SLA"
            },
            "title": {
                "text": "OneDrive Clients"
            },
            "id": "Table1620182873441",
            "pageSize": "10",
            "columns": [
                {
                    "dataField": "sys_rowid",
                    "displayName": "sys_rowid",
                    "id": "sys_rowid",
                    "type": "Long",
                    "origType": "",
                    "visible": true,
                    "hidden": true,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Data Source",
                    "displayName": "CommCell",
                    "id": "DataSource",
                    "type": "String",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true
                },
                {
                    "dataField": "Client",
                    "displayName": "Client",
                    "id": "Client",
                    "type": "String",
                    "origType": "",
                    "visible": true,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": false,
                    "additionalProperties": false,
                    "cellExpression": ":=\nvar redirectURL = customReports.appName === \"webconsole\" ? ( location.origin + '/adminconsole/' + row['clienturl'] ) : row['clienturl']\nreturn '&lt;a href=\"'+redirectURL+'\"&gt;'+cellData+'&lt;/a&gt;'"
                },
                {
                    "dataField": "Client Status",
                    "displayName": "Client Status",
                    "id": "ClientStatus",
                    "type": "String",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Index Status",
                    "displayName": "Index Status",
                    "id": "IndexStatus",
                    "type": "String",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Last Indexed Backup JobId",
                    "displayName": "Last indexed backup jobid",
                    "id": "Lastindexedbackupjobid",
                    "type": "String",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": ":=\nvar redirectURL = customReports.appName === \"webconsole\" ? ( location.origin + '/adminconsole/' + row['joburl'] ) : row['joburl']\nreturn '&lt;a href=\"'+redirectURL+'\"&gt;'+cellData+'&lt;/a&gt;'"
                },
                {
                    "dataField": "Last Index Time",
                    "displayName": "Last index time",
                    "id": "Lastindextime",
                    "type": "TimeStamp",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Last Index Error Time",
                    "displayName": "Last index error time",
                    "id": "Lastindexerrortime",
                    "type": "TimeStamp",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Last Discovery Time",
                    "displayName": "Last discovery time",
                    "id": "Lastdiscoverytime",
                    "type": "TimeStamp",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Last Backup Run Time",
                    "displayName": "Last Backup Run Time",
                    "id": "LastBackupRunTime",
                    "type": "TimeStamp",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Last Backup Job ID",
                    "displayName": "Last Backup Job ID",
                    "id": "LastBackupJobID",
                    "type": "String",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": ":=\nvar redirectURL = customReports.appName === \"webconsole\" ? ( location.origin + '/adminconsole/' + row['backupjoburl'] ) : row['backupjoburl']\nreturn '&lt;a href=\"'+redirectURL+'\"&gt;'+cellData+'&lt;/a&gt;'"
                },
                {
                    "dataField": "Associated Users",
                    "displayName": "Associated Users",
                    "id": "AssociatedUsers",
                    "type": "Long",
                    "origType": "",
                    "visible": true,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    }
                },
                {
                    "dataField": "Users Backed-up",
                    "displayName": "Users Backed-up",
                    "id": "UsersBackedup",
                    "type": "Long",
                    "origType": "",
                    "visible": true,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    }
                },
                {
                    "dataField": "Users Not Backed-up",
                    "displayName": "Users Not Backed-up",
                    "id": "UsersNotBackedup",
                    "type": "Long",
                    "origType": "",
                    "visible": true,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    }
                },
                {
                    "dataField": "Users Never Backed-up",
                    "displayName": "Users Never Backed-up",
                    "id": "UsersNeverBackedup",
                    "type": "Integer",
                    "origType": "",
                    "visible": true,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    }
                },
                {
                    "dataField": "Users Backed-up (at least once)",
                    "displayName": "Users Backed-up (at least once)",
                    "id": "UsersBackedupatleastonce",
                    "type": "Long",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Users Recently Added",
                    "displayName": "Users Recently Added",
                    "id": "UsersRecentlyAdded",
                    "type": "Long",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Users Need Attention",
                    "displayName": "Users Need Attention",
                    "id": "UsersNeedAttention",
                    "type": "Integer",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Application Size",
                    "displayName": "Application Size",
                    "id": "ApplicationSize",
                    "type": "Long",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": {
                        "type": "size",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    }
                },
                {
                    "dataField": "Number of Items",
                    "displayName": "Number of Items",
                    "id": "NumberofItems",
                    "type": "Long",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    }
                },
                {
                    "dataField": "Indexed Items",
                    "displayName": "Indexed Items",
                    "id": "IndexedItems",
                    "type": "Long",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    }
                },
                {
                    "dataField": "Azure Apps Associated",
                    "displayName": "Azure Apps Associated",
                    "id": "AzureAppsAssociated",
                    "type": "Integer",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Azure Apps Not Authorized",
                    "displayName": "Azure Apps Not Authorized",
                    "id": "AzureAppsNotAuthorized",
                    "type": "Integer",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Azure Apps To Be Added",
                    "displayName": "Azure Apps To Be Added",
                    "id": "AzureAppsToBeAdded",
                    "type": "Integer",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Last Verify Connection Time",
                    "displayName": "Last Verify Connection Time",
                    "id": "LastVerifyConnectionTime",
                    "type": "TimeStamp",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Max Streams",
                    "displayName": "Max Streams",
                    "id": "MaxStreams",
                    "type": "Integer",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Access Node Group",
                    "displayName": "Access Node Group",
                    "id": "AccessNodeGroup",
                    "type": "String",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": ":=\nif ((cv.isAdminOnCommcellLevel || cv.isMspAdmin || cv.isMspUser) &amp;&amp; cellData !== \"\")\n{\n\tvar redirectURL = customReports.appName === \"webconsole\" ? ( location.origin + '/adminconsole/' + row['accessNodeGroupUrl'] ) : row['accessNodeGroupUrl']\n\treturn '&lt;a href=\"'+redirectURL+'\"&gt;'+cellData+'&lt;/a&gt;'\n}\nelse\n{\n    return \"N/A\"\n}"
                },
                {
                    "dataField": "Index Server",
                    "displayName": "Index Server",
                    "id": "IndexServer",
                    "type": "String",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": ":=\nif ((cv.isAdminOnCommcellLevel || cv.isMspAdmin || cv.isMspUser) &amp;&amp; cellData !== \"\")\n{\n\tvar redirectURL = customReports.appName === \"webconsole\" ? ( location.origin + '/adminconsole/' + row['indexserverurl'] ) : row['indexserverurl']\n\treturn '&lt;a href=\"'+redirectURL+'\"&gt;'+cellData+'&lt;/a&gt;'\n}\nelse\n{\n    return \"N/A\"\n}"
                },
                {
                    "dataField": "Active Jobs",
                    "displayName": "Active Jobs",
                    "id": "ActiveJobs",
                    "type": "String",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": ":=\nvar redirectURL = customReports.appName === \"webconsole\" ? ( location.origin + '/adminconsole/' + row['activejobsurl'] ) : row['activejobsurl']\nreturn '&lt;a href=\"'+redirectURL+'\"&gt;'+cellData+'&lt;/a&gt;'"
                },
                {
                    "dataField": "joburl",
                    "displayName": "joburl",
                    "id": "joburl",
                    "type": "String",
                    "origType": "",
                    "visible": true,
                    "hidden": true,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": false
                },
                {
                    "dataField": "backupjoburl",
                    "displayName": "backupjoburl",
                    "id": "backupjoburl",
                    "type": "String",
                    "origType": "",
                    "visible": true,
                    "hidden": true,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": false
                },
                {
                    "dataField": "clienturl",
                    "displayName": "clienturl",
                    "id": "clienturl",
                    "type": "String",
                    "origType": "",
                    "visible": true,
                    "hidden": true,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": false
                },
                {
                    "dataField": "activejobsurl",
                    "displayName": "activejobsurl",
                    "id": "activejobsurl",
                    "type": "String",
                    "origType": "",
                    "visible": true,
                    "hidden": true,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true
                },
                {
                    "dataField": "accessNodeGroupUrl",
                    "displayName": "accessNodeGroupUrl",
                    "id": "accessNodeGroupUrl",
                    "type": "String",
                    "origType": "",
                    "visible": true,
                    "hidden": true,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": false
                },
                {
                    "dataField": "indexserverurl",
                    "displayName": "indexserverurl",
                    "id": "indexserverurl",
                    "type": "String",
                    "origType": "",
                    "visible": true,
                    "hidden": true,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": false
                }
            ],
            "allColumns": true,
            "dataSetName": "",
            "styles": {
                "chartPlotOptions": {
                    "isShowGridlines": true,
                    "isSmoothLines": true,
                    "isShowLineMarkers": true,
                    "autoConvertYValues": true,
                    "isShowLabels": false,
                    "legendPosition": "right"
                }
            },
            "mobile": {
                "visible": "On",
                "listItemClick": {},
                "customListLayout": null
            },
            "hideComponent": false,
            "blankComponent": false,
            "filters": {
                "builder": {},
                "viewer": {}
            },
            "showFilterByDefault": false,
            "visible": {},
            "orientation": "vertical",
            "enableHorizontalScroll": false
        },
        {
            "type": "TABLE",
            "dataSet": {
                "dataSetName": "OneDrive Mailbox details",
                "dataSetGuid": "0e7d384a-b165-4821-de45-810bedeab80b",
                "originalDataSetName": "OneDrive Mailbox details"
            },
            "title": {
                "text": ":= return (rpt.input.Options === 'Show all users' ? 'Users' : 'Users Not Backed-up')"
            },
            "id": "Table1596173979603",
            "pageSize": 20,
            "columns": [
                {
                    "dataField": "sys_rowid",
                    "displayName": "sys_rowid",
                    "id": "sys_rowid",
                    "type": "Long",
                    "origType": "",
                    "visible": true,
                    "hidden": true,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Data Source",
                    "displayName": "CommCell",
                    "id": "DataSource",
                    "type": "String",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true
                },
                {
                    "dataField": "Name",
                    "displayName": "Name",
                    "id": "Name",
                    "type": "Integer",
                    "origType": "",
                    "visible": true,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Email Address",
                    "displayName": "Email Address",
                    "id": "EmailAddress",
                    "type": "Integer",
                    "origType": "",
                    "visible": true,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Last Backup",
                    "displayName": "Last backup",
                    "id": "Lastbackup",
                    "type": "Integer",
                    "origType": "",
                    "visible": true,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Last Backup Status",
                    "displayName": "Last Backup Status",
                    "id": "LastBackupStatus",
                    "type": "Integer",
                    "origType": "",
                    "visible": true,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Failure Reason",
                    "displayName": "Failure Reason",
                    "id": "FailureReason",
                    "type": "Integer",
                    "origType": "",
                    "visible": true,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Last Backup Attempt",
                    "displayName": "Last backup attempt",
                    "id": "Lastbackupattempt",
                    "type": "Integer",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Last Backup Attempt JobId",
                    "displayName": "Last Backup Attempt JobId",
                    "id": "LastBackupAttemptJobId",
                    "type": "Integer",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Client",
                    "displayName": "Client",
                    "id": "Client",
                    "type": "Integer",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Added to content on",
                    "displayName": "Added to content on",
                    "id": "Addedtocontenton",
                    "type": "Integer",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Backup Size",
                    "displayName": "Backup Size",
                    "id": "BackupSize",
                    "type": "Integer",
                    "origType": "",
                    "visible": true,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": {
                        "type": "size",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    }
                },
                {
                    "dataField": "Number Of Items",
                    "displayName": "Number Of Items",
                    "id": "NumberOfItems",
                    "type": "Integer",
                    "origType": "",
                    "visible": true,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    }
                },
                {
                    "dataField": "Failed Items",
                    "displayName": "Failed Items",
                    "id": "FailedItems",
                    "type": "Integer",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    }
                }
            ],
            "allColumns": true,
            "dataSetName": "",
            "styles": {
                "chartPlotOptions": {
                    "isShowGridlines": true,
                    "isSmoothLines": true,
                    "isShowLineMarkers": true,
                    "autoConvertYValues": true,
                    "isShowLabels": false,
                    "legendPosition": "right"
                }
            },
            "mobile": {
                "visible": "On",
                "listItemClick": {},
                "customListLayout": null
            },
            "filters": {
                "builder": {},
                "viewer": {}
            },
            "showFilterByDefault": false,
            "enableHorizontalScroll": false,
            "visible": {
                "type": "custom",
                "expression": "=!((rpt.input.OneDriveClients == \"\" || rpt.input.OneDriveClients == \"[]\") &amp;&amp; (rpt.input.ClientGroups == \"\" || rpt.input.ClientGroups == \"[]\"))"
            },
            "orientation": "vertical",
            "hideComponent": false,
            "blankComponent": false
        }
    ],
    "filters": {
        "builder": {},
        "viewer": {}
    },
    "autoRefreshTime": 10,
    "reportLayout": {
        "gridsterOpts": {
            "columns": 12
        },
        "Table1596173979603": {
            "mobile": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    8,
                    0
                ]
            },
            "tablet": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    8,
                    0
                ]
            },
            "desktop": {
                "size": {
                    "x": 12,
                    "y": 3
                },
                "position": [
                    13,
                    0
                ]
            }
        },
        "Table1620182873441": {
            "mobile": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    8,
                    0
                ]
            },
            "tablet": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    8,
                    0
                ]
            },
            "desktop": {
                "size": {
                    "x": 12,
                    "y": 6
                },
                "position": [
                    7,
                    0
                ]
            }
        },
        "Hits1620293959316": {
            "mobile": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    0,
                    0
                ]
            },
            "tablet": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    0,
                    0
                ]
            },
            "desktop": {
                "size": {
                    "x": 4,
                    "y": 2
                },
                "position": [
                    0,
                    0
                ]
            }
        },
        "Hits1620293966388": {
            "mobile": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    0,
                    3
                ]
            },
            "tablet": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    0,
                    3
                ]
            },
            "desktop": {
                "size": {
                    "x": 4,
                    "y": 2
                },
                "position": [
                    0,
                    4
                ]
            }
        },
        "Hits1620293969834": {
            "mobile": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    0,
                    6
                ]
            },
            "tablet": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    0,
                    6
                ]
            },
            "desktop": {
                "size": {
                    "x": 4,
                    "y": 2
                },
                "position": [
                    0,
                    8
                ]
            }
        },
        "Hits1620293972979": {
            "mobile": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    0,
                    9
                ]
            },
            "tablet": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    0,
                    9
                ]
            },
            "desktop": {
                "size": {
                    "x": 4,
                    "y": 2
                },
                "position": [
                    2,
                    4
                ]
            }
        },
        "Hits1623240083104": {
            "mobile": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    2,
                    0
                ]
            },
            "tablet": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    2,
                    0
                ]
            },
            "desktop": {
                "size": {
                    "x": 4,
                    "y": 2
                },
                "position": [
                    2,
                    0
                ]
            }
        },
        "Hits1623240090935": {
            "mobile": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    2,
                    8
                ]
            },
            "tablet": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    2,
                    8
                ]
            },
            "desktop": {
                "size": {
                    "x": 4,
                    "y": 2
                },
                "position": [
                    2,
                    8
                ]
            }
        },
        "PanelComponent1653633401905": {
            "mobile": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    4,
                    0
                ]
            },
            "tablet": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    4,
                    0
                ]
            },
            "desktop": {
                "size": {
                    "x": 12,
                    "y": 3
                },
                "position": [
                    4,
                    0
                ]
            }
        }
    }
}</body>
      <footer />
    </Page>
    <Page>
      <pageName>SharePoint</pageName>
      <isDefault>false</isDefault>
      <pageTitle>
        <text>SharePoint</text>
      </pageTitle>
      <dataSets>
        <dataSet>
          <DataSet>
            <dataSet>
              <dataSetName>SharePoint Clients</dataSetName>
              <dataSetGuid>5107c7ef-4a8a-40e9-d485-e482be0cf9f0</dataSetGuid>
            </dataSet>
            <endpoint>DATABASE</endpoint>
            <shared>false</shared>
            <dataSources>
              <DataSource>
                <connectionType>COMMCELL</connectionType>
                <endpoint>DATABASE</endpoint>
                <commCell>
                  <commCellName>$ALL$</commCellName>
                </commCell>
              </DataSource>
            </dataSources>
            <allColumns>false</allColumns>
            <fields>
              <Column>
                <name>sys_rowid</name>
                <dataField>$row_number$</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Data Source</name>
                <dataField>Data Source</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>id</name>
                <dataField>id</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>displayName</name>
                <dataField>displayName</dataField>
                <type>String</type>
              </Column>
            </fields>
            <GetOperation>
              <parameters />
              <sqlText>DECLARE @CV_APPTYPE_SHAREPOINT INT = 78



-- variables

DECLARE @userId INT

DECLARE @companyId INT

DECLARE @clientIds TABLE (clientId INT)

DECLARE @listAgentIds TABLE (agentId INT)

DECLARE @listCloudAppInstanceIds TABLE (instanceId INT)



-- read inputs

SELECT @userId = id FROM UMUsers WHERE login = @sys_username

SET @companyId = dbo.AppGetOrganizationForUser(@userId)



IF @companyId &gt; 0

			BEGIN

				DECLARE @OrgClients table (clientId INT,  tenantId INT , tenant nvarchar(40))            

				

				INSERT INTO @OrgClients 

				SELECT A.clientId, D.id , D.domainName

				from APP_ClientGroupAssoc A WITH (NOLOCK)

				JOIN APP_ClientGroup B WITH (NOLOCK) ON A.clientGroupId = B.id 

				JOIN App_CompanyProp C WITH (NOLOCK) ON C.attrName = 'Associated Smart Client Group' AND CAST(A.clientGroupId AS nvarchar(MAX)) = C.attrVal AND C.modIFied = 0

				JOIN UMDSProviders D WITH (NOLOCK) ON C.componentNameId = D.id

				WHERE (C.componentNameId = @companyId) AND  B.flag&amp;0x1000 &gt; 0



				INSERT INTO @clientIds (clientId) SELECT clientId FROM @OrgClients

			END

		ELSE

			BEGIN

				IF OBJECT_ID('tempdb.dbo.#temp_clientIds') IS NOT NULL

					DROP TABLE #temp_clientIds



				CREATE TABLE #temp_clientIds

				(

					clientId            INT,

					appTypeId           INT,

					instanceId          INT,

					backupsetId         INT,

					subclientId         INT

				)



				EXEC sec_getIdaObjectsForUser @userId, 3/*Client Entity*/, 0, 0, '#temp_clientIds', 1



				INSERT INTO @clientIds (clientId) SELECT clientId FROM #temp_clientIds

			END



DELETE FROM @clientIds WHERE clientId NOT IN 

(SELECT DISTINCT clientId FROM APP_Application WITH (NOLOCK) 

WHERE appTypeId = @CV_APPTYPE_SHAREPOINT

AND subclientStatus &amp; 0x04 != 0x04 /*DELETED*/ AND subclientStatus &amp; 0x00020 != 0x00020 /*HIDDEN*/)



DELETE FROM @clientIds

WHERE clientId NOT IN 

(SELECT componentNameId FROM App_ClientProp WITH (NOLOCK) WHERE attrName = 'Office 365 Pseudo Client' AND attrVal = 1 /*V2 client*/ AND modified = 0

AND componentNameId IN (SELECT clientId FROM @clientIds))



SELECT id, displayName FROM APP_Client WITH (NOLOCK) WHERE id IN (select clientId FROM @clientIds) AND specialClientFlags &amp; 0x02 &lt;&gt; 0 /*Pseudo client*/



IF OBJECT_ID('tempdb.dbo.#temp_clientIds') IS NOT NULL

	DROP TABLE #temp_clientIds</sqlText>
              <timeout>5</timeout>
              <postQueryFilter>true</postQueryFilter>
              <rDataSetQuery />
              <rPlotQuery />
            </GetOperation>
            <description>Backup Health Report for Office 365 Clients.</description>
            <databaseName>CommServ</databaseName>
            <queryPlan>
              <offline>false</offline>
              <collectionType>HTTP</collectionType>
              <retentionDays>1</retentionDays>
              <versions>
                <CommCellVersion>ALL</CommCellVersion>
              </versions>
              <dynamicCollection>false</dynamicCollection>
              <frequency>60</frequency>
              <direct>false</direct>
            </queryPlan>
            <version>144</version>
            <guid>5107c7ef-4a8a-40e9-d485-e482be0cf9f0</guid>
            <hidden>true</hidden>
            <revision />
            <computedColumns>
              <scriptName>R</scriptName>
              <script />
              <columnList />
            </computedColumns>
          </DataSet>
          <DataSet>
            <dataSet>
              <dataSetName>SharePoint Groups</dataSetName>
              <dataSetGuid>8f3a9008-6fd2-4fd2-e38d-9f10e178e36e</dataSetGuid>
            </dataSet>
            <endpoint>DATABASE</endpoint>
            <shared>false</shared>
            <dataSources>
              <DataSource>
                <connectionType>COMMCELL</connectionType>
                <endpoint>DATABASE</endpoint>
                <commCell>
                  <commCellName>$ALL$</commCellName>
                </commCell>
              </DataSource>
            </dataSources>
            <allColumns>false</allColumns>
            <fields>
              <Column>
                <name>sys_rowid</name>
                <dataField>$row_number$</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Data Source</name>
                <dataField>Data Source</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>groupId</name>
                <dataField>groupId</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>groupName</name>
                <dataField>groupName</dataField>
                <type>String</type>
              </Column>
            </fields>
            <GetOperation>
              <parameters />
              <sqlText>SET NOCOUNT ON
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED

DECLARE	@UserId		INT 
DECLARE @CV_APPTYPE_EXCHANGE_ONEPASS INT = 137
SELECT	@UserId = id FROM UMUsers WHERE login = @sys_username

DECLARE @CV_FLAG_COMMCELL_GROUP VARBINARY(8) = 0x40000
DECLARE	@ObjectType	INT = 2572		-- SERVER_GROUP_NAME_ITEM

IF OBJECT_ID('tempdb.dbo.#UserObjects') IS NOT NULL
	DROP TABLE #UserObjects

create table  #UserObjects ( 
	[capabilities]  bigint	NOT null, 
	[flag]			int NOT null default 0, 
	[commCellId]    int	NOT null default 2, 
	[clientGroupId] int	NOT null default 0, 
	[clientId]      int	NOT null default 0, 
	[appTypeId]     int	NOT null default 0, 
	[instanceId]    int	NOT null default 0, 
	[backupsetId]   int	NOT null default 0, 
	[subClientId]   int	NOT null default 0, 
	[mediaAgentId]  int	NOT null default 0, 
	[libraryId]     int	NOT null default 0, 
	[archGroupId]   int	NOT null default 0, 
	[vtContainerId] int	NOT null default 0, 
	[vtPolicyId]    int	NOT null default 0, 
	[vtShelfId]     int	NOT null default 0, 
	[reviewSetId]   int	NOT null default 0, 
	[querySetId]	int	NOT null default 0, 
	[downloadSetId] int	NOT null default 0, 
	[ermId]   		int	NOT null default 0, 
	[legalHoldId]   int	NOT null default 0, 
	[tagId]			int	NOT null default 0, 
	[cdPolicyId]    int	NOT null default 0, 
	[complianceReportId]   int	NOT null default 0, 
	[taskId]        int	NOT null default 0, 
	[workflowId]    int	NOT null default 0, 
	[logMonitoringPolicyId] int	NOT null default 0, 
	[arrayId]       int	NOT null default 0, 
	[cloudId]       int	NOT null default 0, 
	[userGroupId]   int	NOT null default 0, 
	[providerId]    int	NOT null default 0, 
	[entityId1]     int	NOT null default 0, 
	[entityId2]     int	NOT null default 0, 
	[entityId3]     int	NOT null default 0, 
	[entityId4]     int	NOT null default 0, 
	[entityId5]     int	NOT null default 0, 
	[entityId6]     int	NOT null default 0, 
	[entityId7]     int	NOT null default 0, 
	[entityId8]     int	NOT null default 0, 
	[entityId9]     int	NOT null default 0  )

EXEC sec_getUserObjects @UserId, @ObjectType, 0, '#UserObjects'

DECLARE @clientGroups TABLE (groupId INT, groupName NVARCHAR(255))

IF EXISTS (SELECT * FROM #UserObjects WHERE commCellId = 2 AND clientGroupId = 0)
	INSERT INTO @clientGroups (groupId, groupName)
	SELECT	CG.id, CG.name
	FROM	APP_ClientGroup CG WITH (NOLOCK)
        WHERE CG.Flag &amp; @CV_FLAG_COMMCELL_GROUP = 0
ELSE
	INSERT INTO @clientGroups (groupId, groupName)
	SELECT	CG.id, CG.name
	FROM	#UserObjects O
			INNER JOIN APP_ClientGroup CG WITH (NOLOCK) ON O.clientGroupId = CG.id 
        AND CG.Flag &amp; @CV_FLAG_COMMCELL_GROUP = 0
	WHERE	O.commCellId = 2 AND O.clientGroupId &gt; 0

SELECT groupId, groupName FROM @clientGroups WHERE groupId IN (SELECT DISTINCT clientGroupId FROM App_ClientGroupAssoc WITH (NOLOCK) WHERE clientId in (
SELECT id FROM App_Client WITH (NOLOCK) WHERE id IN (SELECT DISTINCT clientId FROM APP_Application WITH (NOLOCK)
WHERE subclientStatus &amp; 0x04 != 0x04 /*DELETED*/ AND subclientStatus &amp; 0x00020 != 0x00020 /*HIDDEN*/)
AND specialClientFlags &amp; 0x02 &lt;&gt; 0 /*Pseudo client*/))

IF OBJECT_ID('tempdb.dbo.#UserObjects') IS NOT NULL
	DROP TABLE #UserObjects</sqlText>
              <timeout>5</timeout>
              <postQueryFilter>true</postQueryFilter>
              <rDataSetQuery />
              <rPlotQuery />
            </GetOperation>
            <description>Backup Health Report for Office 365 Clients.</description>
            <databaseName>CommServ</databaseName>
            <queryPlan>
              <offline>false</offline>
              <collectionType>HTTP</collectionType>
              <retentionDays>1</retentionDays>
              <versions>
                <CommCellVersion>ALL</CommCellVersion>
              </versions>
              <dynamicCollection>false</dynamicCollection>
              <frequency>60</frequency>
              <direct>false</direct>
            </queryPlan>
            <version>144</version>
            <guid>8f3a9008-6fd2-4fd2-e38d-9f10e178e36e</guid>
            <hidden>true</hidden>
            <revision />
            <computedColumns>
              <scriptName>R</scriptName>
              <script />
              <columnList />
            </computedColumns>
          </DataSet>
          <DataSet>
            <dataSet>
              <dataSetName>SharePoint Clients SLA</dataSetName>
              <dataSetGuid>f7a2f018-783b-4700-af3f-5430e1be97e1</dataSetGuid>
            </dataSet>
            <endpoint>DATABASE</endpoint>
            <shared>false</shared>
            <dataSources>
              <DataSource>
                <connectionType>COMMCELL</connectionType>
                <endpoint>DATABASE</endpoint>
                <commCell>
                  <commCellName>$ALL$</commCellName>
                </commCell>
              </DataSource>
            </dataSources>
            <allColumns>false</allColumns>
            <fields>
              <Column>
                <name>sys_rowid</name>
                <dataField>$row_number$</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Data Source</name>
                <dataField>Data Source</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Client</name>
                <dataField>Client</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Client Status</name>
                <dataField>Client Status</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Index Status</name>
                <dataField>Index Status</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Last Indexed Backup JobId</name>
                <dataField>Last Indexed Backup JobId</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Last Index Time</name>
                <dataField>Last Index Time</dataField>
                <type>TimeStamp</type>
              </Column>
              <Column>
                <name>Last Index Error Time</name>
                <dataField>Last Index Error Time</dataField>
                <type>TimeStamp</type>
              </Column>
              <Column>
                <name>Last Discovery Time</name>
                <dataField>Last Discovery Time</dataField>
                <type>TimeStamp</type>
              </Column>
              <Column>
                <name>Last Backup Run Time</name>
                <dataField>Last Backup Run Time</dataField>
                <type>TimeStamp</type>
              </Column>
              <Column>
                <name>Last Backup Job ID</name>
                <dataField>Last Backup Job ID</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Associated Sites</name>
                <dataField>Associated Sites</dataField>
                <type>Long</type>
              </Column>
              <Column>
                <name>Sites Backed-up</name>
                <dataField>Sites Backed-up</dataField>
                <type>Long</type>
              </Column>
              <Column>
                <name>Sites Not Backed-up</name>
                <dataField>Sites Not Backed-up</dataField>
                <type>Long</type>
              </Column>
              <Column>
                <name>Sites Never Backed-up</name>
                <dataField>Sites Never Backed-up</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Sites Backed-up (at least once)</name>
                <dataField>Sites Backed-up (at least once)</dataField>
                <type>Long</type>
              </Column>
              <Column>
                <name>Sites Recently Added</name>
                <dataField>Sites Recently Added</dataField>
                <type>Long</type>
              </Column>
              <Column>
                <name>Sites Need Attention</name>
                <dataField>Sites Need Attention</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Application Size</name>
                <dataField>Application Size</dataField>
                <type>Long</type>
              </Column>
              <Column>
                <name>Number of Items</name>
                <dataField>Number of Items</dataField>
                <type>Long</type>
              </Column>
              <Column>
                <name>Indexed Items</name>
                <dataField>Indexed Items</dataField>
                <type>Long</type>
              </Column>
              <Column>
                <name>Azure Apps Associated</name>
                <dataField>Azure Apps Associated</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Azure Apps Not Authorized</name>
                <dataField>Azure Apps Not Authorized</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Azure Apps To Be Added</name>
                <dataField>Azure Apps To Be Added</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Last Verify Connection Time</name>
                <dataField>Last Verify Connection Time</dataField>
                <type>TimeStamp</type>
              </Column>
              <Column>
                <name>Max Streams</name>
                <dataField>Max Streams</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Access Node Group</name>
                <dataField>Access Node Group</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Index Server</name>
                <dataField>Index Server</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Active Jobs</name>
                <dataField>Active Jobs</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>joburl</name>
                <dataField>joburl</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>backupjoburl</name>
                <dataField>backupjoburl</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>clienturl</name>
                <dataField>clienturl</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>activejobsurl</name>
                <dataField>activejobsurl</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>accessNodeGroupUrl</name>
                <dataField>accessNodeGroupUrl</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>indexserverurl</name>
                <dataField>indexserverurl</dataField>
                <type>String</type>
              </Column>
            </fields>
            <GetOperation>
              <parameters>
                <Parameter>
                  <name>Clients</name>
                  <dataType>Integer</dataType>
                  <isList>true</isList>
                  <values>
                    <string>=input.SharePointClients</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>ClientGroups</name>
                  <dataType>Integer</dataType>
                  <isList>true</isList>
                  <values>
                    <string>=input.ClientGroups</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>timeframe</name>
                  <dataType>DateRange</dataType>
                  <values>
                    <string>=input.Timeframe</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>Options</name>
                  <dataType>String</dataType>
                  <isList>true</isList>
                  <values>
                    <string>=input.Options</string>
                  </values>
                </Parameter>
              </parameters>
              <sqlText>-- constants

DECLARE @CV_APPTYPE_SHAREPOINT INT = 78

DECLARE @MAX_USERS_FOR_FIVE_CONNECTIONS INT = 10000

DECLARE @TENANT_DIACTIVEVATED INT = 101

DECLARE @LICENSE_RELEASED INT = 102

DECLARE @EXCLUDED_FROM_SLA INT = 103



-- variables

DECLARE @userId INT = (SELECT TOP 1 id FROM UMUsers WITH (NOLOCK) WHERE login = @sys_username)

DECLARE @companyId INT

DECLARE @includeBackupDisabledClients INT = 0



DECLARE @recentlyAddedNumberOfDays INT = 7

DECLARE @recentlyAddedRefTime INT = dbo.getunixtime(DATEADD(HOUR, -@recentlyAddedNumberOfDays*24 , GETUTCDATE()))



IF OBJECT_ID('tempdb.dbo.#listClientIds_SharePoint') IS NOT NULL

	DROP TABLE #listClientIds_SharePoint



CREATE TABLE #listClientIds_SharePoint (clientId INT, subclientId INT, backupsetId INT, instanceId INT, isBackupDisabled INT DEFAULT 0)

CREATE NONCLUSTERED INDEX #listClientIds_SharePoint_c_s_b_i_ids ON #listClientIds_SharePoint(clientId, subclientId, backupsetId, instanceId)



-- read inputs

SET @companyId = dbo.AppGetOrganizationForUser(@userId)



IF OBJECT_ID('tempdb.dbo.#temp__clientIds') IS NOT NULL

	DROP TABLE #temp__clientIds



CREATE TABLE #temp__clientIds

(

	clientId            INT,

	appTypeId           INT,

	instanceId          INT,

	backupsetId         INT,

	subclientId         INT

)



IF NOT EXISTS (SELECT Clients FROM @Clients) AND NOT EXISTS (SELECT ClientGroups FROM @ClientGroups)

BEGIN 

	IF @companyId &gt; 0

	BEGIN

		INSERT INTO #temp__clientIds (clientId)

		SELECT DISTINCT CGA.clientId

		FROM UMDSProviders UMDS WITH (NOLOCK)

		JOIN App_CompanyProp CP WITH (NOLOCK) ON CP.attrName = 'Associated Smart Client Group' AND CP.modified = 0

		JOIN APP_ClientGroupAssoc CGA WITH (NOLOCK) ON CAST(CGA.clientGroupId AS NVARCHAR(16)) = CP.attrVal

		JOIN APP_ClientGroup CG WITH (NOLOCK) ON CGA.clientGroupId = CG.id

		WHERE CP.componentNameId = @companyId AND CG.flag &amp; 0x1000 &gt; 0



		-- include clients belongs to logged in users company

		INSERT INTO #listClientIds_SharePoint (clientId)

		SELECT DISTINCT TC.clientId

		FROM #temp__clientIds TC

		INNER JOIN APP_Application AA WITH (NOLOCK) ON TC.clientId = AA.clientId

		WHERE AA.appTypeId = @CV_APPTYPE_SHAREPOINT AND subclientStatus &amp; 0x04 != 0x04 /*DELETED*/ AND subclientStatus &amp; 0x00020 != 0x00020 /*HIDDEN*/

	END

	ELSE

	BEGIN

		EXEC sec_getIdaObjectsForUser @userId, 3 /*Client Entity*/, 0, 0, '#temp__clientIds', 1



		-- include all clients user has access to

		INSERT INTO #listClientIds_SharePoint (clientId)

		SELECT DISTINCT TC.clientId

		FROM #temp__clientIds TC

		INNER JOIN APP_Application AA WITH (NOLOCK) ON TC.clientId = AA.clientId

		WHERE AA.appTypeId = @CV_APPTYPE_SHAREPOINT AND subclientStatus &amp; 0x04 != 0x04 /*DELETED*/ AND subclientStatus &amp; 0x00020 != 0x00020 /*HIDDEN*/

	END

END

ELSE

BEGIN

	INSERT INTO #listClientIds_SharePoint (clientId)

	SELECT DISTINCT Clients FROM @Clients

	UNION

	SELECT DISTINCT CG.clientId FROM App_ClientGroupAssoc CG WITH (NOLOCK)

	INNER JOIN APP_Application AA WITH (NOLOCK) ON CG.clientId = AA.clientId AND AA.appTypeId = @CV_APPTYPE_SHAREPOINT

	WHERE clientGroupId IN (SELECT ClientGroups FROM @ClientGroups)

	AND subclientStatus &amp; 0x04 != 0x04 /*DELETED*/ AND subclientStatus &amp; 0x00020 != 0x00020 /*HIDDEN*/



	EXEC dbo.sec_getIdaObjectsForUser @userId, 3 /*Client Entity*/, 0, 0, '#temp__clientIds', 1



	DELETE FROM #listClientIds_SharePoint

	WHERE clientId NOT IN (SELECT clientId FROM #temp__clientIds)

END



IF OBJECT_ID('tempdb.dbo.#temp__clientIds') IS NOT NULL

	DROP TABLE #temp__clientIds



DELETE #listClientIds_SharePoint

FROM #listClientIds_SharePoint C INNER JOIN App_Client AC WITH (NOLOCK) ON C.clientId = AC.id

WHERE AC.specialClientFlags &amp; 0x02 = 0 /*Not Pseudo client*/



DELETE FROM #listClientIds_SharePoint

WHERE clientId NOT IN 

(SELECT componentNameId FROM App_ClientProp WITH (NOLOCK) WHERE attrName = 'Office 365 Pseudo Client' AND attrVal = 1 /*V2 client*/ AND modified = 0

AND componentNameId IN (SELECT clientId FROM #listClientIds_SharePoint))



IF EXISTS (SELECT Options FROM @Options WHERE Options = 'Show backup disabled clients')

	SET @includeBackupDisabledClients = 1



DECLARE @csTimeZoneId			INT = 0

DECLARE @csTimeZone				NVARCHAR(1024) = ''

DECLARE @browserBias			INT = 0

DECLARE @browserTimeZoneId		INT = 0



SET @browserTimeZoneId = (SELECT TOP 1 TimeZoneID FROM SchedTimeZone WITH (NOLOCK) WHERE TimeZoneName LIKE '%' + @sys_timezone + '%')

SELECT @browserBias = Bias FROM SchedTimeZone WITH (NOLOCK) WHERE TimeZoneID = @browserTimeZoneId



SELECT @csTimeZoneId = (SELECT TOP 1 attrVal FROM APP_ClientProp WITH (NOLOCK) WHERE attrName = 'Commcell timezone Id' AND modified = 0)

IF ISNULL(@csTimeZoneId, 0) = 0

	SELECT @csTimeZoneId = (SELECT TOP 1 attrVal FROM APP_ClientProp WITH (NOLOCK) WHERE componentNameId = 2 AND attrName = 'timezone Id' AND modified = 0)

SET @csTimeZone = (SELECT TOP 1 TimeZoneName FROM SchedTimeZone WITH (NOLOCK) WHERE TimeZoneID = @csTimeZoneId)



DECLARE @startTime BIGINT = DATEDIFF(SS, '1970-01-01', dbo.LocalToUTCDateTimeConversionManaged(ISNULL(@timeframe_from,'1970-01-01 00:00:00.000'), @csTimeZone))



UPDATE #listClientIds_SharePoint

SET subclientId = S.subclientId, backupsetId = S.backupSet, instanceId = S.instance

FROM (SELECT MIN(id) AS subclientId, clientId, backupSet, instance

		FROM APP_Application WITH (NOLOCK)

		WHERE clientId IN (SELECT clientId FROM #listClientIds_SharePoint)

		GROUP BY clientId, backupSet, instance

	) S WHERE #listClientIds_SharePoint.clientId = S.clientId



UPDATE #listClientIds_SharePoint

SET isBackupDisabled = JA.action

FROM JMJobAction JA WITH (NOLOCK)

INNER JOIN #listClientIds_SharePoint TS ON TS.subclientId = JA.appId

WHERE JA.clientId = 1 AND JA.mediaAgentID = 1 AND JA.appType = 0 AND JA.optype = 4



UPDATE #listClientIds_SharePoint

SET isBackupDisabled = @LICENSE_RELEASED

FROM APP_Application(NOLOCK) AA

WHERE AA.id = #listClientIds_SharePoint.subclientId AND subclientStatus &amp; 0x02 = 0x02



UPDATE #listClientIds_SharePoint

SET isBackupDisabled = @EXCLUDED_FROM_SLA

FROM APP_SubClientProp ASP WITH (NOLOCK)

WHERE ASP.componentNameId = #listClientIds_SharePoint.subclientId AND ASP.attrName = 'Exclude From SLA' AND ASP.attrVal = 1 AND ASP.modified = 0



UPDATE #listClientIds_SharePoint

SET isBackupDisabled = @TENANT_DIACTIVEVATED

WHERE clientId IN (SELECT DISTINCT CGA.clientId

	FROM UMDSProviders UMDS WITH (NOLOCK)

	JOIN App_CompanyProp CP WITH (NOLOCK) ON CP.attrName = 'Associated Smart Client Group' AND CP.modified = 0 AND UMDS.id = CP.componentNameId

	JOIN APP_ClientGroupAssoc CGA WITH (NOLOCK) ON CAST(CGA.clientGroupId AS NVARCHAR(16)) = CP.attrVal

	WHERE UMDS.flags &amp; 0x0010 = 0x0010 OR enabled = 0)	



IF @includeBackupDisabledClients = 0

	DELETE FROM #listClientIds_SharePoint WHERE isBackupDisabled IN (1, @TENANT_DIACTIVEVATED, @LICENSE_RELEASED, @EXCLUDED_FROM_SLA)



IF OBJECT_ID('tempdb.dbo.#temp_unprotected_mailboxes_sp_sla') IS NOT NULL

	DROP TABLE #temp_unprotected_mailboxes_sp_sla



CREATE TABLE #temp_unprotected_mailboxes_sp_sla

(

	created BIGINT,

	backupReferenceTime BIGINT,

	clientId INT,

	isProtected INT

)

CREATE CLUSTERED INDEX #Idx1_temp_um_sp_sla_clientId ON #temp_unprotected_mailboxes_sp_sla (clientId)



INSERT INTO #temp_unprotected_mailboxes_sp_sla (created, backupReferenceTime, clientId, isProtected)

SELECT created, CU.backupReferenceTime, TS.clientId,

(CASE WHEN (backupReferenceTime &lt; @startTime OR backupReferenceTime IS NULL) THEN 0/*unprotected*/ ELSE 1/*protected*/ END)

FROM App_CloudAppUserDetails CU WITH (NOLOCK)

INNER JOIN #listClientIds_SharePoint TS ON TS.subclientId = CU.subClientId

WHERE CU.discoverByType = 6 AND CU.modified = 0 AND CU.status = 0 /*Active*/ AND CU.smtpAddress IS NOT NULL AND (CU.flags &amp; 2) = 0



IF OBJECT_ID('tempdb.dbo.#sharepoint_client_sla') IS NOT NULL

	DROP TABLE #sharepoint_client_sla



CREATE TABLE #sharepoint_client_sla

(

	clientId INT UNIQUE CLUSTERED,

	clientName NVARCHAR(255),

	clientDisplayName NVARCHAR(255),

	totalEntities BIGINT,

	slaMissedEntities BIGINT,

	neverBackedUp INT,

	recentlyAddedEntities BIGINT,

	needAttention INT,

	clientStatus NVARCHAR(32) DEFAULT 'Active',

	lastIndexPlaybackTime BIGINT,

	lastIndexBkpJobId INT,

	lastIndexErrorTime BIGINT,

	lastDiscoverTime BIGINT,

	lastBackupJobRunTime BIGINT,

	lastBackupJobId BIGINT,

	applicationSize BIGINT,

	numberOfItems BIGINT,

	itemsContentIndexed BIGINT,

	azureApps INT DEFAULT 0,

	authoziedAzureApps INT DEFAULT 0,

	lastVerifyConnectionTime BIGINT,

	streams INT,

	isModernAuthEnabled INT,

	accessNodeGroupId INT,

	accessNodeGroupDisplayName NVARCHAR(255),

	indexServerId INT,

	indexServerCloudId INT,

	indexServerName NVARCHAR(255),

	indexServerDisplayName NVARCHAR(255),

	clienturl NVARCHAR(2048),

	activejobsurl NVARCHAR(2048),

	indexserverurl NVARCHAR(2048),

	accessNodeGroupUrl NVARCHAR(2048)

)



INSERT INTO #sharepoint_client_sla (clientId, totalEntities, slaMissedEntities, neverBackedUp, 	recentlyAddedEntities, needAttention)

SELECT

clientId,

COUNT(*),

SUM(CASE WHEN isProtected = 0 THEN 1 ELSE 0 END),

SUM(CASE WHEN backupReferenceTime IS NULL OR backupReferenceTime = 0 THEN 1 ELSE 0 END),

SUM(CASE WHEN created IS NOT NULL AND created &gt;= @recentlyAddedRefTime THEN 1 ELSE 0 END),

SUM(CASE WHEN (backupReferenceTime IS NULL OR backupReferenceTime = 0) AND @recentlyAddedRefTime &gt; created THEN 1 ELSE 0 END)

FROM #temp_unprotected_mailboxes_sp_sla

GROUP BY clientId



INSERT INTO #sharepoint_client_sla (clientId, totalEntities, slaMissedEntities, neverBackedUp, recentlyAddedEntities, needAttention)

SELECT clientId, 0, 0, 0, 0, 0

FROM #listClientIds_SharePoint TS

WHERE TS.clientId NOT IN (SELECT clientId FROM #sharepoint_client_sla)



UPDATE #sharepoint_client_sla

SET clientName = AC.name, clientDisplayName = AC.displayName

FROM APP_Client AC WITH (NOLOCK)

WHERE #sharepoint_client_sla.clientId = AC.id



UPDATE #sharepoint_client_sla

SET lastIndexPlaybackTime = Idx.playbackTime, lastIndexBkpJobId = Idx.bkpJobId, lastIndexErrorTime = Idx.errorTime, applicationSize = Idx.backupSize, numberOfItems = Idx.numberOfItems, itemsContentIndexed = Idx.itemsContentIndexed

FROM

(

	SELECT I.properties.value('Indexing_DbStats[1]/@lastPlayedBkpTime', 'BIGINT') AS playbackTime, I.properties.value('(Indexing_DbStats/apps)[1]/@lastPlayedBkpJobId', 'INT') AS bkpJobId, 

	I.properties.value('Indexing_DbStats[1]/@lastIdxErrorTime', 'INT') AS errorTime, TS.clientId AS clientId,

	ISNULL(I.properties.value('(Indexing_DbStats/apps/stat)[1]/@applicationSize', 'BIGINT'), 0) AS backupSize, ISNULL(I.properties.value('(Indexing_DbStats/apps/stat)[1]/@itemsIndexed', 'BIGINT'), 0) AS numberOfItems,

	ISNULL(I.properties.value('(Indexing_DbStats/apps/stat)[1]/@itemsContentIndexed', 'BIGINT'), 0) AS itemsContentIndexed

	FROM IdxDbState I WITH (NOLOCK)

	INNER JOIN App_IndexDbInfo AI WITH (NOLOCK) ON I.dbid = AI.id

	INNER JOIN #listClientIds_SharePoint TS ON TS.backupsetId = AI.backupSetId

) Idx WHERE Idx.clientId = #sharepoint_client_sla.clientId



UPDATE #sharepoint_client_sla

SET lastDiscoverTime = DS.value('App_Office365DiscoverState[1]/@lastCacheUpdateTime', 'BIGINT')

FROM

(

	SELECT TS.clientId AS clientId, CAST(CAST(attrVal AS VARCHAR(MAX)) AS XML) DS

	FROM App_BackupSetProp ABP WITH (NOLOCK)

	INNER JOIN #listClientIds_SharePoint TS ON ABP.componentNameId = TS.backupsetId

	WHERE ABP.attrName = 'SharePoint Discovery State' AND ABP.modified = 0

) D WHERE D.clientId = #sharepoint_client_sla.clientId



UPDATE #sharepoint_client_sla

SET lastBackupJobRunTime = LBJ.value('(lastBackupJobInfo/endTime)[1]/@time', 'BIGINT'),  lastBackupJobId = LBJ.value('(lastBackupJobInfo)[1]/@jobID', 'BIGINT')

FROM

(

	SELECT TS.clientId AS clientId, CAST(CAST(attrVal AS VARCHAR(MAX)) AS XML) LBJ

	FROM App_BackupSetProp ABP WITH (NOLOCK)

	INNER JOIN #listClientIds_SharePoint TS ON ABP.componentNameId = TS.backupsetId

	WHERE ABP.attrName = 'Last Backup Job Info' AND ABP.modified = 0

) D WHERE D.clientId = #sharepoint_client_sla.clientId



IF @includeBackupDisabledClients = 1

	UPDATE #sharepoint_client_sla

	SET clientStatus = (CASE 

							WHEN isBackupDisabled = 1 THEN 'Backup Activity is Disabled'

							WHEN isBackupDisabled = @TENANT_DIACTIVEVATED THEN 'Tenant Deactivated/Disabled'

							WHEN isBackupDisabled = @LICENSE_RELEASED THEN 'License Released'

							WHEN isBackupDisabled = @EXCLUDED_FROM_SLA THEN 'Excluded From SLA'

							ELSE 'Active'

						END)

	FROM #listClientIds_SharePoint

	WHERE #sharepoint_client_sla.clientId = #listClientIds_SharePoint.clientId AND isBackupDisabled IN (1, @TENANT_DIACTIVEVATED, @LICENSE_RELEASED, @EXCLUDED_FROM_SLA)



UPDATE #sharepoint_client_sla

SET isModernAuthEnabled = ISNULL(CAST(attrVal AS INT), 0)

FROM #listClientIds_SharePoint TS 

INNER JOIN App_BackupSetProp BP WITH (NOLOCK) ON TS.backupsetId = BP.componentNameId

WHERE #sharepoint_client_sla.clientId = TS.clientId AND attrName = 'Sharepoint Modern Auth' AND modified = 0



UPDATE #sharepoint_client_sla

SET azureApps = CAST(CAST(BP.attrVal AS VARCHAR(MAX)) AS XML).value('count(/App_Office365AzureConnections/azureApps)', 'int'),

	authoziedAzureApps = CAST(CAST(BP.attrVal AS VARCHAR(MAX)) AS XML).value('count(/App_Office365AzureConnections//*[@appStatus="1"])', 'int')

FROM #listClientIds_SharePoint TS 

INNER JOIN App_BackupSetProp BP WITH (NOLOCK) ON TS.backupsetId = BP.componentNameId

WHERE #sharepoint_client_sla.clientId = TS.clientId AND attrName = 'Sharepoint Azure Connections' AND modified = 0



UPDATE #sharepoint_client_sla

SET authoziedAzureApps = CAST(CAST(BP.attrVal AS VARCHAR(MAX)) AS XML).value('count(/App_Office365AzureConnectionsStatus/azureAppList//*[@appStatus="1"])', 'int'),

    lastVerifyConnectionTime = CAST(CAST(BP.attrVal AS VARCHAR(MAX)) AS XML).value('(//@lastAzureAppStatusUpdate)[1]', 'BIGINT')

FROM #listClientIds_SharePoint TS 

INNER JOIN App_BackupSetProp BP WITH (NOLOCK) ON TS.backupsetId = BP.componentNameId

WHERE #sharepoint_client_sla.clientId = TS.clientId AND attrName = 'Office365 Azure Connections Status' AND modified = 0



UPDATE #sharepoint_client_sla

SET streams = CAST(attrVal AS INT)

FROM #listClientIds_SharePoint TE

INNER JOIN APP_SubClientProp ASP WITH (NOLOCK) ON TE.subclientId = ASP.componentNameId

WHERE #sharepoint_client_sla.clientId = TE.clientId AND attrName = 'sys:nStreams' AND modified = 0



UPDATE #sharepoint_client_sla

SET accessNodeGroupId = CAST(CAST(attrVal AS VARCHAR(MAX)) AS XML).value('(//@clientGroupId)[1]', 'int'),

	accessNodeGroupDisplayName = CAST(CAST(attrVal AS VARCHAR(MAX)) AS XML).value('(//@clientGroupName)[1]', 'nvarchar(max)')

FROM #listClientIds_SharePoint TS

INNER JOIN APP_IDAName AIN WITH (NOLOCK) ON TS.clientId = AIN.clientId AND AIN.appTypeId = @CV_APPTYPE_SHAREPOINT

INNER JOIN APP_IDAProp AIP WITH (NOLOCK) ON AIN.id = AIP.componentNameId

WHERE #sharepoint_client_sla.clientId = TS.clientId AND attrName = 'Sharepoint Member Servers' AND AIP.modified = 0



UPDATE #sharepoint_client_sla

SET indexServerId = AIP.attrVal

FROM #listClientIds_SharePoint TS

INNER JOIN App_IdaName AIN WITH (NOLOCK) ON TS.clientId = AIN.clientId AND AIN.appTypeId = @CV_APPTYPE_SHAREPOINT

INNER JOIN App_IdaProp AIP WITH (NOLOCK) ON AIP.componentNameId = AIN.id

WHERE #sharepoint_client_sla.clientId = TS.clientId AND AIP.attrName = 'SharePoint Index Server' AND AIP.modified = 0



UPDATE #sharepoint_client_sla

SET indexServerCloudId = ISNULL(DC.cloudId, 0)

FROM DM2Cloud DC WITH (NOLOCK)

WHERE #sharepoint_client_sla.indexServerId = DC.pseudoClientId



UPDATE #sharepoint_client_sla

SET indexServerName = AC.name, indexServerDisplayName = AC.displayName

FROM APP_Client AC WITH (NOLOCK)

WHERE #sharepoint_client_sla.indexServerId = AC.id



UPDATE #sharepoint_client_sla

SET clienturl = '#/office365/clientDetails/' + clientName + '/' + CAST(TS.clientId AS NVARCHAR(64)) + '/' + CAST(TS.subclientId AS NVARCHAR(64)) + '/webs?backupsetId=' + CAST(TS.backupsetId AS NVARCHAR(64)),

	activejobsurl = '#/activeJobs?backupsetId=' + CAST(TS.backupsetId AS NVARCHAR(64)) + '&amp;activeJobs=0&amp;serverName=' + clientName + '&amp;serverId=' + CAST(TS.clientId AS NVARCHAR(64)) + '&amp;applicationId=78',

	indexServerUrl = '#/indexServer/configuration/' + CAST(indexServerId AS NVARCHAR(64)) + '?name=' + indexServerName + '&amp;cloudId=' + CAST(indexServerCloudId AS NVARCHAR(64)),

	accessNodeGroupUrl = '#/clientGroupDetails/' + CAST(accessNodeGroupId AS NVARCHAR(64))

FROM #listClientIds_SharePoint TS

WHERE #sharepoint_client_sla.clientId = TS.clientId



SELECT

clientDisplayName AS 'Client',

clientStatus AS 'Client Status',

(CASE WHEN lastIndexPlaybackTime IS NOT NULL AND lastIndexPlaybackTime &gt;= @startTime THEN 'UpToDate' ELSE 'Pending playback' END) AS 'Index Status',

(CASE WHEN lastIndexBkpJobId IS NOT NULL AND lastIndexBkpJobId &gt; 0 THEN CAST(lastIndexBkpJobId AS VARCHAR(64)) ELSE '' END) AS 'Last Indexed Backup JobId',

(CASE WHEN lastIndexPlaybackTime IS NOT NULL AND lastIndexPlaybackTime &gt; 0 

	THEN (SELECT DATEADD(ss, lastIndexPlaybackTime + @browserBias, CAST('1970-01-01 00:00' AS DATETIME)))

END) AS 'Last Index Time',

(CASE WHEN lastIndexErrorTime IS NOT NULL AND lastIndexErrorTime &gt; 0 

	THEN (SELECT DATEADD(ss, lastIndexErrorTime + @browserBias, CAST('1970-01-01 00:00' AS DATETIME)))

END) AS 'Last Index Error Time',

(CASE WHEN lastDiscoverTime IS NOT NULL AND lastDiscoverTime &gt; 0 

	THEN (SELECT DATEADD(ss, lastDiscoverTime + @browserBias, CAST('1970-01-01 00:00' AS DATETIME)))

END) AS 'Last Discovery Time',

(CASE WHEN ISNULL(lastBackupJobRunTime, 0) &gt; 0 

	THEN (SELECT DATEADD(ss, lastBackupJobRunTime + @browserBias, CAST('1970-01-01 00:00' AS DATETIME)))

END) AS 'Last Backup Run Time',

(CASE

	WHEN ISNULL(lastBackupJobId, 0) &gt; 0 THEN CAST(lastBackupJobId AS VARCHAR(64))

	ELSE ''

END) AS 'Last Backup Job ID',

totalEntities AS 'Associated Sites',

(totalEntities - slaMissedEntities) AS 'Sites Backed-up',

slaMissedEntities AS 'Sites Not Backed-up',

neverBackedUp AS 'Sites Never Backed-up',

(totalEntities - neverBackedUp) AS 'Sites Backed-up (at least once)',

recentlyAddedEntities AS 'Sites Recently Added',

needAttention AS 'Sites Need Attention',

applicationSize AS 'Application Size',

numberOfItems AS 'Number of Items',

itemsContentIndexed AS 'Indexed Items',

azureApps AS 'Azure Apps Associated',

azureApps - authoziedAzureApps AS 'Azure Apps Not Authorized',

(CASE 

	WHEN isModernAuthEnabled = 1 AND totalEntities &lt; @MAX_USERS_FOR_FIVE_CONNECTIONS AND azureApps &lt; 5 THEN 5 - azureApps

	WHEN isModernAuthEnabled = 1 AND totalEntities &gt;= @MAX_USERS_FOR_FIVE_CONNECTIONS AND azureApps &lt; 10 THEN 10 - azureApps

	ELSE 0 

END) AS 'Azure Apps To Be Added',

(CASE

	WHEN ISNULL(lastVerifyConnectionTime, 0) &gt; 0 THEN (SELECT DATEADD(ss, lastVerifyConnectionTime + @browserBias, CAST('1970-01-01 00:00' AS DATETIME)))

END) AS 'Last Verify Connection Time',

streams AS 'Max Streams',

ISNULL(accessNodeGroupDisplayName, '') AS 'Access Node Group',

ISNULL(indexServerDisplayName, '') AS 'Index Server',

'Active Jobs' AS 'Active Jobs',

(CASE WHEN lastIndexBkpJobId IS NOT NULL AND lastIndexBkpJobId &gt; 0 

	THEN '#/jobs/' + CAST(lastIndexBkpJobId AS NVARCHAR(256))

	ELSE ''

END) AS 'joburl',

(CASE WHEN ISNULL(lastBackupJobId, 0) &gt; 0

	THEN '#/jobs/' + CAST(lastBackupJobId AS NVARCHAR(256))

	ELSE ''

END) AS 'backupjoburl',

clienturl AS 'clienturl',

activejobsurl AS 'activejobsurl',

ISNULL(accessNodeGroupUrl, '') AS 'accessNodeGroupUrl',

indexserverurl AS 'indexserverurl'

FROM #sharepoint_client_sla

ORDER BY totalEntities DESC



IF OBJECT_ID('tempdb.dbo.#listClientIds_SharePoint') IS NOT NULL

	DROP TABLE #listClientIds_SharePoint



IF OBJECT_ID('tempdb.dbo.#temp_unprotected_mailboxes_sp_sla') IS NOT NULL

	DROP TABLE #temp_unprotected_mailboxes_sp_sla



IF OBJECT_ID('tempdb.dbo.#sharepoint_client_sla') IS NOT NULL

	DROP TABLE #sharepoint_client_sla</sqlText>
              <timeout>5</timeout>
              <postQueryFilter>true</postQueryFilter>
              <rDataSetQuery />
              <rPlotQuery />
            </GetOperation>
            <description>Backup Health Report for Office 365 Clients.</description>
            <databaseName>CommServ</databaseName>
            <queryPlan>
              <offline>false</offline>
              <collectionType>HTTP</collectionType>
              <retentionDays>1</retentionDays>
              <versions>
                <CommCellVersion>ALL</CommCellVersion>
              </versions>
              <dynamicCollection>false</dynamicCollection>
              <frequency>60</frequency>
              <direct>false</direct>
            </queryPlan>
            <version>144</version>
            <guid>f7a2f018-783b-4700-af3f-5430e1be97e1</guid>
            <hidden>true</hidden>
            <revision />
            <computedColumns>
              <scriptName>R</scriptName>
              <script />
              <columnList />
            </computedColumns>
          </DataSet>
          <DataSet>
            <dataSet>
              <dataSetName>SharePoint Sites SLA</dataSetName>
              <dataSetGuid>a8b5d60e-9405-41a3-c838-6f0d5152e0cd</dataSetGuid>
            </dataSet>
            <endpoint>DATABASE</endpoint>
            <shared>false</shared>
            <dataSources>
              <DataSource>
                <connectionType>COMMCELL</connectionType>
                <endpoint>DATABASE</endpoint>
                <commCell>
                  <commCellName>$ALL$</commCellName>
                </commCell>
              </DataSource>
            </dataSources>
            <allColumns>true</allColumns>
            <fields>
              <Column>
                <name>sys_rowid</name>
                <dataField>$row_number$</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Data Source</name>
                <dataField>Data Source</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Name</name>
                <dataField>Name</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Site URL</name>
                <dataField>Site URL</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Last Backup</name>
                <dataField>Last Backup</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Last Backup Status</name>
                <dataField>Last Backup Status</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Failure Reason</name>
                <dataField>Failure Reason</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Last Backup Attempt</name>
                <dataField>Last Backup Attempt</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Last Backup Attempt JobId</name>
                <dataField>Last Backup Attempt JobId</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Client</name>
                <dataField>Client</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Added to content on</name>
                <dataField>Added to content on</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Backup Size</name>
                <dataField>Backup Size</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Number Of Items</name>
                <dataField>Number Of Items</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Failed Items</name>
                <dataField>Failed Items</dataField>
                <type>Integer</type>
              </Column>
            </fields>
            <GetOperation>
              <parameters>
                <Parameter>
                  <name>Clients</name>
                  <dataType>Integer</dataType>
                  <isList>true</isList>
                  <values>
                    <string>=input.SharePointClients</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>ClientGroups</name>
                  <dataType>Integer</dataType>
                  <isList>true</isList>
                  <values>
                    <string>=input.ClientGroups</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>timeframe</name>
                  <dataType>DateRange</dataType>
                  <values>
                    <string>=input.Timeframe</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>Options</name>
                  <dataType>String</dataType>
                  <isList>true</isList>
                  <values>
                    <string>=input.Options</string>
                  </values>
                </Parameter>
              </parameters>
              <sqlText>/*Validity check*/

IF NOT EXISTS (SELECT Clients FROM @Clients) AND NOT EXISTS (SELECT ClientGroups FROM @ClientGroups)

BEGIN

	/*SELECT dummy columns to maintain consistency in report columns output*/

	SELECT 

		Clients AS [Name],

		Clients AS [Site URL],

		Clients AS [Last Backup],

		Clients AS [Last Backup Status],

		Clients AS [Failure Reason],

		Clients AS [Last Backup Attempt],

		Clients AS [Last Backup Attempt JobId],

		Clients AS [Client],

		Clients AS [Added to content on],

		Clients AS [Backup Size],

		Clients AS [Number Of Items],

		Clients AS [Failed Items]

	FROM @Clients



	RETURN

END



-- constants

DECLARE @CV_APPTYPE_SHAREPOINT INT = 78



DECLARE @STATUS_NOT_AVAILABLE INT = 0

DECLARE @STATUS_FAILED INT = 1

DECLARE @STATUS_SKIPPED INT = 2

DECLARE @STATUS_SUCCESS INT = 3

DECLARE @STATUS_SUSPENDED INT = 4

DECLARE @STATUS_COMPLETED_WITH_ERRORS INT = 5

DECLARE @STATUS_PARTIALLY_PROCESSED INT = 6

DECLARE @STATUS_NEVER_BACKED_UP INT = 501



-- variables

DECLARE @userId INT = (SELECT TOP 1 id FROM UMUsers WITH (NOLOCK) WHERE login = @sys_username)

DECLARE @companyId INT

DECLARE @includeBackupDisabledClients INT = 0

DECLARE @includeAllSites INT = 0



IF OBJECT_ID('tempdb.dbo.#listClientIds_SharePoint') IS NOT NULL

	DROP TABLE #listClientIds_SharePoint



CREATE TABLE #listClientIds_SharePoint (clientId INT, subclientId INT, backupsetId INT, instanceId INT)

CREATE NONCLUSTERED INDEX #listClientIds_SharePoint_c_s_b_i_ids ON #listClientIds_SharePoint(clientId, subclientId, backupsetId, instanceId)



DECLARE @numberOfDays INT = 7

DECLARE @depthRefTime INT = dbo.getunixtime(DATEADD(HOUR, -@numberOfDays*24 , GETUTCDATE()))



-- read inputs

INSERT INTO #listClientIds_SharePoint (clientId) 

SELECT DISTINCT Clients FROM @Clients

UNION

SELECT DISTINCT CG.clientId FROM App_ClientGroupAssoc CG WITH (NOLOCK)

INNER JOIN APP_Application AA WITH (NOLOCK) ON CG.clientId = AA.clientId AND AA.appTypeId = @CV_APPTYPE_SHAREPOINT

WHERE clientGroupId IN (SELECT ClientGroups FROM @ClientGroups)

AND subclientStatus &amp; 0x04 != 0x04 /*DELETED*/ AND subclientStatus &amp; 0x00020 != 0x00020 /*HIDDEN*/



IF OBJECT_ID('tempdb.dbo.#temp__clientIds') IS NOT NULL

	DROP TABLE #temp__clientIds



CREATE TABLE #temp__clientIds

(

	clientId            INT,

	appTypeId           INT,

	instanceId          INT,

	backupsetId         INT,

	subclientId         INT

)



SET @companyId = dbo.AppGetOrganizationForUser(@userId)



IF @companyId &gt; 0

BEGIN

	INSERT INTO #temp__clientIds (clientId)

	SELECT DISTINCT CGA.clientId

	FROM UMDSProviders UMDS WITH (NOLOCK)

	JOIN App_CompanyProp CP WITH (NOLOCK) ON CP.attrName = 'Associated Smart Client Group' AND CP.modified = 0 AND UMDS.id = CP.componentNameId

	JOIN APP_ClientGroupAssoc CGA WITH (NOLOCK) ON CAST(CGA.clientGroupId AS NVARCHAR(16)) = CP.attrVal

	JOIN APP_ClientGroup CG WITH (NOLOCK) ON CGA.clientGroupId = CG.id

	WHERE CP.componentNameId = @companyId AND CG.flag &amp; 0x1000 &gt; 0

END

ELSE

BEGIN

	EXEC dbo.sec_getIdaObjectsForUser @userId, 3 /*Client Entity*/, 0, 0, '#temp__clientIds', 1

END



DELETE #listClientIds_SharePoint

FROM #listClientIds_SharePoint C 

INNER JOIN App_Client AC WITH (NOLOCK) ON C.clientId = AC.id

WHERE AC.specialClientFlags &amp; 0x02 = 0 /*Not Pseudo client*/ OR C.clientId NOT IN (SELECT clientId FROM #temp__clientIds)



IF OBJECT_ID('tempdb.dbo.#temp__clientIds') IS NOT NULL

	DROP TABLE #temp__clientIds



DECLARE @csTimeZoneId			INT = 0

DECLARE @csTimeZone				NVARCHAR(1024) = ''

DECLARE @browserBias			INT = 0

DECLARE @browserTimeZoneId		INT = 0



SET @browserTimeZoneId = (SELECT TOP 1 TimeZoneID FROM SchedTimeZone WITH (NOLOCK) WHERE TimeZoneName LIKE '%' + @sys_timezone + '%')

SELECT @browserBias = Bias FROM SchedTimeZone WITH (NOLOCK) WHERE TimeZoneID = @browserTimeZoneId



SELECT @csTimeZoneId = (SELECT TOP 1 attrVal FROM APP_ClientProp WITH (NOLOCK) WHERE attrName = 'Commcell timezone Id' AND modified = 0)

IF ISNULL(@csTimeZoneId, 0) = 0

	SELECT @csTimeZoneId = (SELECT TOP 1 attrVal FROM APP_ClientProp WITH (NOLOCK) WHERE componentNameId = 2 AND attrName = 'timezone Id' AND modified = 0)

SET @csTimeZone = (SELECT TOP 1 TimeZoneName FROM SchedTimeZone WITH (NOLOCK) WHERE TimeZoneID = @csTimeZoneId)



DECLARE @startTime BIGINT = DATEDIFF(SS, '1970-01-01', dbo.LocalToUTCDateTimeConversionManaged(ISNULL(@timeframe_from,'1970-01-01 00:00:00.000'), @csTimeZone))





IF EXISTS (SELECT Options FROM @Options WHERE Options = 'Show backup disabled clients')

	SET @includeBackupDisabledClients = 1



IF EXISTS (SELECT Options FROM @Options WHERE Options = 'Show all sites')

	SET @includeAllSites = 1



UPDATE #listClientIds_SharePoint

SET subclientId = S.subclientId, backupsetId = S.backupSet, instanceId = S.instance

FROM (SELECT MIN(id) AS subclientId, clientId, backupSet, instance

		FROM APP_Application WITH (NOLOCK)

		WHERE clientId IN (SELECT clientId FROM #listClientIds_SharePoint)

		GROUP BY clientId, backupSet, instance

	) S WHERE #listClientIds_SharePoint.clientId = S.clientId



IF @includeBackupDisabledClients = 0

BEGIN

	DELETE FROM #listClientIds_SharePoint

	WHERE subclientId IN 

	(

		/*Delete license released clients*/

		SELECT AA.id

		FROM App_Application AA WITH (NOLOCK)

		INNER JOIN #listClientIds_SharePoint TT ON AA.id = TT.subclientId 

		WHERE subclientStatus &amp; 0x02 = 0x02

		UNION

		/*Delete excluded from SLA clients*/

		SELECT ASP.componentNameId

		FROM APP_SubClientProp ASP WITH (NOLOCK)

		JOIN #listClientIds_SharePoint TE ON ASP.componentNameId = TE.subclientId

		WHERE ASP.attrName = 'Exclude From SLA' AND ASP.attrVal = 1 AND ASP.modified = 0

		UNION

		/*Delete backup disabled clients*/

		SELECT JA.appId

		FROM JMJobAction JA WITH (NOLOCK) 

		JOIN #listClientIds_SharePoint TE ON JA.appId = TE.subclientId

		WHERE JA.clientId = 1 AND JA.mediaAgentID = 1 AND JA.appType = 0 AND JA.optype = 4 AND JA.action = 1

	)



	/*Delete clients associated with deactivated tenants*/

	DELETE FROM #listClientIds_SharePoint 

	WHERE clientId IN (SELECT DISTINCT CGA.clientId

	FROM UMDSProviders UMDS WITH (NOLOCK)

	JOIN App_CompanyProp CP WITH (NOLOCK) ON CP.attrName = 'Associated Smart Client Group' AND CP.modified = 0 AND UMDS.id = CP.componentNameId

	JOIN APP_ClientGroupAssoc CGA WITH (NOLOCK) ON CAST(CGA.clientGroupId AS NVARCHAR(16)) = CP.attrVal

	WHERE UMDS.flags &amp; 0x0010 = 0x0010 OR enabled = 0)

END



IF OBJECT_ID('tempdb.dbo.#temp_unprotected_mailboxes_sp') IS NOT NULL

	DROP TABLE #temp_unprotected_mailboxes_sp



CREATE TABLE #temp_unprotected_mailboxes_sp

(

	displayName NVARCHAR(512),

	smtpAddress NVARCHAR(512),

	userGUID NVARCHAR(128),

	created BIGINT,

	backupReferenceTime BIGINT,

	clientId INT,

	mailboxSize BIGINT,

	numberOfItems BIGINT,

	isProtected INT

)



INSERT INTO #temp_unprotected_mailboxes_sp (displayName, smtpAddress, userGUID, created, backupReferenceTime, clientId, mailboxSize, numberOfItems, isProtected)

SELECT CU.displayName, CU.smtpAddress, UPPER(CU.userGUID), created, CU.backupReferenceTime, TS.clientId, CU.userAccountSize, CU.numberOfItems, 0

FROM App_CloudAppUserDetails CU WITH (NOLOCK)

INNER JOIN #listClientIds_SharePoint TS ON TS.subclientId = CU.subClientId

WHERE CU.discoverByType = 6 AND CU.modified = 0 AND CU.status = 0 /*Active*/ AND CU.smtpAddress IS NOT NULL AND (CU.flags &amp; 2) = 0

AND (CASE 

		WHEN @includeAllSites = 1 THEN 1

		WHEN (backupReferenceTime &lt; @startTime OR backupReferenceTime IS NULL) THEN 1

		ELSE 0

	END) = 1



CREATE CLUSTERED INDEX #temp_unprotected_mailboxes_sp_smtp_clientId ON #temp_unprotected_mailboxes_sp (clientId, userGUID)



IF OBJECT_ID('tempdb.dbo.#upm_temp_job_summary_sp') IS NOT NULL

	DROP TABLE #upm_temp_job_summary_sp



CREATE TABLE #upm_temp_job_summary_sp

(

	clientId INT,

	jobId INT,

	jobStartTime BIGINT,

	jobEndTime BIGINT,

	data XML

)



CREATE CLUSTERED INDEX #ump_job_summary_client_jobId ON #upm_temp_job_summary_sp(clientId, jobId)



INSERT INTO #upm_temp_job_summary_sp

SELECT TE.clientId, JM.jobId, JS.servStartDate, JS.servEndDate, JM.data

FROM  JMMisc JM WITH (NOLOCK)

INNER JOIN JMBkpStats JS WITH (NOLOCK) ON JM.jobId = JS.jobId AND JS.servEndDate &gt;= @depthRefTime AND JS.commcellId = 2

INNER JOIN #listClientIds_SharePoint TE ON TE.subclientId = JS.appId

WHERE JS.opType = 4 /*Backup*/ AND JM.itemType = 28



IF OBJECT_ID('tempdb.dbo.#upm_temp_mailbox_summary_sp') IS NOT NULL

	DROP TABLE #upm_temp_mailbox_summary_sp



CREATE TABLE #upm_temp_mailbox_summary_sp

(

	smtpAddress NVARCHAR(512),

	userGUID NVARCHAR(128),

	status INT, 

	failureReason NVARCHAR(MAX),

	failedItems INT,

	jobId INT,

	jobStartTime BIGINT,

	jobEndTime BIGINT,

	clientId INT

)

CREATE CLUSTERED INDEX #upm_temp_mailbox_summary_sp_smtp_cId_jId ON #upm_temp_mailbox_summary_sp(jobId, clientId, userGUID)



INSERT INTO #upm_temp_mailbox_summary_sp

SELECT 

	M.NA.value('@SMTP', 'NVARCHAR(512)'),

	UPPER(REPLACE(M.NA.value('@GUID', 'NVARCHAR(128)'), '-', 'X')),

	M.NA.value('@status', 'INT'),

	M.NA.value('@FailureReason', 'NVARCHAR(MAX)'),

	M.NA.value('@FailedMessages', 'INT'),

	jobId, jobStartTime, jobEndTime, clientId

FROM #upm_temp_job_summary_sp U

CROSS APPLY data.nodes('./JobManager_ExchMbJobInfo/SourceMailboxStats') M(NA)

WHERE M.NA.value('@status', 'INT') &lt;&gt; @STATUS_SUCCESS -- Skip successful mailboxes



DELETE dup FROM 

(SELECT ROW_NUMBER() OVER (PARTITION BY userGUID, clientId ORDER BY jobId DESC) cnt FROM #upm_temp_mailbox_summary_sp) dup

WHERE dup.cnt &gt; 1





SELECT

displayName AS 'Name',

smtpAddress AS 'Site URL',

(CASE WHEN lastBackup IS NOT NULL AND lastBackup &gt; 0

	THEN (SELECT DATEADD(ss, lastBackup + @browserBias, CAST('1970-01-01 00:00:00' AS DATETIME)))

END) AS 'Last Backup', 

(CASE mailboxStatus 

	WHEN @STATUS_FAILED THEN 'Failed'

	WHEN @STATUS_SKIPPED THEN 'Skipped'

	WHEN @STATUS_SUCCESS THEN 'Successful'

	WHEN @STATUS_SUSPENDED THEN 'Suspended'

	WHEN @STATUS_COMPLETED_WITH_ERRORS THEN 'Completed with errors'

	WHEN @STATUS_PARTIALLY_PROCESSED THEN 'Partially Processed'

	WHEN @STATUS_NEVER_BACKED_UP THEN 'Never backed-up'

	WHEN @STATUS_NOT_AVAILABLE THEN 'Not Available'

END) AS 'Last Backup Status',

(CASE WHEN mailboxStatus NOT IN (@STATUS_SUCCESS, @STATUS_NOT_AVAILABLE) THEN failureReason END) AS 'Failure Reason',

(CASE 

	WHEN mailboxStatus = @STATUS_SUCCESS THEN (SELECT DATEADD(ss, lastBackup + @browserBias, CAST('1970-01-01 00:00:00' AS DATETIME)))

	WHEN mailboxStatus &lt;&gt; @STATUS_NOT_AVAILABLE THEN lastAttempt

END) AS 'Last Backup Attempt', 

(CASE WHEN mailboxStatus NOT IN (@STATUS_SUCCESS, @STATUS_NOT_AVAILABLE) THEN jobId END) AS 'Last Backup Attempt JobId',

clientName AS 'Client',

(CASE WHEN created IS NOT NULL AND created &gt; 0

	THEN (SELECT DATEADD(ss, created + @browserBias, CAST('1970-01-01 00:00:00' AS DATETIME)))

END) AS 'Added to content on', 

(CASE WHEN mailboxSize IS NULL THEN 0 ELSE mailboxSize END) AS 'Backup Size',

(CASE WHEN numberOfItems IS NULL THEN 0 ELSE numberOfItems END) AS 'Number Of Items',

(CASE WHEN mailboxStatus &lt;&gt; @STATUS_NOT_AVAILABLE THEN ISNULL(failedItems, 0) ELSE 0 END) AS 'Failed Items'

FROM 

(

	SELECT UP.displayName, UP.smtpAddress, UP.created,

	(SELECT DATEADD(ss, jobStartTime + @browserBias, CAST('1970-01-01 00:00:00' AS DATETIME))) AS [lastAttempt],

	backupReferenceTime AS [lastBackup],

	(CASE 

		WHEN MS.status IS NOT NULL AND (ISNULL(MS.jobStartTime, 0) &gt;= ISNULL(backupReferenceTime, 0) 

										OR ISNULL(backupReferenceTime, 0) BETWEEN ISNULL(MS.jobStartTime, 0) AND ISNULL(MS.jobEndTime, 0)) THEN MS.status

		WHEN ISNULL(backupReferenceTime, 0) &gt;= @depthRefTime THEN @STATUS_SUCCESS

		WHEN ISNULL(backupReferenceTime, 0) = 0 THEN @STATUS_NEVER_BACKED_UP 

		ELSE @STATUS_NOT_AVAILABLE 

	END) AS [mailboxStatus],

	UP.clientId, AC.displayName AS [clientName], jobId, failureReason, failedItems, mailboxSize, numberOfItems

	FROM #temp_unprotected_mailboxes_sp UP 

	LEFT JOIN App_Client AC WITH (NOLOCK) ON UP.clientId = AC.id

	LEFT JOIN #upm_temp_mailbox_summary_sp MS ON UP.userGUID = MS.userGUID AND UP.clientId = MS.clientId

	--WHERE (status = @STATUS_SKIPPED OR (MS.jobStartTime IS NULL OR MS.jobStartTime &gt; (CASE WHEN UP.backupReferenceTime IS NULL THEN 0 ELSE UP.backupReferenceTime END)))

) R

--ORDER BY jobId DESC, lastBackup DESC



IF OBJECT_ID('tempdb.dbo.#listClientIds_SharePoint') IS NOT NULL

	DROP TABLE #listClientIds_SharePoint



IF OBJECT_ID('tempdb.dbo.#upm_temp_mailbox_summary_sp') IS NOT NULL

	DROP TABLE #upm_temp_mailbox_summary_sp



IF OBJECT_ID('tempdb.dbo.#upm_temp_job_summary_sp') IS NOT NULL

	DROP TABLE #upm_temp_job_summary_sp



IF OBJECT_ID('tempdb.dbo.#temp_unprotected_mailboxes_sp') IS NOT NULL

	DROP TABLE #temp_unprotected_mailboxes_sp

</sqlText>
              <timeout>5</timeout>
              <postQueryFilter>true</postQueryFilter>
              <rDataSetQuery />
              <rPlotQuery />
            </GetOperation>
            <description>Backup Health Report for Office 365 Clients.</description>
            <databaseName>CommServ</databaseName>
            <queryPlan>
              <offline>false</offline>
              <collectionType>HTTP</collectionType>
              <retentionDays>1</retentionDays>
              <versions>
                <CommCellVersion>ALL</CommCellVersion>
              </versions>
              <dynamicCollection>false</dynamicCollection>
              <frequency>60</frequency>
              <direct>false</direct>
            </queryPlan>
            <version>144</version>
            <guid>a8b5d60e-9405-41a3-c838-6f0d5152e0cd</guid>
            <hidden>false</hidden>
            <revision />
            <computedColumns>
              <scriptName>R</scriptName>
              <script />
              <columnList />
            </computedColumns>
          </DataSet>
          <DataSet>
            <dataSet>
              <dataSetName>Client Discovery</dataSetName>
              <dataSetGuid>f93a5ea9-093f-4233-d693-d40ebd94f124</dataSetGuid>
            </dataSet>
            <endpoint>DATASET</endpoint>
            <shared>false</shared>
            <dataSources>
              <DataSource>
                <connectionType>COMMCELL</connectionType>
                <commCell>
                  <commCellName>$LocalCommCell$</commCellName>
                </commCell>
              </DataSource>
            </dataSources>
            <allColumns>false</allColumns>
            <fields>
              <Column>
                <name>sys_rowid</name>
                <dataField>$row_number$</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Data Source</name>
                <dataField>Data Source</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Client</name>
                <dataField>Client</dataField>
                <type>String</type>
              </Column>
            </fields>
            <GetOperation>
              <parameters>
                <Parameter>
                  <name>Clients</name>
                  <dataType>Integer</dataType>
                  <isList>true</isList>
                  <values>
                    <string>=input.SharePointClients</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>ClientGroups</name>
                  <dataType>Integer</dataType>
                  <isList>true</isList>
                  <values>
                    <string>=input.ClientGroups</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>timeframe</name>
                  <dataType>DateRange</dataType>
                  <values>
                    <string>=input.Timeframe</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>Options</name>
                  <dataType>String</dataType>
                  <isList>true</isList>
                  <values>
                    <string>=input.Options</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>natimeframe</name>
                  <dataType>DateRange</dataType>
                  <values>
                    <string>=input.NATimeRange</string>
                  </values>
                </Parameter>
              </parameters>
              <sqlText>SELECT Client FROM :[SharePoint Clients SLA]
WHERE [Last Discovery Time] &lt; @natimeframe_from OR [Last Discovery Time] IS NULL</sqlText>
              <timeout>5</timeout>
              <postQueryFilter>true</postQueryFilter>
              <rDataSetQuery />
              <rPlotQuery />
            </GetOperation>
            <description>Backup Health Report for Office 365 Clients.</description>
            <databaseName>CommServ</databaseName>
            <queryPlan>
              <offline>false</offline>
              <retentionDays>1</retentionDays>
              <versions>
                <CommCellVersion>ALL</CommCellVersion>
              </versions>
              <dynamicCollection>false</dynamicCollection>
              <frequency>60</frequency>
              <direct>true</direct>
            </queryPlan>
            <version>54</version>
            <guid>f93a5ea9-093f-4233-d693-d40ebd94f124</guid>
            <revision />
          </DataSet>
          <DataSet>
            <dataSet>
              <dataSetName>Clients Index</dataSetName>
              <dataSetGuid>593104f5-8de4-4c42-e33f-97277a7abf34</dataSetGuid>
            </dataSet>
            <endpoint>DATASET</endpoint>
            <shared>false</shared>
            <dataSources>
              <DataSource>
                <connectionType>COMMCELL</connectionType>
                <commCell>
                  <commCellName>$LocalCommCell$</commCellName>
                </commCell>
              </DataSource>
            </dataSources>
            <allColumns>false</allColumns>
            <fields>
              <Column>
                <name>sys_rowid</name>
                <dataField>$row_number$</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Data Source</name>
                <dataField>Data Source</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Client</name>
                <dataField>Client</dataField>
                <type>String</type>
              </Column>
            </fields>
            <GetOperation>
              <parameters>
                <Parameter>
                  <name>Clients</name>
                  <dataType>Integer</dataType>
                  <isList>true</isList>
                  <values>
                    <string>=input.SharePointClients</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>ClientGroups</name>
                  <dataType>Integer</dataType>
                  <isList>true</isList>
                  <values>
                    <string>=input.ClientGroups</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>timeframe</name>
                  <dataType>DateRange</dataType>
                  <values>
                    <string>=input.Timeframe</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>Options</name>
                  <dataType>String</dataType>
                  <isList>true</isList>
                  <values>
                    <string>=input.Options</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>natimeframe</name>
                  <dataType>DateRange</dataType>
                  <values>
                    <string>=input.NATimeRange</string>
                  </values>
                </Parameter>
              </parameters>
              <sqlText>SELECT Client FROM :[SharePoint Clients SLA]
WHERE [Last Index Time] &lt; @natimeframe_from OR [Last Index Time] IS NULL</sqlText>
              <timeout>5</timeout>
              <postQueryFilter>true</postQueryFilter>
              <rDataSetQuery />
              <rPlotQuery />
            </GetOperation>
            <description>Backup Health Report for Office 365 Clients.</description>
            <databaseName>CommServ</databaseName>
            <queryPlan>
              <offline>false</offline>
              <retentionDays>1</retentionDays>
              <versions>
                <CommCellVersion>ALL</CommCellVersion>
              </versions>
              <dynamicCollection>false</dynamicCollection>
              <frequency>60</frequency>
              <direct>true</direct>
            </queryPlan>
            <version>53</version>
            <guid>593104f5-8de4-4c42-e33f-97277a7abf34</guid>
            <revision />
          </DataSet>
        </dataSet>
      </dataSets>
      <inputs>
        <RptInput>
          <id>CommCell</id>
          <displayName>CommCell</displayName>
          <defaultValue>2</defaultValue>
          <type>Commcell</type>
          <controlType>ListBox</controlType>
          <required>false</required>
          <allowMultipleSelection>true</allowMultipleSelection>
          <fromDataSet>true</fromDataSet>
          <dataSetEntity>
            <dataSetName>CommcellList</dataSetName>
            <dataSetGuid>36711099-c17b-4857-b2d6-2d26e52c6aec</dataSetGuid>
          </dataSetEntity>
          <labelField>CCHostName</labelField>
          <valueField>id</valueField>
          <dependsOn />
          <relativeOptions />
        </RptInput>
        <RptInput>
          <id>SharePointClients</id>
          <displayName>SharePoint Clients</displayName>
          <type>Integer</type>
          <controlType>ListBox</controlType>
          <required>false</required>
          <allowMultipleSelection>true</allowMultipleSelection>
          <hideAllSelection>true</hideAllSelection>
          <fromDataSet>true</fromDataSet>
          <dataSetEntity>
            <dataSetId>1475</dataSetId>
            <dataSetName>SharePoint Clients</dataSetName>
            <dataSetGuid>5107c7ef-4a8a-40e9-d485-e482be0cf9f0</dataSetGuid>
          </dataSetEntity>
          <labelField>displayName</labelField>
          <valueField>id</valueField>
          <dependsOn />
          <relativeOptions />
          <sort>
            <columnId>displayName</columnId>
            <direction>Asc</direction>
          </sort>
        </RptInput>
        <RptInput>
          <id>ClientGroups</id>
          <displayName>Companies/Client Groups</displayName>
          <type>Integer</type>
          <controlType>ListBox</controlType>
          <required>false</required>
          <allowMultipleSelection>true</allowMultipleSelection>
          <hideAllSelection>true</hideAllSelection>
          <fromDataSet>true</fromDataSet>
          <dataSetEntity>
            <dataSetId>1476</dataSetId>
            <dataSetName>SharePoint Groups</dataSetName>
            <dataSetGuid>8f3a9008-6fd2-4fd2-e38d-9f10e178e36e</dataSetGuid>
          </dataSetEntity>
          <labelField>groupName</labelField>
          <valueField>groupId</valueField>
          <dependsOn />
          <relativeOptions />
          <sort>
            <columnId>groupName</columnId>
            <direction>Asc</direction>
          </sort>
        </RptInput>
        <RptInput>
          <id>Timeframe</id>
          <displayName>Timeframe</displayName>
          <defaultValue>-P3D P0D</defaultValue>
          <possibleValueLabels>
            <string>Last 1 Days</string>
            <string>Last 2 Days</string>
            <string>Last 3 Days</string>
            <string>Last 7 Days</string>
            <string>Last 30 Days</string>
          </possibleValueLabels>
          <possibleValues>
            <string>-P1D P0D</string>
            <string>-P2D P0D</string>
            <string>-P3D P0D</string>
            <string>-P7D P0D</string>
            <string>-P30D P0D</string>
          </possibleValues>
          <type>DateRange</type>
          <controlType>DateRange</controlType>
          <required>false</required>
          <fromDataSet>false</fromDataSet>
          <dependsOn />
          <relativeOptions>
            <string>Last</string>
          </relativeOptions>
          <relativeUnits>
            <string>Days</string>
          </relativeUnits>
        </RptInput>
        <RptInput>
          <id>Options</id>
          <displayName>Options</displayName>
          <possibleValueLabels>
            <string>Show backup disabled clients</string>
            <string>Show all sites</string>
          </possibleValueLabels>
          <possibleValues>
            <string>Show backup disabled clients</string>
            <string>Show all sites</string>
          </possibleValues>
          <type>String</type>
          <controlType>ListBox</controlType>
          <required>false</required>
          <allowMultipleSelection>false</allowMultipleSelection>
          <fromDataSet>false</fromDataSet>
          <dependsOn />
          <relativeOptions />
        </RptInput>
        <RptInput>
          <id>NATimeRange</id>
          <displayName>Need Attention Time Range</displayName>
          <defaultValue>-P7D P0D</defaultValue>
          <possibleValueLabels>
            <string>Last 7 Days</string>
          </possibleValueLabels>
          <possibleValues>
            <string>-P7D P0D</string>
          </possibleValues>
          <type>DateRange</type>
          <controlType>DateRange</controlType>
          <required>false</required>
          <fromDataSet>false</fromDataSet>
          <hidden>true</hidden>
          <dependsOn />
          <relativeOptions>
            <string>Last</string>
          </relativeOptions>
          <relativeUnits>
            <string>Days</string>
          </relativeUnits>
        </RptInput>
      </inputs>
      <header />
      <body>{
    "reportComponents": [
        {
            "type": "HITS",
            "dataSet": {
                "dataSetId": 1427,
                "dataSetName": "SharePoint Clients SLA",
                "dataSetGuid": "f7a2f018-783b-4700-af3f-5430e1be97e1",
                "originalDataSetName": "SharePoint Clients SLA"
            },
            "title": {
                "text": ""
            },
            "id": "Hits1620294531572",
            "mobile": {
                "visible": "On",
                "listItemClick": {},
                "customListLayout": null
            },
            "hideComponent": false,
            "blankComponent": false,
            "filters": {
                "builder": {},
                "viewer": {}
            },
            "visible": {},
            "orientation": "vertical",
            "color": {
                "backgroundColor": "#ffffff"
            },
            "iconPosition": "left",
            "hideHeader": true,
            "measureDataField": [
                {
                    "column": "Associated Sites",
                    "type": "Long",
                    "showNumberOps": true,
                    "aggrType": "Sum",
                    "captionPosition": "top",
                    "color": {
                        "captionColor": "#000",
                        "countColor": "#000"
                    },
                    "alignment": "center",
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    },
                    "displayText": "Associated Sites"
                }
            ],
            "isGroupBy": true,
            "toolTip": "Total number of active sites associated to the client(s)",
            "additionalProperties": false
        },
        {
            "type": "HITS",
            "dataSet": {
                "dataSetId": 1427,
                "dataSetName": "SharePoint Clients SLA",
                "dataSetGuid": "f7a2f018-783b-4700-af3f-5430e1be97e1",
                "originalDataSetName": "SharePoint Clients SLA"
            },
            "title": {
                "text": ""
            },
            "id": "Hits1620294540499",
            "mobile": {
                "visible": "On",
                "listItemClick": {},
                "customListLayout": null
            },
            "hideComponent": false,
            "blankComponent": false,
            "filters": {
                "builder": {},
                "viewer": {}
            },
            "color": {
                "backgroundColor": "#ffffff"
            },
            "iconPosition": "left",
            "hideHeader": true,
            "measureDataField": [
                {
                    "column": "Sites Backed-up",
                    "type": "Long",
                    "showNumberOps": true,
                    "aggrType": "Sum",
                    "captionPosition": "top",
                    "color": {
                        "captionColor": "#000",
                        "countColor": "#000"
                    },
                    "alignment": "center",
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    },
                    "displayText": "Sites Backed-up"
                }
            ],
            "isGroupBy": true,
            "toolTip": "Total number of sites backed-up in the selected time period",
            "additionalProperties": false
        },
        {
            "type": "HITS",
            "dataSet": {
                "dataSetId": 1427,
                "dataSetName": "SharePoint Clients SLA",
                "dataSetGuid": "f7a2f018-783b-4700-af3f-5430e1be97e1",
                "originalDataSetName": "SharePoint Clients SLA"
            },
            "title": {
                "text": ""
            },
            "id": "Hits1620294545720",
            "mobile": {
                "visible": "On",
                "listItemClick": {},
                "customListLayout": null
            },
            "hideComponent": false,
            "blankComponent": false,
            "filters": {
                "builder": {},
                "viewer": {}
            },
            "color": {
                "backgroundColor": "#ffffff"
            },
            "iconPosition": "left",
            "hideHeader": true,
            "measureDataField": [
                {
                    "column": "Sites Not Backed-up",
                    "type": "Long",
                    "showNumberOps": true,
                    "aggrType": "Sum",
                    "captionPosition": "top",
                    "color": {
                        "captionColor": "#000",
                        "countColor": "#000"
                    },
                    "alignment": "center",
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    },
                    "displayText": "Sites Not Backed-up"
                }
            ],
            "isGroupBy": true,
            "toolTip": "Total number of sites not backed-up in the selected time period",
            "additionalProperties": false
        },
        {
            "type": "HITS",
            "dataSet": {
                "dataSetId": 1504,
                "dataSetName": "SharePoint Clients SLA",
                "dataSetGuid": "f7a2f018-783b-4700-af3f-5430e1be97e1",
                "originalDataSetName": "SharePoint Clients SLA"
            },
            "title": {
                "text": ""
            },
            "id": "Hits1623240735943",
            "mobile": {
                "visible": "On",
                "listItemClick": {},
                "customListLayout": null
            },
            "hideComponent": false,
            "blankComponent": false,
            "filters": {
                "builder": {},
                "viewer": {}
            },
            "visible": {},
            "orientation": "vertical",
            "color": {
                "backgroundColor": "#ffffff"
            },
            "iconPosition": "left",
            "hideHeader": true,
            "measureDataField": [
                {
                    "column": "Sites Backed-up (at least once)",
                    "type": "Long",
                    "showNumberOps": true,
                    "aggrType": "Sum",
                    "captionPosition": "top",
                    "color": {
                        "captionColor": "#000",
                        "countColor": "#000"
                    },
                    "alignment": "center",
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    },
                    "displayText": "Sites Backed-up (at least once)"
                }
            ],
            "isGroupBy": true,
            "toolTip": "Total number of sites backed-up at least once",
            "additionalProperties": false
        },
        {
            "type": "HITS",
            "dataSet": {
                "dataSetId": 1427,
                "dataSetName": "SharePoint Clients SLA",
                "dataSetGuid": "f7a2f018-783b-4700-af3f-5430e1be97e1",
                "originalDataSetName": "SharePoint Clients SLA"
            },
            "title": {
                "text": ""
            },
            "id": "Hits1620294550155",
            "mobile": {
                "visible": "On",
                "listItemClick": {},
                "customListLayout": null
            },
            "hideComponent": false,
            "blankComponent": false,
            "filters": {
                "builder": {},
                "viewer": {}
            },
            "color": {
                "backgroundColor": "#ffffff"
            },
            "iconPosition": "left",
            "hideHeader": true,
            "measureDataField": [
                {
                    "column": "Sites Never Backed-up",
                    "type": "Integer",
                    "showNumberOps": true,
                    "aggrType": "Sum",
                    "captionPosition": "top",
                    "color": {
                        "captionColor": "#000",
                        "countColor": "#000"
                    },
                    "alignment": "center",
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    },
                    "displayText": "Sites Never Backed-up"
                }
            ],
            "isGroupBy": true,
            "toolTip": "Total number of sites never backed-up",
            "additionalProperties": false
        },
        {
            "type": "HITS",
            "dataSet": {
                "dataSetId": 1504,
                "dataSetName": "SharePoint Clients SLA",
                "dataSetGuid": "f7a2f018-783b-4700-af3f-5430e1be97e1",
                "originalDataSetName": "SharePoint Clients SLA"
            },
            "title": {
                "text": ""
            },
            "id": "Hits1623240742862",
            "mobile": {
                "visible": "On",
                "listItemClick": {},
                "customListLayout": null
            },
            "hideComponent": false,
            "blankComponent": false,
            "filters": {
                "builder": {},
                "viewer": {}
            },
            "color": {
                "backgroundColor": "#ffffff"
            },
            "iconPosition": "left",
            "hideHeader": true,
            "measureDataField": [
                {
                    "column": "Sites Recently Added",
                    "type": "Long",
                    "showNumberOps": true,
                    "aggrType": "Sum",
                    "captionPosition": "top",
                    "color": {
                        "captionColor": "#000",
                        "countColor": "#000"
                    },
                    "alignment": "center",
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    },
                    "displayText": "Sites Recently Added"
                }
            ],
            "isGroupBy": true,
            "toolTip": "Sites added in the last 7 days (This is a tentative value and might not be accurate)",
            "additionalProperties": false
        },
        {
            "type": "PANEL",
            "dataSet": {
                "dataSetName": "Clients Index"
            },
            "title": {
                "text": ""
            },
            "id": "PanelComponent1653635107594",
            "hideHeader": true,
            "panelComponents": [
                {
                    "type": "HITS",
                    "dataSet": {
                        "dataSetId": 1500,
                        "dataSetName": "Client Discovery",
                        "dataSetGuid": "f93a5ea9-093f-4233-d693-d40ebd94f124"
                    },
                    "title": {
                        "text": ""
                    },
                    "id": "Hits1653635394864",
                    "isSelected": false,
                    "mobile": {
                        "visible": "On",
                        "listItemClick": {},
                        "customListLayout": null
                    },
                    "layout": {
                        "Hits1653635394864": {
                            "desktop": {
                                "position": {
                                    "0": 0,
                                    "1": 0
                                },
                                "size": {
                                    "x": 4,
                                    "y": 2
                                }
                            }
                        }
                    },
                    "hideComponent": false,
                    "blankComponent": false,
                    "filters": {
                        "builder": {},
                        "viewer": {}
                    },
                    "visible": {},
                    "orientation": "vertical",
                    "color": {
                        "backgroundColor": "#ffffff"
                    },
                    "iconPosition": "left",
                    "hideHeader": true,
                    "measureDataField": [
                        {
                            "column": "Client",
                            "type": "String",
                            "aggrType": "Count",
                            "captionPosition": "top",
                            "color": {
                                "captionColor": "#000",
                                "countColor": "#000"
                            },
                            "alignment": "center",
                            "cellExpression": "",
                            "displayText": "Discovery Needs Attention"
                        }
                    ],
                    "isComponentLoading": false,
                    "isGroupBy": true,
                    "toolTip": "Clients with last discover time older than 7 days"
                },
                {
                    "type": "HITS",
                    "dataSet": {
                        "dataSetId": 1467,
                        "dataSetName": "SharePoint Clients SLA",
                        "dataSetGuid": "f7a2f018-783b-4700-af3f-5430e1be97e1"
                    },
                    "title": {
                        "text": ""
                    },
                    "id": "Hits1653635500585",
                    "isSelected": false,
                    "mobile": {
                        "visible": "On",
                        "listItemClick": {},
                        "customListLayout": null
                    },
                    "layout": {
                        "Hits1653635500585": {
                            "desktop": {
                                "position": {
                                    "0": 0,
                                    "1": 4
                                },
                                "size": {
                                    "x": 4,
                                    "y": 2
                                }
                            }
                        }
                    },
                    "hideComponent": false,
                    "blankComponent": false,
                    "filters": {
                        "builder": {},
                        "viewer": {}
                    },
                    "color": {
                        "backgroundColor": "#ffffff"
                    },
                    "iconPosition": "left",
                    "hideHeader": true,
                    "measureDataField": [
                        {
                            "column": "Sites Need Attention",
                            "type": "Integer",
                            "showNumberOps": true,
                            "aggrType": "Sum",
                            "captionPosition": "top",
                            "color": {
                                "captionColor": "#000",
                                "countColor": "#000"
                            },
                            "alignment": "center",
                            "cellExpression": "",
                            "displayText": "Sites Needs Attention"
                        }
                    ],
                    "isComponentLoading": false,
                    "isGroupBy": true,
                    "visible": {},
                    "orientation": "vertical",
                    "toolTip": "Sites associated to the client for at least more than 7 days and are never backed-up"
                },
                {
                    "type": "HITS",
                    "dataSet": {
                        "dataSetId": 1501,
                        "dataSetName": "Clients Index",
                        "dataSetGuid": "593104f5-8de4-4c42-e33f-97277a7abf34"
                    },
                    "title": {
                        "text": ""
                    },
                    "id": "Hits1653635515411",
                    "isSelected": false,
                    "mobile": {
                        "visible": "On",
                        "listItemClick": {},
                        "customListLayout": null
                    },
                    "layout": {
                        "Hits1653635515411": {
                            "desktop": {
                                "position": {
                                    "0": 0,
                                    "1": 8
                                },
                                "size": {
                                    "x": 4,
                                    "y": 2
                                }
                            }
                        }
                    },
                    "hideComponent": false,
                    "blankComponent": false,
                    "filters": {
                        "builder": {},
                        "viewer": {}
                    },
                    "visible": {},
                    "orientation": "vertical",
                    "color": {
                        "backgroundColor": "#ffffff"
                    },
                    "iconPosition": "left",
                    "hideHeader": true,
                    "measureDataField": [
                        {
                            "column": "Client",
                            "type": "String",
                            "aggrType": "Count",
                            "captionPosition": "top",
                            "color": {
                                "captionColor": "#000",
                                "countColor": "#000"
                            },
                            "alignment": "center",
                            "cellExpression": "",
                            "displayText": "Index Needs Attention"
                        }
                    ],
                    "isComponentLoading": false,
                    "isGroupBy": true,
                    "toolTip": "Clients with last playback time older than 7 days"
                }
            ],
            "mobile": {
                "visible": "On",
                "listItemClick": {},
                "customListLayout": null
            },
            "hideComponent": false,
            "blankComponent": false,
            "filters": {
                "builder": {},
                "viewer": {}
            },
            "visible": {
                "type": "custom",
                "expression": "=(cv.isAdminOnCommcellLevel || cv.isMspAdmin || cv.isMspUser)"
            },
            "layout": []
        },
        {
            "type": "TABLE",
            "dataSet": {
                "dataSetId": 1427,
                "dataSetName": "SharePoint Clients SLA",
                "dataSetGuid": "f7a2f018-783b-4700-af3f-5430e1be97e1"
            },
            "title": {
                "text": "SharePoint Clients"
            },
            "id": "Table1620183396519",
            "pageSize": "10",
            "columns": [
                {
                    "dataField": "sys_rowid",
                    "displayName": "sys_rowid",
                    "id": "sys_rowid",
                    "type": "Long",
                    "origType": "String",
                    "visible": true,
                    "hidden": true,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Data Source",
                    "displayName": "CommCell",
                    "id": "DataSource",
                    "type": "String",
                    "origType": "String",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true
                },
                {
                    "dataField": "Client",
                    "displayName": "Client",
                    "id": "Client",
                    "type": "String",
                    "origType": "",
                    "visible": true,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": ":=\nvar redirectURL = customReports.appName === \"webconsole\" ? ( location.origin + '/adminconsole/' + row['clienturl'] ) : row['clienturl']\nreturn '&lt;a href=\"'+redirectURL+'\"&gt;'+cellData+'&lt;/a&gt;'"
                },
                {
                    "dataField": "Client Status",
                    "displayName": "Client Status",
                    "id": "ClientStatus",
                    "type": "String",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Index Status",
                    "displayName": "Index Status",
                    "id": "IndexStatus",
                    "type": "String",
                    "origType": "String",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Last Indexed Backup JobId",
                    "displayName": "Last indexed backup jobid",
                    "id": "Lastindexedbackupjobid",
                    "type": "String",
                    "origType": "String",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": ":=\nvar redirectURL = customReports.appName === \"webconsole\" ? ( location.origin + '/adminconsole/' + row['joburl'] ) : row['joburl']\nreturn '&lt;a href=\"'+redirectURL+'\"&gt;'+cellData+'&lt;/a&gt;'"
                },
                {
                    "dataField": "Last Index Time",
                    "displayName": "Last index time",
                    "id": "Lastindextime",
                    "type": "TimeStamp",
                    "origType": "String",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Last Index Error Time",
                    "displayName": "Last index error time",
                    "id": "Lastindexerrortime",
                    "type": "TimeStamp",
                    "origType": "String",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Last Discovery Time",
                    "displayName": "Last discovery time",
                    "id": "Lastdiscoverytime",
                    "type": "TimeStamp",
                    "origType": "TimeStamp",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Last Backup Run Time",
                    "displayName": "Last Backup Run Time",
                    "id": "LastBackupRunTime",
                    "type": "TimeStamp",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Last Backup Job ID",
                    "displayName": "Last Backup Job ID",
                    "id": "LastBackupJobID",
                    "type": "String",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": ":=\nvar redirectURL = customReports.appName === \"webconsole\" ? ( location.origin + '/adminconsole/' + row['backupjoburl'] ) : row['backupjoburl']\nreturn '&lt;a href=\"'+redirectURL+'\"&gt;'+cellData+'&lt;/a&gt;'"
                },
                {
                    "dataField": "Associated Sites",
                    "displayName": "Associated Sites",
                    "id": "AssociatedSites",
                    "type": "Long",
                    "origType": "",
                    "visible": true,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    }
                },
                {
                    "dataField": "Sites Backed-up",
                    "displayName": "Sites Backed-up",
                    "id": "SitesBackedup",
                    "type": "Long",
                    "origType": "",
                    "visible": true,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    }
                },
                {
                    "dataField": "Sites Not Backed-up",
                    "displayName": "Sites Not Backed-up",
                    "id": "SitesNotBackedup",
                    "type": "Long",
                    "origType": "",
                    "visible": true,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    }
                },
                {
                    "dataField": "Sites Never Backed-up",
                    "displayName": "Sites Never Backed-up",
                    "id": "SitesNeverBackedup",
                    "type": "Integer",
                    "origType": "",
                    "visible": true,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    }
                },
                {
                    "dataField": "Sites Backed-up (at least once)",
                    "displayName": "Sites Backed-up (at least once)",
                    "id": "SitesBackedupatleastonce",
                    "type": "Long",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Sites Recently Added",
                    "displayName": "Sites Recently Added",
                    "id": "SitesRecentlyAdded",
                    "type": "Long",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Sites Need Attention",
                    "displayName": "Sites Need Attention",
                    "id": "SitesNeedAttention",
                    "type": "Integer",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Application Size",
                    "displayName": "Application Size",
                    "id": "ApplicationSize",
                    "type": "Long",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": {
                        "type": "size",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    }
                },
                {
                    "dataField": "Number of Items",
                    "displayName": "Number of Items",
                    "id": "NumberofItems",
                    "type": "Long",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    }
                },
                {
                    "dataField": "Indexed Items",
                    "displayName": "Indexed Items",
                    "id": "IndexedItems",
                    "type": "Long",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    }
                },
                {
                    "dataField": "Azure Apps Associated",
                    "displayName": "Azure Apps Associated",
                    "id": "AzureAppsAssociated",
                    "type": "Integer",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Azure Apps Not Authorized",
                    "displayName": "Azure Apps Not Authorized",
                    "id": "AzureAppsNotAuthorized",
                    "type": "Integer",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Azure Apps To Be Added",
                    "displayName": "Azure Apps To Be Added",
                    "id": "AzureAppsToBeAdded",
                    "type": "Integer",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Last Verify Connection Time",
                    "displayName": "Last Verify Connection Time",
                    "id": "LastVerifyConnectionTime",
                    "type": "TimeStamp",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Max Streams",
                    "displayName": "Max Streams",
                    "id": "MaxStreams",
                    "type": "Integer",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Access Node Group",
                    "displayName": "Access Node Group",
                    "id": "AccessNodeGroup",
                    "type": "String",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": ":=\nif ((cv.isAdminOnCommcellLevel || cv.isMspAdmin || cv.isMspUser) &amp;&amp; cellData !== \"\")\n{\n\tvar redirectURL = customReports.appName === \"webconsole\" ? ( location.origin + '/adminconsole/' + row['accessNodeGroupUrl'] ) : row['accessNodeGroupUrl']\n\treturn '&lt;a href=\"'+redirectURL+'\"&gt;'+cellData+'&lt;/a&gt;'\n}\nelse\n{\n    return \"N/A\"\n}"
                },
                {
                    "dataField": "Index Server",
                    "displayName": "Index Server",
                    "id": "IndexServer",
                    "type": "String",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": ":=\nif ((cv.isAdminOnCommcellLevel || cv.isMspAdmin || cv.isMspUser) &amp;&amp; cellData !== \"\")\n{\n\tvar redirectURL = customReports.appName === \"webconsole\" ? ( location.origin + '/adminconsole/' + row['indexserverurl'] ) : row['indexserverurl']\n\treturn '&lt;a href=\"'+redirectURL+'\"&gt;'+cellData+'&lt;/a&gt;'\n}\nelse\n{\n    return \"N/A\"\n}"
                },
                {
                    "dataField": "Active Jobs",
                    "displayName": "Active Jobs",
                    "id": "ActiveJobs",
                    "type": "String",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": ":=\nvar redirectURL = customReports.appName === \"webconsole\" ? ( location.origin + '/adminconsole/' + row['activejobsurl'] ) : row['activejobsurl']\nreturn '&lt;a href=\"'+redirectURL+'\"&gt;'+cellData+'&lt;/a&gt;'"
                },
                {
                    "dataField": "joburl",
                    "displayName": "joburl",
                    "id": "joburl",
                    "type": "String",
                    "origType": "String",
                    "visible": true,
                    "hidden": true,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": false
                },
                {
                    "dataField": "backupjoburl",
                    "displayName": "backupjoburl",
                    "id": "backupjoburl",
                    "type": "String",
                    "origType": "",
                    "visible": true,
                    "hidden": true,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": false
                },
                {
                    "dataField": "clienturl",
                    "displayName": "clienturl",
                    "id": "clienturl",
                    "type": "String",
                    "origType": "",
                    "visible": true,
                    "hidden": true,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": false
                },
                {
                    "dataField": "activejobsurl",
                    "displayName": "activejobsurl",
                    "id": "activejobsurl",
                    "type": "String",
                    "origType": "",
                    "visible": true,
                    "hidden": true,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": false
                },
                {
                    "dataField": "accessNodeGroupUrl",
                    "displayName": "accessNodeGroupUrl",
                    "id": "accessNodeGroupUrl",
                    "type": "String",
                    "origType": "",
                    "visible": true,
                    "hidden": true,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": false
                },
                {
                    "dataField": "indexserverurl",
                    "displayName": "indexserverurl",
                    "id": "indexserverurl",
                    "type": "String",
                    "origType": "",
                    "visible": true,
                    "hidden": true,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": false
                }
            ],
            "allColumns": true,
            "dataSetName": "",
            "styles": {
                "chartPlotOptions": {
                    "isShowGridlines": true,
                    "isSmoothLines": true,
                    "isShowLineMarkers": true,
                    "autoConvertYValues": true,
                    "isShowLabels": false,
                    "legendPosition": "right"
                }
            },
            "mobile": {
                "visible": "On",
                "listItemClick": {},
                "customListLayout": null
            },
            "hideComponent": false,
            "blankComponent": false,
            "filters": {
                "builder": {},
                "viewer": {}
            },
            "visible": {},
            "orientation": "vertical",
            "showFilterByDefault": false,
            "enableHorizontalScroll": false
        },
        {
            "type": "TABLE",
            "dataSet": {
                "dataSetName": "SharePoint Sites SLA",
                "dataSetGuid": "a8b5d60e-9405-41a3-c838-6f0d5152e0cd",
                "originalDataSetName": ""
            },
            "title": {
                "text": ":= return (rpt.input.Options === 'Show all sites' ? 'Sites' : 'Sites Not Backed-up')"
            },
            "id": "Table1617968558846",
            "pageSize": 20,
            "columns": [
                {
                    "dataField": "sys_rowid",
                    "displayName": "sys_rowid",
                    "id": "sys_rowid",
                    "type": "Long",
                    "origType": "String",
                    "visible": true,
                    "hidden": true,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Data Source",
                    "displayName": "CommCell",
                    "id": "DataSource",
                    "type": "String",
                    "origType": "String",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true
                },
                {
                    "dataField": "Name",
                    "displayName": "Name",
                    "id": "Name",
                    "type": "Integer",
                    "origType": "String",
                    "visible": true,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Site URL",
                    "displayName": "Site URL",
                    "id": "SiteURL",
                    "type": "Integer",
                    "origType": "String",
                    "visible": true,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Last Backup",
                    "displayName": "Last backup",
                    "id": "Lastbackup",
                    "type": "Integer",
                    "origType": "String",
                    "visible": true,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Last Backup Status",
                    "displayName": "Last Backup Status",
                    "id": "LastBackupStatus",
                    "type": "Integer",
                    "origType": "",
                    "visible": true,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Failure Reason",
                    "displayName": "Failure Reason",
                    "id": "FailureReason",
                    "type": "Integer",
                    "origType": "String",
                    "visible": true,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Last Backup Attempt",
                    "displayName": "Last backup attempt",
                    "id": "Lastbackupattempt",
                    "type": "Integer",
                    "origType": "TimeStamp",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Last Backup Attempt JobId",
                    "displayName": "Last Backup Attempt JobId",
                    "id": "LastBackupAttemptJobId",
                    "type": "Integer",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Client",
                    "displayName": "Client",
                    "id": "Client",
                    "type": "Integer",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Added to content on",
                    "displayName": "Added to content on",
                    "id": "Addedtocontenton",
                    "type": "Integer",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Backup Size",
                    "displayName": "Backup Size",
                    "id": "BackupSize",
                    "type": "Integer",
                    "origType": "",
                    "visible": true,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": {
                        "type": "size",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    }
                },
                {
                    "dataField": "Number Of Items",
                    "displayName": "Number Of Items",
                    "id": "NumberOfItems",
                    "type": "Integer",
                    "origType": "",
                    "visible": true,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    }
                },
                {
                    "dataField": "Failed Items",
                    "displayName": "Failed Items",
                    "id": "FailedItems",
                    "type": "Integer",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    }
                }
            ],
            "allColumns": true,
            "dataSetName": "",
            "styles": {
                "chartPlotOptions": {
                    "isShowGridlines": true,
                    "isSmoothLines": true,
                    "isShowLineMarkers": true,
                    "autoConvertYValues": true,
                    "isShowLabels": false,
                    "legendPosition": "right"
                }
            },
            "mobile": {
                "visible": "On",
                "listItemClick": {},
                "customListLayout": null
            },
            "hideComponent": false,
            "blankComponent": false,
            "filters": {
                "builder": {},
                "viewer": {}
            },
            "showFilterByDefault": false,
            "enableHorizontalScroll": false,
            "visible": {
                "type": "custom",
                "expression": "=!((rpt.input.SharePointClients == \"\" || rpt.input.SharePointClients == \"[]\") &amp;&amp; (rpt.input.ClientGroups == \"\" || rpt.input.ClientGroups == \"[]\"))"
            },
            "orientation": "vertical"
        }
    ],
    "filters": {
        "builder": {},
        "viewer": {}
    },
    "autoRefreshTime": 10,
    "reportLayout": {
        "gridsterOpts": {
            "columns": 12
        },
        "Table1617968558846": {
            "mobile": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    17,
                    0
                ]
            },
            "tablet": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    17,
                    0
                ]
            },
            "desktop": {
                "size": {
                    "x": 12,
                    "y": 3
                },
                "position": [
                    16,
                    0
                ]
            }
        },
        "Table1620183396519": {
            "mobile": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    8,
                    0
                ]
            },
            "tablet": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    8,
                    0
                ]
            },
            "desktop": {
                "size": {
                    "x": 12,
                    "y": 9
                },
                "position": [
                    7,
                    0
                ]
            }
        },
        "Hits1620294531572": {
            "mobile": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    0,
                    0
                ]
            },
            "tablet": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    0,
                    0
                ]
            },
            "desktop": {
                "size": {
                    "x": 4,
                    "y": 2
                },
                "position": [
                    0,
                    0
                ]
            }
        },
        "Hits1620294540499": {
            "mobile": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    0,
                    3
                ]
            },
            "tablet": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    0,
                    3
                ]
            },
            "desktop": {
                "size": {
                    "x": 4,
                    "y": 2
                },
                "position": [
                    0,
                    4
                ]
            }
        },
        "Hits1620294545720": {
            "mobile": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    0,
                    6
                ]
            },
            "tablet": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    0,
                    6
                ]
            },
            "desktop": {
                "size": {
                    "x": 4,
                    "y": 2
                },
                "position": [
                    0,
                    8
                ]
            }
        },
        "Hits1620294550155": {
            "mobile": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    0,
                    9
                ]
            },
            "tablet": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    0,
                    9
                ]
            },
            "desktop": {
                "size": {
                    "x": 4,
                    "y": 2
                },
                "position": [
                    2,
                    4
                ]
            }
        },
        "Hits1623240735943": {
            "mobile": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    2,
                    0
                ]
            },
            "tablet": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    2,
                    0
                ]
            },
            "desktop": {
                "size": {
                    "x": 4,
                    "y": 2
                },
                "position": [
                    2,
                    0
                ]
            }
        },
        "Hits1623240742862": {
            "mobile": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    2,
                    8
                ]
            },
            "tablet": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    2,
                    8
                ]
            },
            "desktop": {
                "size": {
                    "x": 4,
                    "y": 2
                },
                "position": [
                    2,
                    8
                ]
            }
        },
        "PanelComponent1653635107594": {
            "mobile": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    4,
                    0
                ]
            },
            "tablet": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    4,
                    0
                ]
            },
            "desktop": {
                "size": {
                    "x": 12,
                    "y": 3
                },
                "position": [
                    4,
                    0
                ]
            }
        }
    }
}</body>
      <footer />
    </Page>
    <Page>
      <pageName>Teams</pageName>
      <isDefault>false</isDefault>
      <pageTitle>
        <text>Teams</text>
      </pageTitle>
      <dataSets>
        <dataSet>
          <DataSet>
            <dataSet>
              <dataSetName>Teams Clients</dataSetName>
              <dataSetGuid>8d70c30b-dd2e-46af-ede9-baa4f02624cd</dataSetGuid>
            </dataSet>
            <endpoint>DATABASE</endpoint>
            <shared>false</shared>
            <dataSources>
              <DataSource>
                <connectionType>COMMCELL</connectionType>
                <endpoint>DATABASE</endpoint>
                <commCell>
                  <commCellName>$ALL$</commCellName>
                </commCell>
              </DataSource>
            </dataSources>
            <allColumns>false</allColumns>
            <fields>
              <Column>
                <name>sys_rowid</name>
                <dataField>$row_number$</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Data Source</name>
                <dataField>Data Source</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>id</name>
                <dataField>id</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>displayName</name>
                <dataField>displayName</dataField>
                <type>String</type>
              </Column>
            </fields>
            <GetOperation>
              <parameters />
              <sqlText>DECLARE @CV_APPTYPE_CLOUDAPPS INT = 134
DECLARE @TEAMS_INSTANCE INT = 36

-- variables
DECLARE @userId INT
DECLARE @companyId INT
DECLARE @clientIds TABLE (clientId INT)

-- read inputs
SELECT @userId = id FROM UMUsers WHERE login = @sys_username
SET @companyId = dbo.AppGetOrganizationForUser(@userId)

IF @companyId &gt; 0
			BEGIN
				DECLARE @OrgClients table (clientId INT,  tenantId INT , tenant nvarchar(40))            
				
				INSERT INTO @OrgClients 
				SELECT A.clientId, D.id , D.domainName
				from APP_ClientGroupAssoc A WITH (NOLOCK)
				JOIN APP_ClientGroup B WITH (NOLOCK) ON A.clientGroupId = B.id 
				JOIN App_CompanyProp C WITH (NOLOCK) ON C.attrName = 'Associated Smart Client Group' AND CAST(A.clientGroupId AS nvarchar(MAX)) = C.attrVal AND C.modIFied = 0
				JOIN UMDSProviders D WITH (NOLOCK) ON C.componentNameId = D.id
				WHERE (C.componentNameId = @companyId) AND  B.flag&amp;0x1000 &gt; 0

				INSERT INTO @clientIds (clientId) SELECT clientId FROM @OrgClients
			END
		ELSE
			BEGIN
				IF OBJECT_ID('tempdb.dbo.#temp_clientIds') IS NOT NULL
					DROP TABLE #temp_clientIds

				CREATE TABLE #temp_clientIds
				(
					clientId            INT,
					appTypeId           INT,
					instanceId          INT,
					backupsetId         INT,
					subclientId         INT
				)

				EXEC sec_getIdaObjectsForUser @userId, 3/*Client Entity*/, 0, 0, '#temp_clientIds', 1

				INSERT INTO @clientIds (clientId) SELECT clientId FROM #temp_clientIds
			END

DELETE FROM @clientIds WHERE clientId NOT IN 
(SELECT DISTINCT clientId FROM APP_Application AA WITH (NOLOCK)
INNER JOIN App_InstanceProp AI WITH (NOLOCK) ON AA.instance = AI.componentNameId
WHERE appTypeId = @CV_APPTYPE_CLOUDAPPS AND attrName = 'Cloud Apps Instance Type' AND attrVal = @TEAMS_INSTANCE
AND subclientStatus &amp; 0x04 != 0x04 /*DELETED*/ AND subclientStatus &amp; 0x00020 != 0x00020 /*HIDDEN*/)

DELETE FROM @clientIds
WHERE clientId NOT IN 
(SELECT componentNameId FROM App_ClientProp WITH (NOLOCK) WHERE attrName = 'Office 365 Pseudo Client' AND attrVal = 1 /*V2 client*/ AND modified = 0
AND componentNameId IN (SELECT clientId FROM @clientIds))

SELECT id, displayName FROM APP_Client WITH (NOLOCK) WHERE id IN (select clientId FROM @clientIds) AND specialClientFlags &amp; 0x02 &lt;&gt; 0 /*Pseudo client*/


IF OBJECT_ID('tempdb.dbo.#temp_clientIds') IS NOT NULL
	DROP TABLE #temp_clientIds</sqlText>
              <timeout>5</timeout>
              <postQueryFilter>true</postQueryFilter>
              <rDataSetQuery />
              <rPlotQuery />
            </GetOperation>
            <description>Backup Health Report for Office 365 Clients.</description>
            <databaseName>CommServ</databaseName>
            <queryPlan>
              <offline>false</offline>
              <collectionType>HTTP</collectionType>
              <retentionDays>1</retentionDays>
              <versions>
                <CommCellVersion>ALL</CommCellVersion>
              </versions>
              <dynamicCollection>false</dynamicCollection>
              <frequency>60</frequency>
              <direct>false</direct>
            </queryPlan>
            <version>144</version>
            <guid>8d70c30b-dd2e-46af-ede9-baa4f02624cd</guid>
            <hidden>true</hidden>
            <revision />
            <computedColumns>
              <scriptName>R</scriptName>
              <script />
              <columnList />
            </computedColumns>
          </DataSet>
          <DataSet>
            <dataSet>
              <dataSetName>Teams Groups</dataSetName>
              <dataSetGuid>d01d625c-b2a5-4aaa-9e04-fff93e3f365a</dataSetGuid>
            </dataSet>
            <endpoint>DATABASE</endpoint>
            <shared>false</shared>
            <dataSources>
              <DataSource>
                <connectionType>COMMCELL</connectionType>
                <endpoint>DATABASE</endpoint>
                <commCell>
                  <commCellName>$ALL$</commCellName>
                </commCell>
              </DataSource>
            </dataSources>
            <allColumns>false</allColumns>
            <fields>
              <Column>
                <name>sys_rowid</name>
                <dataField>$row_number$</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Data Source</name>
                <dataField>Data Source</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>groupId</name>
                <dataField>groupId</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>groupName</name>
                <dataField>groupName</dataField>
                <type>String</type>
              </Column>
            </fields>
            <GetOperation>
              <parameters />
              <sqlText>SET NOCOUNT ON
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED

DECLARE	@UserId		INT 
DECLARE @CV_APPTYPE_EXCHANGE_ONEPASS INT = 137
SELECT	@UserId = id FROM UMUsers WHERE login = @sys_username

DECLARE @CV_FLAG_COMMCELL_GROUP VARBINARY(8) = 0x40000
DECLARE	@ObjectType	INT = 2572		-- SERVER_GROUP_NAME_ITEM

IF OBJECT_ID('tempdb.dbo.#UserObjects') IS NOT NULL
	DROP TABLE #UserObjects

create table  #UserObjects ( 
	[capabilities]  bigint	NOT null, 
	[flag]			int NOT null default 0, 
	[commCellId]    int	NOT null default 2, 
	[clientGroupId] int	NOT null default 0, 
	[clientId]      int	NOT null default 0, 
	[appTypeId]     int	NOT null default 0, 
	[instanceId]    int	NOT null default 0, 
	[backupsetId]   int	NOT null default 0, 
	[subClientId]   int	NOT null default 0, 
	[mediaAgentId]  int	NOT null default 0, 
	[libraryId]     int	NOT null default 0, 
	[archGroupId]   int	NOT null default 0, 
	[vtContainerId] int	NOT null default 0, 
	[vtPolicyId]    int	NOT null default 0, 
	[vtShelfId]     int	NOT null default 0, 
	[reviewSetId]   int	NOT null default 0, 
	[querySetId]	int	NOT null default 0, 
	[downloadSetId] int	NOT null default 0, 
	[ermId]   		int	NOT null default 0, 
	[legalHoldId]   int	NOT null default 0, 
	[tagId]			int	NOT null default 0, 
	[cdPolicyId]    int	NOT null default 0, 
	[complianceReportId]   int	NOT null default 0, 
	[taskId]        int	NOT null default 0, 
	[workflowId]    int	NOT null default 0, 
	[logMonitoringPolicyId] int	NOT null default 0, 
	[arrayId]       int	NOT null default 0, 
	[cloudId]       int	NOT null default 0, 
	[userGroupId]   int	NOT null default 0, 
	[providerId]    int	NOT null default 0, 
	[entityId1]     int	NOT null default 0, 
	[entityId2]     int	NOT null default 0, 
	[entityId3]     int	NOT null default 0, 
	[entityId4]     int	NOT null default 0, 
	[entityId5]     int	NOT null default 0, 
	[entityId6]     int	NOT null default 0, 
	[entityId7]     int	NOT null default 0, 
	[entityId8]     int	NOT null default 0, 
	[entityId9]     int	NOT null default 0  )

EXEC sec_getUserObjects @UserId, @ObjectType, 0, '#UserObjects'

DECLARE @clientGroups TABLE (groupId INT, groupName NVARCHAR(255))

IF EXISTS (SELECT * FROM #UserObjects WHERE commCellId = 2 AND clientGroupId = 0)
	INSERT INTO @clientGroups (groupId, groupName)
	SELECT	CG.id, CG.name
	FROM	APP_ClientGroup CG WITH (NOLOCK)
        WHERE CG.Flag &amp; @CV_FLAG_COMMCELL_GROUP = 0
ELSE
	INSERT INTO @clientGroups (groupId, groupName)
	SELECT	CG.id, CG.name
	FROM	#UserObjects O
			INNER JOIN APP_ClientGroup CG WITH (NOLOCK) ON O.clientGroupId = CG.id 
        AND CG.Flag &amp; @CV_FLAG_COMMCELL_GROUP = 0
	WHERE	O.commCellId = 2 AND O.clientGroupId &gt; 0

SELECT groupId, groupName FROM @clientGroups WHERE groupId IN (SELECT DISTINCT clientGroupId FROM App_ClientGroupAssoc WITH (NOLOCK) WHERE clientId in (
SELECT id FROM App_Client WITH (NOLOCK) WHERE id IN (SELECT DISTINCT clientId FROM APP_Application WITH (NOLOCK)
WHERE subclientStatus &amp; 0x04 != 0x04 /*DELETED*/ AND subclientStatus &amp; 0x00020 != 0x00020 /*HIDDEN*/)
AND specialClientFlags &amp; 0x02 &lt;&gt; 0 /*Pseudo client*/))

IF OBJECT_ID('tempdb.dbo.#UserObjects') IS NOT NULL
	DROP TABLE #UserObjects</sqlText>
              <timeout>5</timeout>
              <postQueryFilter>true</postQueryFilter>
              <rDataSetQuery />
              <rPlotQuery />
            </GetOperation>
            <description>Backup Health Report for Office 365 Clients.</description>
            <databaseName>CommServ</databaseName>
            <queryPlan>
              <offline>false</offline>
              <collectionType>HTTP</collectionType>
              <retentionDays>1</retentionDays>
              <versions>
                <CommCellVersion>ALL</CommCellVersion>
              </versions>
              <dynamicCollection>false</dynamicCollection>
              <frequency>60</frequency>
              <direct>false</direct>
            </queryPlan>
            <version>144</version>
            <guid>d01d625c-b2a5-4aaa-9e04-fff93e3f365a</guid>
            <hidden>true</hidden>
            <revision />
            <computedColumns>
              <scriptName>R</scriptName>
              <script />
              <columnList />
            </computedColumns>
          </DataSet>
          <DataSet>
            <dataSet>
              <dataSetName>Teams Clients SLA</dataSetName>
              <dataSetGuid>6c4a4208-f3b3-408d-8ff0-3be774080b0b</dataSetGuid>
            </dataSet>
            <endpoint>DATABASE</endpoint>
            <shared>false</shared>
            <dataSources>
              <DataSource>
                <connectionType>COMMCELL</connectionType>
                <endpoint>DATABASE</endpoint>
                <commCell>
                  <commCellName>$ALL$</commCellName>
                </commCell>
              </DataSource>
            </dataSources>
            <allColumns>false</allColumns>
            <fields>
              <Column>
                <name>sys_rowid</name>
                <dataField>$row_number$</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Data Source</name>
                <dataField>Data Source</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Client</name>
                <dataField>Client</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Client Status</name>
                <dataField>Client Status</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Index Status</name>
                <dataField>Index Status</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Last Indexed Backup JobId</name>
                <dataField>Last Indexed Backup JobId</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Last Index Time</name>
                <dataField>Last Index Time</dataField>
                <type>TimeStamp</type>
              </Column>
              <Column>
                <name>Last Index Error Time</name>
                <dataField>Last Index Error Time</dataField>
                <type>TimeStamp</type>
              </Column>
              <Column>
                <name>Last Discovery Time</name>
                <dataField>Last Discovery Time</dataField>
                <type>TimeStamp</type>
              </Column>
              <Column>
                <name>Last Backup Run Time</name>
                <dataField>Last Backup Run Time</dataField>
                <type>TimeStamp</type>
              </Column>
              <Column>
                <name>Last Backup Job ID</name>
                <dataField>Last Backup Job ID</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Associated Teams</name>
                <dataField>Associated Teams</dataField>
                <type>Long</type>
              </Column>
              <Column>
                <name>Teams Backed-up</name>
                <dataField>Teams Backed-up</dataField>
                <type>Long</type>
              </Column>
              <Column>
                <name>Teams Not Backed-up</name>
                <dataField>Teams Not Backed-up</dataField>
                <type>Long</type>
              </Column>
              <Column>
                <name>Teams Never Backed-up</name>
                <dataField>Teams Never Backed-up</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Teams Backed-up (at least once)</name>
                <dataField>Teams Backed-up (at least once)</dataField>
                <type>Long</type>
              </Column>
              <Column>
                <name>Teams Recently Added</name>
                <dataField>Teams Recently Added</dataField>
                <type>Long</type>
              </Column>
              <Column>
                <name>Teams Need Attention</name>
                <dataField>Teams Need Attention</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Application Size</name>
                <dataField>Application Size</dataField>
                <type>Long</type>
              </Column>
              <Column>
                <name>Number of Items</name>
                <dataField>Number of Items</dataField>
                <type>Long</type>
              </Column>
              <Column>
                <name>Indexed Items</name>
                <dataField>Indexed Items</dataField>
                <type>Long</type>
              </Column>
              <Column>
                <name>Azure Apps Associated</name>
                <dataField>Azure Apps Associated</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Azure Apps Not Authorized</name>
                <dataField>Azure Apps Not Authorized</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Azure Apps To Be Added</name>
                <dataField>Azure Apps To Be Added</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Last Verify Connection Time</name>
                <dataField>Last Verify Connection Time</dataField>
                <type>TimeStamp</type>
              </Column>
              <Column>
                <name>Max Streams</name>
                <dataField>Max Streams</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Access Node Group</name>
                <dataField>Access Node Group</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Index Server</name>
                <dataField>Index Server</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Active Jobs</name>
                <dataField>Active Jobs</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>joburl</name>
                <dataField>joburl</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>backupjoburl</name>
                <dataField>backupjoburl</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>clienturl</name>
                <dataField>clienturl</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>activejobsurl</name>
                <dataField>activejobsurl</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>accessNodeGroupUrl</name>
                <dataField>accessNodeGroupUrl</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>indexserverurl</name>
                <dataField>indexserverurl</dataField>
                <type>String</type>
              </Column>
            </fields>
            <GetOperation>
              <parameters>
                <Parameter>
                  <name>Clients</name>
                  <dataType>Integer</dataType>
                  <isList>true</isList>
                  <values>
                    <string>=input.TeamsClients</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>ClientGroups</name>
                  <dataType>Integer</dataType>
                  <isList>true</isList>
                  <values>
                    <string>=input.ClientGroups</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>timeframe</name>
                  <dataType>DateRange</dataType>
                  <values>
                    <string>=input.Timeframe</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>Options</name>
                  <dataType>String</dataType>
                  <isList>true</isList>
                  <values>
                    <string>=input.Options</string>
                  </values>
                </Parameter>
              </parameters>
              <sqlText>-- constants

DECLARE @CV_APPTYPE_CLOUD_APPS INT = 134

DECLARE @TEAMS_INSTANCE INT = 36

DECLARE @DISCOVERTYPE_TEAM INT = 12

DECLARE @MAX_USERS_FOR_FIVE_CONNECTIONS INT = 10000

DECLARE @TENANT_DIACTIVEVATED INT = 101

DECLARE @LICENSE_RELEASED INT = 102

DECLARE @EXCLUDED_FROM_SLA INT = 103



-- variables

DECLARE @userId INT = (SELECT TOP 1 id FROM UMUsers WITH (NOLOCK) WHERE login = @sys_username)

DECLARE @companyId INT

DECLARE @includeBackupDisabledClients INT = 0



DECLARE @recentlyAddedNumberOfDays INT = 7

DECLARE @recentlyAddedRefTime INT = dbo.getunixtime(DATEADD(HOUR, -@recentlyAddedNumberOfDays*24 , GETUTCDATE()))



IF OBJECT_ID('tempdb.dbo.#listClientIds_Teams') IS NOT NULL

	DROP TABLE #listClientIds_Teams



CREATE TABLE #listClientIds_Teams (clientId INT, subclientId INT, backupsetId INT, instanceId INT, isBackupDisabled INT DEFAULT 0)

CREATE NONCLUSTERED INDEX #listClientIds_Teams_c_s_b_i_ids ON #listClientIds_Teams(clientId, subclientId, backupsetId, instanceId)



-- read inputs

SET @companyId = dbo.AppGetOrganizationForUser(@userId)



IF OBJECT_ID('tempdb.dbo.#temp__clientIds') IS NOT NULL

	DROP TABLE #temp__clientIds



CREATE TABLE #temp__clientIds

(

	clientId            INT,

	appTypeId           INT,

	instanceId          INT,

	backupsetId         INT,

	subclientId         INT

)



IF NOT EXISTS (SELECT Clients FROM @Clients) AND NOT EXISTS (SELECT ClientGroups FROM @ClientGroups)

BEGIN 

	IF @companyId &gt; 0

	BEGIN

		INSERT INTO #temp__clientIds (clientId)

		SELECT DISTINCT CGA.clientId

		FROM UMDSProviders UMDS WITH (NOLOCK)

		JOIN App_CompanyProp CP WITH (NOLOCK) ON CP.attrName = 'Associated Smart Client Group' AND CP.modified = 0

		JOIN APP_ClientGroupAssoc CGA WITH (NOLOCK) ON CAST(CGA.clientGroupId AS NVARCHAR(16)) = CP.attrVal

		JOIN APP_ClientGroup CG WITH (NOLOCK) ON CGA.clientGroupId = CG.id

		WHERE CP.componentNameId = @companyId AND CG.flag &amp; 0x1000 &gt; 0



		-- include clients belongs to logged in users company

		INSERT INTO #listClientIds_Teams (clientId)

		SELECT DISTINCT TC.clientId

		FROM #temp__clientIds TC

		INNER JOIN APP_Application AA WITH (NOLOCK) ON TC.clientId = AA.clientId

		WHERE AA.appTypeId = @CV_APPTYPE_CLOUD_APPS AND subclientStatus &amp; 0x04 != 0x04 /*DELETED*/ AND subclientStatus &amp; 0x00020 != 0x00020 /*HIDDEN*/

	END

	ELSE

	BEGIN

		EXEC sec_getIdaObjectsForUser @userId, 3 /*Client Entity*/, 0, 0, '#temp__clientIds', 1



		-- include all clients user has access to

		INSERT INTO #listClientIds_Teams (clientId)

		SELECT DISTINCT TC.clientId

		FROM #temp__clientIds TC

		INNER JOIN APP_Application AA WITH (NOLOCK) ON TC.clientId = AA.clientId

		WHERE AA.appTypeId = @CV_APPTYPE_CLOUD_APPS AND subclientStatus &amp; 0x04 != 0x04 /*DELETED*/ AND subclientStatus &amp; 0x00020 != 0x00020 /*HIDDEN*/

	END

END

ELSE

BEGIN

	INSERT INTO #listClientIds_Teams (clientId)

	SELECT DISTINCT Clients FROM @Clients

	UNION

	SELECT DISTINCT CG.clientId FROM App_ClientGroupAssoc CG WITH (NOLOCK)

	INNER JOIN APP_Application AA WITH (NOLOCK) ON CG.clientId = AA.clientId AND AA.appTypeId = @CV_APPTYPE_CLOUD_APPS

	WHERE clientGroupId IN (SELECT ClientGroups FROM @ClientGroups)

	AND subclientStatus &amp; 0x04 != 0x04 /*DELETED*/ AND subclientStatus &amp; 0x00020 != 0x00020 /*HIDDEN*/



	EXEC dbo.sec_getIdaObjectsForUser @userId, 3 /*Client Entity*/, 0, 0, '#temp__clientIds', 1



	DELETE FROM #listClientIds_Teams

	WHERE clientId NOT IN (SELECT clientId FROM #temp__clientIds)

END



IF OBJECT_ID('tempdb.dbo.#temp__clientIds') IS NOT NULL

	DROP TABLE #temp__clientIds

	

DELETE #listClientIds_Teams

FROM #listClientIds_Teams C INNER JOIN App_Client AC WITH (NOLOCK) ON C.clientId = AC.id

WHERE AC.specialClientFlags &amp; 0x02 = 0 /*Not Pseudo client*/



DELETE FROM #listClientIds_Teams

WHERE clientId NOT IN

(SELECT C.clientId FROM #listClientIds_Teams C 

INNER JOIN APP_Application AA WITH (NOLOCK) ON C.clientId = AA.clientId

INNER JOIN APP_InstanceProp AI WITH (NOLOCK) ON AA.instance = AI.componentNameId

WHERE appTypeId = @CV_APPTYPE_CLOUD_APPS AND attrName = 'Cloud Apps Instance Type' AND attrVal = @TEAMS_INSTANCE)



IF EXISTS (SELECT Options FROM @Options WHERE Options = 'Show backup disabled clients')

	SET @includeBackupDisabledClients = 1



DECLARE @csTimeZoneId			INT = 0

DECLARE @csTimeZone				NVARCHAR(1024) = ''

DECLARE @browserBias			INT = 0

DECLARE @browserTimeZoneId		INT = 0



SET @browserTimeZoneId = (SELECT TOP 1 TimeZoneID FROM SchedTimeZone WITH (NOLOCK) WHERE TimeZoneName LIKE '%' + @sys_timezone + '%')

SELECT @browserBias = Bias FROM SchedTimeZone WITH (NOLOCK) WHERE TimeZoneID = @browserTimeZoneId



SELECT @csTimeZoneId = (SELECT TOP 1 attrVal FROM APP_ClientProp WITH (NOLOCK) WHERE attrName = 'Commcell timezone Id' AND modified = 0)

IF ISNULL(@csTimeZoneId, 0) = 0

	SELECT @csTimeZoneId = (SELECT TOP 1 attrVal FROM APP_ClientProp WITH (NOLOCK) WHERE componentNameId = 2 AND attrName = 'timezone Id' AND modified = 0)

SET @csTimeZone = (SELECT TOP 1 TimeZoneName FROM SchedTimeZone WITH (NOLOCK) WHERE TimeZoneID = @csTimeZoneId)



DECLARE @startTime BIGINT = DATEDIFF(SS, '1970-01-01', dbo.LocalToUTCDateTimeConversionManaged(ISNULL(@timeframe_from,'1970-01-01 00:00:00.000'), @csTimeZone))



UPDATE #listClientIds_Teams

SET subclientId = S.subclientId, backupsetId = S.backupSet, instanceId = S.instance

FROM (SELECT MIN(id) AS subclientId, clientId, backupSet, instance

		FROM APP_Application WITH (NOLOCK)

		WHERE clientId IN (SELECT clientId FROM #listClientIds_Teams)

		GROUP BY clientId, backupSet, instance

	) S WHERE #listClientIds_Teams.clientId = S.clientId



UPDATE #listClientIds_Teams

SET isBackupDisabled = JA.action

FROM JMJobAction JA WITH (NOLOCK)

INNER JOIN #listClientIds_Teams TT ON TT.subclientId = JA.appId

WHERE JA.clientId = 1 AND JA.mediaAgentID = 1 AND JA.appType = 0 AND JA.optype = 4



UPDATE #listClientIds_Teams

SET isBackupDisabled = @LICENSE_RELEASED

FROM APP_Application(NOLOCK) AA

WHERE AA.id = #listClientIds_Teams.subclientId AND subclientStatus &amp; 0x02 = 0x02



UPDATE #listClientIds_Teams

SET isBackupDisabled = @EXCLUDED_FROM_SLA

FROM APP_SubClientProp ASP WITH (NOLOCK)

WHERE ASP.componentNameId = #listClientIds_Teams.subclientId AND ASP.attrName = 'Exclude From SLA' AND ASP.attrVal = 1 AND ASP.modified = 0



UPDATE #listClientIds_Teams

SET isBackupDisabled = @TENANT_DIACTIVEVATED

WHERE clientId IN (SELECT DISTINCT CGA.clientId

	FROM UMDSProviders UMDS WITH (NOLOCK)

	JOIN App_CompanyProp CP WITH (NOLOCK) ON CP.attrName = 'Associated Smart Client Group' AND CP.modified = 0 AND UMDS.id = CP.componentNameId

	JOIN APP_ClientGroupAssoc CGA WITH (NOLOCK) ON CAST(CGA.clientGroupId AS NVARCHAR(16)) = CP.attrVal

	WHERE UMDS.flags &amp; 0x0010 = 0x0010 OR enabled = 0)	



IF @includeBackupDisabledClients = 0

	DELETE FROM #listClientIds_Teams WHERE isBackupDisabled IN (1, @TENANT_DIACTIVEVATED, @LICENSE_RELEASED, @EXCLUDED_FROM_SLA)



IF OBJECT_ID('tempdb.dbo.#temp_unprotected_mailboxes_teams_sla') IS NOT NULL

	DROP TABLE #temp_unprotected_mailboxes_teams_sla



CREATE TABLE #temp_unprotected_mailboxes_teams_sla

(

	created BIGINT,

	backupReferenceTime BIGINT,

	clientId INT,

	isProtected INT

)

CREATE CLUSTERED INDEX #Idx1_temp_um_t_sla_clientId ON #temp_unprotected_mailboxes_teams_sla (clientId)



INSERT INTO #temp_unprotected_mailboxes_teams_sla (created, backupReferenceTime, clientId, isProtected)

SELECT created, CU.backupReferenceTime, TT.clientId,

(CASE WHEN (backupReferenceTime &lt; @startTime OR backupReferenceTime IS NULL) THEN 0 /*unprotected*/ ELSE 1/*protected*/ END)

FROM App_CloudAppUserDetails CU WITH (NOLOCK)

INNER JOIN #listClientIds_Teams TT ON TT.subclientId = CU.subClientId

WHERE CU.discoverByType = @DISCOVERTYPE_TEAM AND CU.modified = 0 AND CU.status = 0 /*Active*/ AND CU.smtpAddress IS NOT NULL



IF OBJECT_ID('tempdb.dbo.#teams_client_sla') IS NOT NULL

	DROP TABLE #teams_client_sla



CREATE TABLE #teams_client_sla

(

	clientId INT UNIQUE CLUSTERED,

	clientName NVARCHAR(255),

	clientDisplayName NVARCHAR(255),

	totalEntities BIGINT,

	slaMissedEntities BIGINT,

	neverBackedUp INT,

	recentlyAddedEntities BIGINT,

	needAttention INT,

	clientStatus NVARCHAR(32) DEFAULT 'Active',

	lastIndexPlaybackTime BIGINT,

	lastIndexBkpJobId INT,

	lastIndexErrorTime BIGINT,

	lastDiscoverTime BIGINT,

	lastBackupJobRunTime BIGINT,

	lastBackupJobId BIGINT,

	applicationSize BIGINT,

	numberOfItems BIGINT,

	itemsContentIndexed BIGINT,

	azureApps INT DEFAULT 0,

	authoziedAzureApps INT DEFAULT 0,

	lastVerifyConnectionTime BIGINT,

	streams INT,

	isModernAuthEnabled INT DEFAULT 1,

	accessNodeGroupId INT,

	accessNodeGroupDisplayName NVARCHAR(255),

	indexServerId INT,

	indexServerCloudId INT,

	indexServerName NVARCHAR(255),

	indexServerDisplayName NVARCHAR(255),

	clienturl NVARCHAR(2048),

	activejobsurl NVARCHAR(2048),

	indexserverurl NVARCHAR(2048),

	accessNodeGroupUrl NVARCHAR(2048)

)



INSERT INTO #teams_client_sla (clientId, totalEntities, slaMissedEntities, neverBackedUp, recentlyAddedEntities, needAttention)

SELECT

clientId,

COUNT(*),

SUM(CASE WHEN isProtected = 0 THEN 1 ELSE 0 END),

SUM(CASE WHEN backupReferenceTime IS NULL OR backupReferenceTime = 0 THEN 1 ELSE 0 END),

SUM(CASE WHEN created IS NOT NULL AND created &gt;= @recentlyAddedRefTime THEN 1 ELSE 0 END),

SUM(CASE WHEN (backupReferenceTime IS NULL OR backupReferenceTime = 0) AND @recentlyAddedRefTime &gt; created THEN 1 ELSE 0 END)

FROM #temp_unprotected_mailboxes_teams_sla

GROUP BY clientId



INSERT INTO #teams_client_sla (clientId, totalEntities, slaMissedEntities, neverBackedUp, recentlyAddedEntities, needAttention)

SELECT clientId, 0, 0, 0, 0, 0

FROM #listClientIds_Teams TT

WHERE TT.clientId NOT IN (SELECT clientId FROM #teams_client_sla)



UPDATE #teams_client_sla

SET clientName = AC.name, clientDisplayName = AC.displayName

FROM APP_Client AC WITH (NOLOCK)

WHERE #teams_client_sla.clientId = AC.id



UPDATE #teams_client_sla

SET lastIndexPlaybackTime = Idx.playbackTime, lastIndexBkpJobId = Idx.bkpJobId, lastIndexErrorTime = Idx.errorTime, applicationSize = Idx.backupSize, numberOfItems = Idx.numberOfItems, itemsContentIndexed = Idx.itemsContentIndexed

FROM

(

	SELECT I.properties.value('Indexing_DbStats[1]/@lastPlayedBkpTime', 'BIGINT') AS playbackTime, I.properties.value('(Indexing_DbStats/apps)[1]/@lastPlayedBkpJobId', 'INT') AS bkpJobId, 

	I.properties.value('Indexing_DbStats[1]/@lastIdxErrorTime', 'INT') AS errorTime, TT.clientId AS clientId,

	ISNULL(I.properties.value('(Indexing_DbStats/apps/stat)[1]/@applicationSize', 'BIGINT'), 0) AS backupSize, ISNULL(I.properties.value('(Indexing_DbStats/apps/stat)[1]/@itemsIndexed', 'BIGINT'), 0) AS numberOfItems,

	ISNULL(I.properties.value('(Indexing_DbStats/apps/stat)[1]/@itemsContentIndexed', 'BIGINT'), 0) AS itemsContentIndexed

	FROM IdxDbState I WITH (NOLOCK)

	INNER JOIN App_IndexDbInfo AI WITH (NOLOCK) ON I.dbid = AI.id

	INNER JOIN #listClientIds_Teams TT ON TT.backupsetId = AI.backupSetId

) Idx WHERE Idx.clientId = #teams_client_sla.clientId



UPDATE #teams_client_sla

SET lastDiscoverTime = DS.value('App_Office365DiscoverState[1]/@lastCacheUpdateTime', 'BIGINT')

FROM

(

	SELECT TT.clientId AS clientId, CAST(CAST(attrVal AS VARCHAR(MAX)) AS XML) DS

	FROM App_InstanceProp AIP WITH (NOLOCK)

	INNER JOIN #listClientIds_Teams TT ON AIP.componentNameId = TT.instanceId

	WHERE AIP.attrName = 'V2CloudApps Discovery State' AND AIP.modified = 0

) D WHERE D.clientId = #teams_client_sla.clientId



UPDATE #teams_client_sla

SET lastBackupJobRunTime = LBJ.value('(lastBackupJobInfo/endTime)[1]/@time', 'BIGINT'), lastBackupJobId = LBJ.value('(lastBackupJobInfo)[1]/@jobID', 'BIGINT')

FROM

(

	SELECT AIN.clientId AS clientId, CAST(CAST(attrVal AS VARCHAR(MAX)) AS XML) AS LBJ

	FROM App_IdaProp AIP WITH (NOLOCK)

	INNER JOIN App_IdaName AIN WITH (NOLOCK) ON AIP.componentNameId = AIN.id AND AIN.appTypeId = @CV_APPTYPE_CLOUD_APPS

	WHERE AIN.clientId IN (select clientId FROM #listClientIds_Teams) AND AIP.attrName = 'Last Backup Job Info' AND AIP.modified = 0

) D WHERE D.clientId = #teams_client_sla.clientId



IF @includeBackupDisabledClients = 1

	UPDATE #teams_client_sla

	SET clientStatus = (CASE 

							WHEN isBackupDisabled = 1 THEN 'Backup Activity is Disabled'

							WHEN isBackupDisabled = @TENANT_DIACTIVEVATED THEN 'Tenant Deactivated/Disabled'

							WHEN isBackupDisabled = @LICENSE_RELEASED THEN 'License Released'

							WHEN isBackupDisabled = @EXCLUDED_FROM_SLA THEN 'Excluded From SLA'

							ELSE 'Active'

						END)

	FROM #listClientIds_Teams

	WHERE #teams_client_sla.clientId = #listClientIds_Teams.clientId AND isBackupDisabled IN (1, @TENANT_DIACTIVEVATED, @LICENSE_RELEASED, @EXCLUDED_FROM_SLA)



UPDATE #teams_client_sla

SET azureApps = CAST(CAST(AIP.attrVal AS VARCHAR(MAX)) AS XML).value('count(/App_Office365AzureConnections/azureApps)', 'int'),

	authoziedAzureApps = CAST(CAST(AIP.attrVal AS VARCHAR(MAX)) AS XML).value('count(/App_Office365AzureConnections//*[@appStatus="1"])', 'int')

FROM #listClientIds_Teams TOD

INNER JOIN App_InstanceProp AIP WITH (NOLOCK) ON TOD.instanceId = AIP.componentNameId

WHERE #teams_client_sla.clientId = TOD.clientId AND attrName = 'V2CloudApps Azure Connections' AND modified = 0



UPDATE #teams_client_sla

SET authoziedAzureApps = CAST(CAST(AIP.attrVal AS VARCHAR(MAX)) AS XML).value('count(/App_Office365AzureConnectionsStatus/azureAppList//*[@appStatus="1"])', 'int'),

    lastVerifyConnectionTime = CAST(CAST(AIP.attrVal AS VARCHAR(MAX)) AS XML).value('(//@lastAzureAppStatusUpdate)[1]', 'BIGINT')

FROM #listClientIds_Teams TOD

INNER JOIN App_InstanceProp AIP WITH (NOLOCK) ON TOD.instanceId = AIP.componentNameId

WHERE #teams_client_sla.clientId = TOD.clientId AND attrName = 'Office365 Azure Connections Status' AND modified = 0



UPDATE #teams_client_sla

SET streams = CAST (attrVal AS INT)

FROM #listClientIds_Teams TE

INNER JOIN APP_SubClientProp ASP WITH (NOLOCK) ON TE.subclientId = ASP.componentNameId

WHERE #teams_client_sla.clientId = TE.clientId AND attrName = 'sys:nStreams' AND modified = 0



UPDATE #teams_client_sla

SET accessNodeGroupId = CAST(CAST(attrVal AS VARCHAR(MAX)) AS XML).value('(//@clientGroupId)[1]', 'int'),

	accessNodeGroupDisplayName = CAST(CAST(attrVal AS VARCHAR(MAX)) AS XML).value('(//@clientGroupName)[1]', 'nvarchar(max)')

FROM #listClientIds_Teams TT

INNER JOIN APP_InstanceProp AIP WITH (NOLOCK) ON TT.instanceId = AIP.componentNameId

WHERE #teams_client_sla.clientId = TT.clientId AND attrName = 'Proxy Clients' AND AIP.modified = 0



UPDATE #teams_client_sla

SET indexServerId = AIP.attrVal

FROM #listClientIds_Teams TT

INNER JOIN App_InstanceProp AIP WITH (NOLOCK) ON TT.instanceId = AIP.componentNameId

WHERE #teams_client_sla.clientId = TT.clientId AND AIP.attrName = 'V2CloudApps Index Server' AND AIP.modified = 0



UPDATE #teams_client_sla

SET indexServerCloudId = ISNULL(DC.cloudId, 0)

FROM DM2Cloud DC WITH (NOLOCK)

WHERE #teams_client_sla.indexServerId = DC.pseudoClientId



UPDATE #teams_client_sla

SET indexServerName = AC.name, indexServerDisplayName = AC.displayName

FROM APP_Client AC WITH (NOLOCK)

WHERE #teams_client_sla.indexServerId = AC.id



UPDATE #teams_client_sla

SET clienturl = '#/office365/clientDetails/' + clientName + '/' + CAST(TT.clientId AS NVARCHAR(255)) + '/' + CAST(TT.subclientId AS NVARCHAR(255)) + '/users?backupsetId=' + CAST(TT.backupsetId AS NVARCHAR(255)) + '&amp;instanceType=36',

	activejobsurl = '#/activeJobs?activeJobs=0&amp;serverName=' + clientName + '&amp;serverId=' + CAST(TT.clientId AS NVARCHAR(64)) + '&amp;applicationId=134',

	indexserverUrl = '#/indexServer/configuration/' + CAST(indexServerId AS NVARCHAR(64)) + '?name=' + indexServerName + '&amp;cloudId=' + CAST(indexServerCloudId AS NVARCHAR(64)),

	accessNodeGroupUrl = '#/clientGroupDetails/' + CAST(accessNodeGroupId AS NVARCHAR(64))

FROM #listClientIds_Teams TT

WHERE #teams_client_sla.clientId = TT.clientId



SELECT

clientDisplayName AS 'Client',

clientStatus AS 'Client Status',

(CASE WHEN lastIndexPlaybackTime IS NOT NULL AND lastIndexPlaybackTime &gt;= @startTime THEN 'UpToDate' ELSE 'Pending playback' END) AS 'Index Status',

(CASE WHEN lastIndexBkpJobId IS NOT NULL AND lastIndexBkpJobId &gt; 0 THEN CAST(lastIndexBkpJobId AS VARCHAR(64)) ELSE '' END) AS 'Last Indexed Backup JobId',

(CASE WHEN lastIndexPlaybackTime IS NOT NULL AND lastIndexPlaybackTime &gt; 0 

	THEN (SELECT DATEADD(ss, lastIndexPlaybackTime + @browserBias, CAST('1970-01-01 00:00' AS DATETIME)))

END) AS 'Last Index Time',

(CASE WHEN lastIndexErrorTime IS NOT NULL AND lastIndexErrorTime &gt; 0 

	THEN (SELECT DATEADD(ss, lastIndexErrorTime + @browserBias, CAST('1970-01-01 00:00' AS DATETIME)))

END) AS 'Last Index Error Time',

(CASE WHEN lastDiscoverTime IS NOT NULL AND lastDiscoverTime &gt; 0 

	THEN (SELECT DATEADD(ss, lastDiscoverTime + @browserBias, CAST('1970-01-01 00:00' AS DATETIME)))

END) AS 'Last Discovery Time',

(CASE WHEN ISNULL(lastBackupJobRunTime, 0) &gt; 0 

	THEN (SELECT DATEADD(ss, lastBackupJobRunTime + @browserBias, CAST('1970-01-01 00:00' AS DATETIME)))

END) AS 'Last Backup Run Time',

(CASE

	WHEN ISNULL(lastBackupJobId, 0) &gt; 0 THEN CAST(lastBackupJobId AS VARCHAR(64))

	ELSE ''

END) AS 'Last Backup Job ID',

totalEntities AS 'Associated Teams',

(totalEntities - slaMissedEntities) AS 'Teams Backed-up',

slaMissedEntities AS 'Teams Not Backed-up',

neverBackedUp AS 'Teams Never Backed-up',

(totalEntities - neverBackedUp) AS 'Teams Backed-up (at least once)',

recentlyAddedEntities AS 'Teams Recently Added',

needAttention AS 'Teams Need Attention',

applicationSize AS 'Application Size',

numberOfItems AS 'Number of Items',

itemsContentIndexed AS 'Indexed Items',

azureApps AS 'Azure Apps Associated',

azureApps - authoziedAzureApps AS 'Azure Apps Not Authorized',

(CASE 

	WHEN isModernAuthEnabled = 1 AND totalEntities &lt; @MAX_USERS_FOR_FIVE_CONNECTIONS AND azureApps &lt; 5 THEN 5 - azureApps

	WHEN isModernAuthEnabled = 1 AND totalEntities &gt;= @MAX_USERS_FOR_FIVE_CONNECTIONS AND azureApps &lt; 10 THEN 10 - azureApps

	ELSE 0 

END) AS 'Azure Apps To Be Added',

(CASE

	WHEN ISNULL(lastVerifyConnectionTime, 0) &gt; 0 THEN (SELECT DATEADD(ss, lastVerifyConnectionTime + @browserBias, CAST('1970-01-01 00:00' AS DATETIME)))

END) AS 'Last Verify Connection Time',

streams AS 'Max Streams',

ISNULL(accessNodeGroupDisplayName, '') AS 'Access Node Group',

ISNULL(indexServerDisplayName, '') AS 'Index Server',

'Active Jobs' AS 'Active Jobs',

(CASE WHEN lastIndexBkpJobId IS NOT NULL AND lastIndexBkpJobId &gt; 0 

	THEN '#/jobs/' + CAST(lastIndexBkpJobId AS NVARCHAR(255))

	ELSE ''

END) AS 'joburl',

(CASE WHEN ISNULL(lastBackupJobId, 0) &gt; 0

	THEN '#/jobs/' + CAST(lastBackupJobId AS NVARCHAR(256))

	ELSE ''

END) AS 'backupjoburl',

clienturl AS 'clienturl',

activejobsurl AS 'activejobsurl',

ISNULL(accessNodeGroupUrl, '') AS 'accessNodeGroupUrl',

indexserverurl AS 'indexserverurl'

FROM #teams_client_sla

ORDER BY totalEntities DESC



IF OBJECT_ID('tempdb.dbo.#listClientIds_Teams') IS NOT NULL

	DROP TABLE #listClientIds_Teams



IF OBJECT_ID('tempdb.dbo.#temp_unprotected_mailboxes_teams_sla') IS NOT NULL

	DROP TABLE #temp_unprotected_mailboxes_teams_sla



IF OBJECT_ID('tempdb.dbo.#teams_client_sla') IS NOT NULL

	DROP TABLE #teams_client_sla</sqlText>
              <timeout>5</timeout>
              <postQueryFilter>true</postQueryFilter>
              <rDataSetQuery />
              <rPlotQuery />
            </GetOperation>
            <description>Backup Health Report for Office 365 Clients.</description>
            <databaseName>CommServ</databaseName>
            <queryPlan>
              <offline>false</offline>
              <collectionType>HTTP</collectionType>
              <retentionDays>1</retentionDays>
              <versions>
                <CommCellVersion>ALL</CommCellVersion>
              </versions>
              <dynamicCollection>false</dynamicCollection>
              <frequency>60</frequency>
              <direct>false</direct>
            </queryPlan>
            <version>144</version>
            <guid>6c4a4208-f3b3-408d-8ff0-3be774080b0b</guid>
            <hidden>true</hidden>
            <revision />
            <computedColumns>
              <scriptName>R</scriptName>
              <script />
              <columnList />
            </computedColumns>
          </DataSet>
          <DataSet>
            <dataSet>
              <dataSetName>Teams Entities SLA</dataSetName>
              <dataSetGuid>805e0d37-b6a8-4979-9878-bc6b2102f8b6</dataSetGuid>
            </dataSet>
            <endpoint>DATABASE</endpoint>
            <shared>false</shared>
            <dataSources>
              <DataSource>
                <connectionType>COMMCELL</connectionType>
                <endpoint>DATABASE</endpoint>
                <commCell>
                  <commCellName>$ALL$</commCellName>
                </commCell>
              </DataSource>
            </dataSources>
            <allColumns>true</allColumns>
            <fields>
              <Column>
                <name>sys_rowid</name>
                <dataField>$row_number$</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Data Source</name>
                <dataField>Data Source</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Name</name>
                <dataField>Name</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Email Address</name>
                <dataField>Email Address</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Last Backup</name>
                <dataField>Last Backup</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Last Backup Status</name>
                <dataField>Last Backup Status</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Failure Reason</name>
                <dataField>Failure Reason</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Last Backup attempt</name>
                <dataField>Last Backup Attempt</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Last Backup Attempt JobId</name>
                <dataField>Last Backup Attempt JobId</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Client</name>
                <dataField>Client</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Added to content on</name>
                <dataField>Added to content on</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Backup Size</name>
                <dataField>Backup Size</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Number Of Items</name>
                <dataField>Number Of Items</dataField>
                <type>Integer</type>
              </Column>
              <Column>
                <name>Failed Items</name>
                <dataField>Failed Items</dataField>
                <type>Integer</type>
              </Column>
            </fields>
            <GetOperation>
              <parameters>
                <Parameter>
                  <name>Clients</name>
                  <dataType>Integer</dataType>
                  <isList>true</isList>
                  <values>
                    <string>=input.TeamsClients</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>ClientGroups</name>
                  <dataType>Integer</dataType>
                  <isList>true</isList>
                  <values>
                    <string>=input.ClientGroups</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>timeframe</name>
                  <dataType>DateRange</dataType>
                  <values>
                    <string>=input.Timeframe</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>Options</name>
                  <dataType>String</dataType>
                  <isList>true</isList>
                  <values>
                    <string>=input.Options</string>
                  </values>
                </Parameter>
              </parameters>
              <sqlText>/*Validity check*/

IF NOT EXISTS (SELECT Clients FROM @Clients) AND NOT EXISTS (SELECT ClientGroups FROM @ClientGroups)

BEGIN

	/*SELECT dummy columns to maintain consistency in report columns output*/

	SELECT 

		Clients AS [Name],

		Clients AS [Email Address],

		Clients AS [Last Backup],

		Clients AS [Last Backup Status],

		Clients AS [Failure Reason],

		Clients AS [Last Backup Attempt],

		Clients AS [Last Backup Attempt JobId],

		Clients AS [Client],

		Clients AS [Added to content on],

		Clients AS [Backup Size],

		Clients AS [Number Of Items],

		Clients AS [Failed Items]

	FROM @Clients



	RETURN

END



-- constants

DECLARE @CV_APPTYPE_CLOUD_APPS INT = 134

DECLARE @TEAMS_INSTANCE INT = 36

DECLARE @DISCOVERTYPE_TEAM INT = 12



DECLARE @STATUS_NOT_AVAILABLE INT = 0

DECLARE @STATUS_FAILED INT = 1

DECLARE @STATUS_SKIPPED INT = 2

DECLARE @STATUS_SUCCESS INT = 3

DECLARE @STATUS_SUSPENDED INT = 4

DECLARE @STATUS_COMPLETED_WITH_ERRORS INT = 5

DECLARE @STATUS_PARTIALLY_PROCESSED INT = 6

DECLARE @STATUS_NEVER_BACKED_UP INT = 501



DECLARE @numberOfDays INT = 7

DECLARE @depthRefTime INT = dbo.getunixtime(DATEADD(HOUR, -@numberOfDays*24 , GETUTCDATE()))



-- variables

DECLARE @userId INT = (SELECT TOP 1 id FROM UMUsers WITH (NOLOCK) WHERE login = @sys_username)

DECLARE @companyId INT

DECLARE @includeBackupDisabledClients INT = 0

DECLARE @includeAllTeams INT = 0



IF OBJECT_ID('tempdb.dbo.#listClientIds_Teams') IS NOT NULL

	DROP TABLE #listClientIds_Teams



CREATE TABLE #listClientIds_Teams (clientId INT, subclientId INT, backupsetId INT, instanceId INT)

CREATE NONCLUSTERED INDEX #listClientIds_Teams_c_s_b_i_ids ON #listClientIds_Teams(clientId, subclientId, backupsetId, instanceId)



-- read inputs

INSERT INTO #listClientIds_Teams (clientId) 

SELECT DISTINCT Clients FROM @Clients

UNION

SELECT DISTINCT CG.clientId FROM App_ClientGroupAssoc CG WITH (NOLOCK)

INNER JOIN APP_Application AA WITH (NOLOCK) ON CG.clientId = AA.clientId AND AA.appTypeId = @CV_APPTYPE_CLOUD_APPS

WHERE clientGroupId IN (SELECT ClientGroups FROM @ClientGroups)

AND subclientStatus &amp; 0x04 != 0x04 /*DELETED*/ AND subclientStatus &amp; 0x00020 != 0x00020 /*HIDDEN*/



IF OBJECT_ID('tempdb.dbo.#temp__clientIds') IS NOT NULL

	DROP TABLE #temp__clientIds



CREATE TABLE #temp__clientIds

(

	clientId            INT,

	appTypeId           INT,

	instanceId          INT,

	backupsetId         INT,

	subclientId         INT

)



SET @companyId = dbo.AppGetOrganizationForUser(@userId)



IF @companyId &gt; 0

BEGIN

	INSERT INTO #temp__clientIds (clientId)

	SELECT DISTINCT CGA.clientId

	FROM UMDSProviders UMDS WITH (NOLOCK)

	JOIN App_CompanyProp CP WITH (NOLOCK) ON CP.attrName = 'Associated Smart Client Group' AND CP.modified = 0 AND UMDS.id = CP.componentNameId

	JOIN APP_ClientGroupAssoc CGA WITH (NOLOCK) ON CAST(CGA.clientGroupId AS NVARCHAR(16)) = CP.attrVal

	JOIN APP_ClientGroup CG WITH (NOLOCK) ON CGA.clientGroupId = CG.id

	WHERE CP.componentNameId = @companyId AND CG.flag &amp; 0x1000 &gt; 0

END

ELSE

BEGIN

	EXEC dbo.sec_getIdaObjectsForUser @userId, 3 /*Client Entity*/, 0, 0, '#temp__clientIds', 1

END



DELETE #listClientIds_Teams

FROM #listClientIds_Teams C 

INNER JOIN App_Client AC WITH (NOLOCK) ON C.clientId = AC.id

WHERE AC.specialClientFlags &amp; 0x02 = 0 /*Not Pseudo client*/ OR C.clientId NOT IN (SELECT clientId FROM #temp__clientIds)



IF OBJECT_ID('tempdb.dbo.#temp__clientIds') IS NOT NULL

	DROP TABLE #temp__clientIds



DELETE #listClientIds_Teams

FROM #listClientIds_Teams TT INNER JOIN App_Client AC WITH (NOLOCK) ON TT.clientId = AC.id

WHERE AC.specialClientFlags &amp; 0x02 = 0 /*Pseudo client*/



DELETE FROM #listClientIds_Teams

WHERE clientId NOT IN

(SELECT C.clientId FROM #listClientIds_Teams C 

INNER JOIN APP_Application AA WITH (NOLOCK) ON C.clientId = AA.clientId

INNER JOIN APP_InstanceProp AI WITH (NOLOCK) ON AA.instance = AI.componentNameId

WHERE appTypeId = @CV_APPTYPE_CLOUD_APPS AND attrName = 'Cloud Apps Instance Type' AND attrVal = @TEAMS_INSTANCE)



DECLARE @csTimeZoneId			INT = 0

DECLARE @csTimeZone				NVARCHAR(1024) = ''

DECLARE @browserBias			INT = 0

DECLARE @browserTimeZoneId		INT = 0



SET @browserTimeZoneId = (SELECT TOP 1 TimeZoneID FROM SchedTimeZone WITH (NOLOCK) WHERE TimeZoneName LIKE '%' + @sys_timezone + '%')

SELECT @browserBias = Bias FROM SchedTimeZone WITH (NOLOCK) WHERE TimeZoneID = @browserTimeZoneId



SELECT @csTimeZoneId = (SELECT TOP 1 attrVal FROM APP_ClientProp WITH (NOLOCK) WHERE attrName = 'Commcell timezone Id' AND modified = 0)

IF ISNULL(@csTimeZoneId, 0) = 0

	SELECT @csTimeZoneId = (SELECT TOP 1 attrVal FROM APP_ClientProp WITH (NOLOCK) WHERE componentNameId = 2 AND attrName = 'timezone Id' AND modified = 0)

SET @csTimeZone = (SELECT TOP 1 TimeZoneName FROM SchedTimeZone WITH (NOLOCK) WHERE TimeZoneID = @csTimeZoneId)



DECLARE @startTime BIGINT = DATEDIFF(SS, '1970-01-01', dbo.LocalToUTCDateTimeConversionManaged(ISNULL(@timeframe_from,'1970-01-01 00:00:00.000'), @csTimeZone))



IF EXISTS (SELECT Options FROM @Options WHERE Options = 'Show backup disabled clients')

	SET @includeBackupDisabledClients = 1



IF EXISTS (SELECT Options FROM @Options WHERE Options = 'Show all teams')

	SET @includeAllTeams = 1



UPDATE #listClientIds_Teams

SET subclientId = S.subclientId, backupsetId = S.backupSet, instanceId = S.instance

FROM (SELECT MIN(id) AS subclientId, clientId, backupSet, instance

		FROM APP_Application WITH (NOLOCK)

		WHERE clientId IN (SELECT clientId FROM #listClientIds_Teams)

		GROUP BY clientId, backupSet, instance

	) S WHERE #listClientIds_Teams.clientId = S.clientId



IF @includeBackupDisabledClients = 0

BEGIN

	DELETE FROM #listClientIds_Teams

	WHERE subclientId IN 

	(

		/*Delete license released clients*/

		SELECT AA.id

		FROM App_Application AA WITH (NOLOCK)

		INNER JOIN #listClientIds_Teams TT ON AA.id = TT.subclientId 

		WHERE subclientStatus &amp; 0x02 = 0x02

		UNION

		/*Delete excluded from SLA clients*/

		SELECT ASP.componentNameId

		FROM APP_SubClientProp ASP WITH (NOLOCK)

		JOIN #listClientIds_Teams TE ON ASP.componentNameId = TE.subclientId

		WHERE ASP.attrName = 'Exclude From SLA' AND ASP.attrVal = 1 AND ASP.modified = 0

		UNION

		/*Delete backup disabled clients*/

		SELECT JA.appId

		FROM JMJobAction JA WITH (NOLOCK) 

		JOIN #listClientIds_Teams TE ON JA.appId = TE.subclientId

		WHERE JA.clientId = 1 AND JA.mediaAgentID = 1 AND JA.appType = 0 AND JA.optype = 4 AND JA.action = 1

	)



	/*Delete clients associated with deactivated tenants*/

	DELETE FROM #listClientIds_Teams 

	WHERE clientId IN (SELECT DISTINCT CGA.clientId

	FROM UMDSProviders UMDS WITH (NOLOCK)

	JOIN App_CompanyProp CP WITH (NOLOCK) ON CP.attrName = 'Associated Smart Client Group' AND CP.modified = 0 AND UMDS.id = CP.componentNameId

	JOIN APP_ClientGroupAssoc CGA WITH (NOLOCK) ON CAST(CGA.clientGroupId AS NVARCHAR(16)) = CP.attrVal

	WHERE UMDS.flags &amp; 0x0010 = 0x0010 OR enabled = 0)

END



IF OBJECT_ID('tempdb.dbo.#temp_unprotected_mailboxes_teams') IS NOT NULL

	DROP TABLE #temp_unprotected_mailboxes_teams



CREATE TABLE #temp_unprotected_mailboxes_teams

(

	displayName NVARCHAR(512),

	smtpAddress NVARCHAR(512),

	userGUID NVARCHAR(128),

	created BIGINT,

	backupReferenceTime BIGINT,

	clientId INT,

	mailboxSize BIGINT,

	numberOfItems BIGINT,

	isProtected INT

)



INSERT INTO #temp_unprotected_mailboxes_teams (displayName, smtpAddress, userGUID, created, backupReferenceTime, clientId, mailboxSize, numberOfItems, isProtected)

SELECT CU.displayName, CU.smtpAddress, UPPER(CU.userGUID), created, CU.backupReferenceTime, TT.clientId, CU.userAccountSize, CU.numberOfItems, 0

FROM App_CloudAppUserDetails CU WITH (NOLOCK)

INNER JOIN #listClientIds_Teams TT ON TT.subclientId = CU.subClientId

WHERE CU.discoverByType = @DISCOVERTYPE_TEAM AND CU.modified = 0 AND CU.status = 0 /*Active*/ AND CU.smtpAddress IS NOT NULL

AND (CASE 

		WHEN @includeAllTeams = 1 THEN 1

		WHEN (backupReferenceTime &lt; @startTime OR backupReferenceTime IS NULL) THEN 1

		ELSE 0

	END) = 1



CREATE CLUSTERED INDEX #temp_unprotected_mailboxes_t_smtp_clientId ON #temp_unprotected_mailboxes_teams (clientId, userGUID)



IF OBJECT_ID('tempdb.dbo.#upm_temp_job_summary_teams') IS NOT NULL

	DROP TABLE #upm_temp_job_summary_teams



CREATE TABLE #upm_temp_job_summary_teams

(

	clientId INT,

	jobId INT,

	jobStartTime BIGINT,

	jobEndTime BIGINT,

	data XML

)



CREATE CLUSTERED INDEX #ump_job_summary_client_jobId ON #upm_temp_job_summary_teams(clientId, jobId)



INSERT INTO #upm_temp_job_summary_teams

SELECT TE.clientId, JM.jobId, JS.servStartDate, JS.servEndDate, JM.data

FROM  JMMisc JM WITH (NOLOCK)

INNER JOIN JMBkpStats JS WITH (NOLOCK) ON JM.jobId = JS.jobId AND JS.servEndDate &gt;= @depthRefTime AND JS.commcellId = 2

INNER JOIN #listClientIds_Teams TE ON TE.subclientId = JS.appId

WHERE JS.opType = 4 /*Backup*/ AND JM.itemType = 28



IF OBJECT_ID('tempdb.dbo.#upm_temp_mailbox_summary_teams') IS NOT NULL

	DROP TABLE #upm_temp_mailbox_summary_teams



CREATE TABLE #upm_temp_mailbox_summary_teams

(

	smtpAddress NVARCHAR(512),

	userGUID NVARCHAR(128),

	status INT, 

	failureReason NVARCHAR(MAX),

	failedItems INT,

	jobId INT,

	jobStartTime BIGINT,

	jobEndTime BIGINT,

	clientId INT

)

CREATE CLUSTERED INDEX #upm_temp_mailbox_summary_t_smtp_cId_jId ON #upm_temp_mailbox_summary_teams(jobId, clientId, userGUID)



INSERT INTO #upm_temp_mailbox_summary_teams

SELECT 

	M.NA.value('@SMTP', 'NVARCHAR(512)'),

	UPPER(REPLACE(M.NA.value('@GUID', 'NVARCHAR(128)'), '-', 'X')),

	M.NA.value('@status', 'INT'),

	M.NA.value('@FailureReason', 'NVARCHAR(MAX)'),

    M.NA.value('@FailedMessages', 'INT'),

	jobId, jobStartTime, jobEndTime, clientId

FROM #upm_temp_job_summary_teams U

CROSS APPLY data.nodes('./JobManager_ExchMbJobInfo/SourceMailboxStats') M(NA)

WHERE M.NA.value('@status', 'INT') &lt;&gt; @STATUS_SUCCESS -- Skip successful mailboxes



DELETE dup FROM 

(SELECT ROW_NUMBER() OVER (PARTITION BY userGUID, clientId ORDER BY jobId DESC) cnt FROM #upm_temp_mailbox_summary_teams) dup

WHERE dup.cnt &gt; 1



SELECT

displayName AS 'Name',

smtpAddress AS 'Email Address',

(CASE WHEN lastBackup IS NOT NULL AND lastBackup &gt; 0

	THEN (SELECT DATEADD(ss, lastBackup + @browserBias, CAST('1970-01-01 00:00:00' AS DATETIME)))

END) AS 'Last Backup', 

(CASE mailboxStatus 

	WHEN @STATUS_FAILED THEN 'Failed'

	WHEN @STATUS_SKIPPED THEN 'Skipped'

	WHEN @STATUS_SUCCESS THEN 'Successful'

	WHEN @STATUS_SUSPENDED THEN 'Suspended'

	WHEN @STATUS_COMPLETED_WITH_ERRORS THEN 'Completed with errors'

	WHEN @STATUS_PARTIALLY_PROCESSED THEN 'Partially Processed'

	WHEN @STATUS_NEVER_BACKED_UP THEN 'Never backed-up'

	WHEN @STATUS_NOT_AVAILABLE THEN 'Not Available'

END) AS 'Last Backup Status',

(CASE WHEN mailboxStatus NOT IN (@STATUS_SUCCESS, @STATUS_NOT_AVAILABLE) THEN failureReason END) AS 'Failure Reason',

(CASE 

	WHEN mailboxStatus = @STATUS_SUCCESS THEN (SELECT DATEADD(ss, lastBackup + @browserBias, CAST('1970-01-01 00:00:00' AS DATETIME)))

	WHEN mailboxStatus &lt;&gt; @STATUS_NOT_AVAILABLE THEN lastAttempt

END) AS 'Last Backup Attempt', 

(CASE WHEN mailboxStatus NOT IN (@STATUS_SUCCESS, @STATUS_NOT_AVAILABLE) THEN jobId END) AS 'Last Backup Attempt JobId',

clientName AS 'Client',

(CASE WHEN created IS NOT NULL AND created &gt; 0

	THEN (SELECT DATEADD(ss, created + @browserBias, CAST('1970-01-01 00:00:00' AS DATETIME)))

END) AS 'Added to content on',

(CASE WHEN mailboxSize IS NULL THEN 0 ELSE mailboxSize END) AS 'Backup Size',

(CASE WHEN numberOfItems IS NULL THEN 0 ELSE numberOfItems END) AS 'Number Of Items',

(CASE WHEN mailboxStatus &lt;&gt; @STATUS_NOT_AVAILABLE THEN ISNULL(failedItems, 0) ELSE 0 END) AS 'Failed Items'

FROM 

(

	SELECT UP.displayName, UP.smtpAddress, UP.created,

	(SELECT DATEADD(ss, jobStartTime + @browserBias, CAST('1970-01-01 00:00:00' AS DATETIME))) AS [lastAttempt],

	backupReferenceTime AS [lastBackup],

	(CASE 

		WHEN MS.status IS NOT NULL AND (ISNULL(MS.jobStartTime, 0) &gt;= ISNULL(backupReferenceTime, 0) 

										OR ISNULL(backupReferenceTime, 0) BETWEEN ISNULL(MS.jobStartTime, 0) AND ISNULL(MS.jobEndTime, 0)) THEN MS.status

		WHEN ISNULL(backupReferenceTime, 0) &gt;= @depthRefTime THEN @STATUS_SUCCESS

		WHEN ISNULL(backupReferenceTime, 0) = 0 THEN @STATUS_NEVER_BACKED_UP 

		ELSE @STATUS_NOT_AVAILABLE 

	END) AS [mailboxStatus],

	UP.clientId, AC.displayName AS [clientName], jobId, failureReason, failedItems, mailboxSize, numberOfItems

	FROM #temp_unprotected_mailboxes_teams UP 

	LEFT JOIN APP_Client AC WITH (NOLOCK) ON UP.clientId = AC.id

	LEFT JOIN #upm_temp_mailbox_summary_teams MS ON UP.userGUID = MS.userGUID AND UP.clientId = MS.clientId

	--WHERE (status = @STATUS_SKIPPED OR (MS.jobStartTime IS NULL OR MS.jobStartTime &gt; (CASE WHEN UP.backupReferenceTime IS NULL THEN 0 ELSE UP.backupReferenceTime END)))

) R

--ORDER BY jobId DESC, lastBackup DESC



IF OBJECT_ID('tempdb.dbo.#listClientIds_Teams') IS NOT NULL

	DROP TABLE #listClientIds_Teams



IF OBJECT_ID('tempdb.dbo.#upm_temp_mailbox_summary_teams') IS NOT NULL

	DROP TABLE #upm_temp_mailbox_summary_teams



IF OBJECT_ID('tempdb.dbo.#upm_temp_mailbox_summary_teams') IS NOT NULL

	DROP TABLE #upm_temp_mailbox_summary_teams



IF OBJECT_ID('tempdb.dbo.#temp_unprotected_mailboxes_teams') IS NOT NULL

	DROP TABLE #temp_unprotected_mailboxes_teams

</sqlText>
              <timeout>5</timeout>
              <postQueryFilter>true</postQueryFilter>
              <rDataSetQuery />
              <rPlotQuery />
            </GetOperation>
            <description>Backup Health Report for Office 365 Clients.</description>
            <databaseName>CommServ</databaseName>
            <queryPlan>
              <offline>false</offline>
              <collectionType>HTTP</collectionType>
              <retentionDays>1</retentionDays>
              <versions>
                <CommCellVersion>ALL</CommCellVersion>
              </versions>
              <dynamicCollection>false</dynamicCollection>
              <frequency>60</frequency>
              <direct>false</direct>
            </queryPlan>
            <version>144</version>
            <guid>805e0d37-b6a8-4979-9878-bc6b2102f8b6</guid>
            <hidden>true</hidden>
            <revision />
            <computedColumns>
              <scriptName>R</scriptName>
              <script />
              <columnList />
            </computedColumns>
          </DataSet>
          <DataSet>
            <dataSet>
              <dataSetName>Client Discovery</dataSetName>
              <dataSetGuid>7aab2581-b37c-4255-8545-66cdb44bf560</dataSetGuid>
            </dataSet>
            <endpoint>DATASET</endpoint>
            <shared>false</shared>
            <dataSources>
              <DataSource>
                <connectionType>COMMCELL</connectionType>
                <commCell>
                  <commCellName>$LocalCommCell$</commCellName>
                </commCell>
              </DataSource>
            </dataSources>
            <allColumns>false</allColumns>
            <fields>
              <Column>
                <name>sys_rowid</name>
                <dataField>$row_number$</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Data Source</name>
                <dataField>Data Source</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Client</name>
                <dataField>Client</dataField>
                <type>String</type>
              </Column>
            </fields>
            <GetOperation>
              <parameters>
                <Parameter>
                  <name>Clients</name>
                  <dataType>Integer</dataType>
                  <isList>true</isList>
                  <values>
                    <string>=input.TeamsClients</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>ClientGroups</name>
                  <dataType>Integer</dataType>
                  <isList>true</isList>
                  <values>
                    <string>=input.ClientGroups</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>timeframe</name>
                  <dataType>DateRange</dataType>
                  <values>
                    <string>=input.Timeframe</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>Options</name>
                  <dataType>String</dataType>
                  <isList>true</isList>
                  <values>
                    <string>=input.Options</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>natimeframe</name>
                  <dataType>DateRange</dataType>
                  <values>
                    <string>=input.NATimeRange</string>
                  </values>
                </Parameter>
              </parameters>
              <sqlText>SELECT Client FROM :[Teams Clients SLA]
WHERE [Last Discovery Time] &lt; @natimeframe_from OR [Last Discovery Time] IS NULL</sqlText>
              <timeout>5</timeout>
              <postQueryFilter>true</postQueryFilter>
              <rDataSetQuery />
              <rPlotQuery />
            </GetOperation>
            <description>Backup Health Report for Office 365 Clients.</description>
            <databaseName>CommServ</databaseName>
            <queryPlan>
              <offline>false</offline>
              <retentionDays>1</retentionDays>
              <versions>
                <CommCellVersion>ALL</CommCellVersion>
              </versions>
              <dynamicCollection>false</dynamicCollection>
              <frequency>60</frequency>
              <direct>true</direct>
            </queryPlan>
            <version>45</version>
            <guid>7aab2581-b37c-4255-8545-66cdb44bf560</guid>
            <revision />
          </DataSet>
          <DataSet>
            <dataSet>
              <dataSetName>Clients Index</dataSetName>
              <dataSetGuid>356a285d-7425-4650-99da-73e0ee3b71d4</dataSetGuid>
            </dataSet>
            <endpoint>DATASET</endpoint>
            <shared>false</shared>
            <dataSources>
              <DataSource>
                <connectionType>COMMCELL</connectionType>
                <commCell>
                  <commCellName>$LocalCommCell$</commCellName>
                </commCell>
              </DataSource>
            </dataSources>
            <allColumns>false</allColumns>
            <fields>
              <Column>
                <name>sys_rowid</name>
                <dataField>$row_number$</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Data Source</name>
                <dataField>Data Source</dataField>
                <type>String</type>
              </Column>
              <Column>
                <name>Client</name>
                <dataField>Client</dataField>
                <type>String</type>
              </Column>
            </fields>
            <GetOperation>
              <parameters>
                <Parameter>
                  <name>Clients</name>
                  <dataType>Integer</dataType>
                  <isList>true</isList>
                  <values>
                    <string>=input.TeamsClients</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>ClientGroups</name>
                  <dataType>Integer</dataType>
                  <isList>true</isList>
                  <values>
                    <string>=input.ClientGroups</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>timeframe</name>
                  <dataType>DateRange</dataType>
                  <values>
                    <string>=input.Timeframe</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>Options</name>
                  <dataType>String</dataType>
                  <isList>true</isList>
                  <values>
                    <string>=input.Options</string>
                  </values>
                </Parameter>
                <Parameter>
                  <name>natimeframe</name>
                  <dataType>DateRange</dataType>
                  <values>
                    <string>=input.NATimeRange</string>
                  </values>
                </Parameter>
              </parameters>
              <sqlText>SELECT Client FROM :[Teams Clients SLA]
WHERE [Last Index Time] &lt; @natimeframe_from OR [Last Index Time] IS NULL</sqlText>
              <timeout>5</timeout>
              <postQueryFilter>true</postQueryFilter>
              <rDataSetQuery />
              <rPlotQuery />
            </GetOperation>
            <description>Backup Health Report for Office 365 Clients.</description>
            <databaseName>CommServ</databaseName>
            <queryPlan>
              <offline>false</offline>
              <retentionDays>1</retentionDays>
              <versions>
                <CommCellVersion>ALL</CommCellVersion>
              </versions>
              <dynamicCollection>false</dynamicCollection>
              <frequency>60</frequency>
              <direct>true</direct>
            </queryPlan>
            <version>45</version>
            <guid>356a285d-7425-4650-99da-73e0ee3b71d4</guid>
            <revision />
          </DataSet>
        </dataSet>
      </dataSets>
      <inputs>
        <RptInput>
          <id>CommCell</id>
          <displayName>CommCell</displayName>
          <defaultValue>2</defaultValue>
          <type>Commcell</type>
          <controlType>ListBox</controlType>
          <required>false</required>
          <allowMultipleSelection>true</allowMultipleSelection>
          <fromDataSet>true</fromDataSet>
          <dataSetEntity>
            <dataSetName>CommcellList</dataSetName>
            <dataSetGuid>36711099-c17b-4857-b2d6-2d26e52c6aec</dataSetGuid>
          </dataSetEntity>
          <labelField>CCHostName</labelField>
          <valueField>id</valueField>
          <dependsOn />
          <relativeOptions />
        </RptInput>
        <RptInput>
          <id>TeamsClients</id>
          <displayName>Teams Clients</displayName>
          <type>String</type>
          <controlType>ListBox</controlType>
          <required>false</required>
          <allowMultipleSelection>true</allowMultipleSelection>
          <hideAllSelection>true</hideAllSelection>
          <fromDataSet>true</fromDataSet>
          <dataSetEntity>
            <dataSetId>1479</dataSetId>
            <dataSetName>Teams Clients</dataSetName>
            <dataSetGuid>8d70c30b-dd2e-46af-ede9-baa4f02624cd</dataSetGuid>
          </dataSetEntity>
          <labelField>displayName</labelField>
          <valueField>id</valueField>
          <dependsOn />
          <relativeOptions />
          <sort>
            <columnId>displayName</columnId>
            <direction>Asc</direction>
          </sort>
        </RptInput>
        <RptInput>
          <id>ClientGroups</id>
          <displayName>Companies/Client Groups</displayName>
          <type>String</type>
          <controlType>ListBox</controlType>
          <required>false</required>
          <allowMultipleSelection>true</allowMultipleSelection>
          <hideAllSelection>true</hideAllSelection>
          <fromDataSet>true</fromDataSet>
          <dataSetEntity>
            <dataSetId>1480</dataSetId>
            <dataSetName>Teams Groups</dataSetName>
            <dataSetGuid>d01d625c-b2a5-4aaa-9e04-fff93e3f365a</dataSetGuid>
          </dataSetEntity>
          <labelField>groupName</labelField>
          <valueField>groupId</valueField>
          <dependsOn />
          <relativeOptions />
          <sort>
            <columnId>groupName</columnId>
            <direction>Asc</direction>
          </sort>
        </RptInput>
        <RptInput>
          <id>Timeframe</id>
          <displayName>Timeframe</displayName>
          <defaultValue>-P3D P0D</defaultValue>
          <possibleValueLabels>
            <string>Last 1 Days</string>
            <string>Last 2 Days</string>
            <string>Last 3 Days</string>
            <string>Last 7 Days</string>
            <string>Last 30 Days</string>
          </possibleValueLabels>
          <possibleValues>
            <string>-P1D P0D</string>
            <string>-P2D P0D</string>
            <string>-P3D P0D</string>
            <string>-P7D P0D</string>
            <string>-P30D P0D</string>
          </possibleValues>
          <type>DateRange</type>
          <controlType>DateRange</controlType>
          <required>false</required>
          <fromDataSet>false</fromDataSet>
          <dependsOn />
          <relativeOptions>
            <string>Last</string>
          </relativeOptions>
          <relativeUnits>
            <string>Days</string>
          </relativeUnits>
        </RptInput>
        <RptInput>
          <id>Options</id>
          <displayName>Options</displayName>
          <possibleValueLabels>
            <string>Show backup disabled clients</string>
            <string>Show all teams</string>
          </possibleValueLabels>
          <possibleValues>
            <string>Show backup disabled clients</string>
            <string>Show all teams</string>
          </possibleValues>
          <type>String</type>
          <controlType>ListBox</controlType>
          <required>false</required>
          <allowMultipleSelection>false</allowMultipleSelection>
          <fromDataSet>false</fromDataSet>
          <dependsOn />
          <relativeOptions />
        </RptInput>
        <RptInput>
          <id>NATimeRange</id>
          <displayName>Need Attention Time Range</displayName>
          <defaultValue>-P7D P0D</defaultValue>
          <possibleValueLabels>
            <string>Last 7 Days</string>
          </possibleValueLabels>
          <possibleValues>
            <string>-P7D P0D</string>
          </possibleValues>
          <type>DateRange</type>
          <controlType>DateRange</controlType>
          <required>false</required>
          <fromDataSet>false</fromDataSet>
          <hidden>true</hidden>
          <dependsOn />
          <relativeOptions>
            <string>Last</string>
          </relativeOptions>
          <relativeUnits>
            <string>Days</string>
          </relativeUnits>
        </RptInput>
      </inputs>
      <header />
      <body>{
    "reportComponents": [
        {
            "type": "HITS",
            "dataSet": {
                "dataSetId": 1431,
                "dataSetName": "Teams Clients SLA",
                "dataSetGuid": "6c4a4208-f3b3-408d-8ff0-3be774080b0b",
                "originalDataSetName": "Teams Clients SLA"
            },
            "title": {
                "text": ""
            },
            "id": "Hits1620294897429",
            "mobile": {
                "visible": "On",
                "listItemClick": {},
                "customListLayout": null
            },
            "hideComponent": false,
            "blankComponent": false,
            "filters": {
                "builder": {},
                "viewer": {}
            },
            "visible": {},
            "orientation": "vertical",
            "color": {
                "backgroundColor": "#ffffff"
            },
            "iconPosition": "left",
            "hideHeader": true,
            "measureDataField": [
                {
                    "column": "Associated Teams",
                    "type": "Long",
                    "showNumberOps": true,
                    "aggrType": "Sum",
                    "captionPosition": "top",
                    "color": {
                        "captionColor": "#000",
                        "countColor": "#000"
                    },
                    "alignment": "center",
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    },
                    "displayText": "Associated Teams"
                }
            ],
            "isGroupBy": true,
            "toolTip": "Total number of active teams associated to the client(s)",
            "additionalProperties": false
        },
        {
            "type": "HITS",
            "dataSet": {
                "dataSetId": 1508,
                "dataSetName": "Teams Clients SLA",
                "dataSetGuid": "6c4a4208-f3b3-408d-8ff0-3be774080b0b"
            },
            "title": {
                "text": ""
            },
            "id": "Hits1620294903156",
            "mobile": {
                "visible": "On",
                "listItemClick": {},
                "customListLayout": null
            },
            "hideComponent": false,
            "blankComponent": false,
            "filters": {
                "builder": {},
                "viewer": {}
            },
            "color": {
                "backgroundColor": "#ffffff"
            },
            "iconPosition": "left",
            "hideHeader": true,
            "visible": {},
            "orientation": "vertical",
            "measureDataField": [
                {
                    "column": "Teams Backed-up",
                    "type": "Long",
                    "showNumberOps": true,
                    "aggrType": "Sum",
                    "captionPosition": "top",
                    "color": {
                        "captionColor": "#000",
                        "countColor": "#000"
                    },
                    "alignment": "center",
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    },
                    "displayText": "Teams Backed-up"
                }
            ],
            "isGroupBy": true,
            "toolTip": "Total number of teams backed-up in the selected time period",
            "additionalProperties": false
        },
        {
            "type": "HITS",
            "dataSet": {
                "dataSetId": 1508,
                "dataSetName": "Teams Clients SLA",
                "dataSetGuid": "6c4a4208-f3b3-408d-8ff0-3be774080b0b"
            },
            "title": {
                "text": ""
            },
            "id": "Hits1620294915819",
            "mobile": {
                "visible": "On",
                "listItemClick": {},
                "customListLayout": null
            },
            "hideComponent": false,
            "blankComponent": false,
            "filters": {
                "builder": {},
                "viewer": {}
            },
            "color": {
                "backgroundColor": "#ffffff"
            },
            "iconPosition": "left",
            "hideHeader": true,
            "measureDataField": [
                {
                    "column": "Teams Not Backed-up",
                    "type": "Long",
                    "showNumberOps": true,
                    "aggrType": "Sum",
                    "captionPosition": "top",
                    "color": {
                        "captionColor": "#000",
                        "countColor": "#000"
                    },
                    "alignment": "center",
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    },
                    "displayText": "Teams Not Backed-up"
                }
            ],
            "isGroupBy": true,
            "toolTip": "Total number of teams not backed-up in the selected time period",
            "additionalProperties": false
        },
        {
            "type": "HITS",
            "dataSet": {
                "dataSetId": 1508,
                "dataSetName": "Teams Clients SLA",
                "dataSetGuid": "6c4a4208-f3b3-408d-8ff0-3be774080b0b",
                "originalDataSetName": "Teams Clients SLA"
            },
            "title": {
                "text": ""
            },
            "id": "Hits1623242825632",
            "mobile": {
                "visible": "On",
                "listItemClick": {},
                "customListLayout": null
            },
            "hideComponent": false,
            "blankComponent": false,
            "filters": {
                "builder": {},
                "viewer": {}
            },
            "visible": {},
            "orientation": "vertical",
            "color": {
                "backgroundColor": "#ffffff"
            },
            "iconPosition": "left",
            "hideHeader": true,
            "measureDataField": [
                {
                    "column": "Teams Backed-up (at least once)",
                    "type": "Long",
                    "showNumberOps": true,
                    "aggrType": "Sum",
                    "captionPosition": "top",
                    "color": {
                        "captionColor": "#000",
                        "countColor": "#000"
                    },
                    "alignment": "center",
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    },
                    "displayText": "Teams Backed-up (at least once)"
                }
            ],
            "isGroupBy": true,
            "toolTip": "Total number of teams backed-up at least once",
            "additionalProperties": false
        },
        {
            "type": "HITS",
            "dataSet": {
                "dataSetId": 1508,
                "dataSetName": "Teams Clients SLA",
                "dataSetGuid": "6c4a4208-f3b3-408d-8ff0-3be774080b0b"
            },
            "title": {
                "text": ""
            },
            "id": "Hits1620294919941",
            "mobile": {
                "visible": "On",
                "listItemClick": {},
                "customListLayout": null
            },
            "hideComponent": false,
            "blankComponent": false,
            "filters": {
                "builder": {},
                "viewer": {}
            },
            "color": {
                "backgroundColor": "#ffffff"
            },
            "iconPosition": "left",
            "hideHeader": true,
            "measureDataField": [
                {
                    "column": "Teams Never Backed-up",
                    "type": "Integer",
                    "showNumberOps": true,
                    "aggrType": "Sum",
                    "captionPosition": "top",
                    "color": {
                        "captionColor": "#000",
                        "countColor": "#000"
                    },
                    "alignment": "center",
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    },
                    "displayText": "Teams Never Backed-up"
                }
            ],
            "isGroupBy": true,
            "toolTip": "Total number of teams never backed-up",
            "additionalProperties": false
        },
        {
            "type": "HITS",
            "dataSet": {
                "dataSetId": 1508,
                "dataSetName": "Teams Clients SLA",
                "dataSetGuid": "6c4a4208-f3b3-408d-8ff0-3be774080b0b",
                "originalDataSetName": "Teams Clients SLA"
            },
            "title": {
                "text": ""
            },
            "id": "Hits1623242832200",
            "mobile": {
                "visible": "On",
                "listItemClick": {},
                "customListLayout": null
            },
            "hideComponent": false,
            "blankComponent": false,
            "filters": {
                "builder": {},
                "viewer": {}
            },
            "color": {
                "backgroundColor": "#ffffff"
            },
            "iconPosition": "left",
            "hideHeader": true,
            "measureDataField": [
                {
                    "column": "Teams Recently Added",
                    "type": "Long",
                    "showNumberOps": true,
                    "aggrType": "Sum",
                    "captionPosition": "top",
                    "color": {
                        "captionColor": "#000",
                        "countColor": "#000"
                    },
                    "alignment": "center",
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    },
                    "displayText": "Teams Recently Added"
                }
            ],
            "isGroupBy": true,
            "toolTip": "Teams added in the last 7 days (This is a tentative value and might not be accurate)",
            "additionalProperties": false
        },
        {
            "type": "PANEL",
            "dataSet": {},
            "title": {
                "text": ""
            },
            "id": "PanelComponent1653636715052",
            "hideHeader": true,
            "panelComponents": [
                {
                    "type": "HITS",
                    "dataSet": {
                        "dataSetId": 1502,
                        "dataSetName": "Client Discovery",
                        "dataSetGuid": "7aab2581-b37c-4255-8545-66cdb44bf560"
                    },
                    "title": {
                        "text": ""
                    },
                    "id": "Hits1653636722964",
                    "isSelected": true,
                    "mobile": {
                        "visible": "On",
                        "listItemClick": {},
                        "customListLayout": null
                    },
                    "layout": {
                        "Hits1653636722964": {
                            "desktop": {
                                "position": {
                                    "0": 0,
                                    "1": 0
                                },
                                "size": {
                                    "x": 4,
                                    "y": 2
                                }
                            }
                        }
                    },
                    "hideComponent": false,
                    "blankComponent": false,
                    "filters": {
                        "builder": {},
                        "viewer": {}
                    },
                    "visible": {},
                    "orientation": "vertical",
                    "color": {
                        "backgroundColor": "#ffffff"
                    },
                    "iconPosition": "left",
                    "hideHeader": true,
                    "measureDataField": [
                        {
                            "column": "Client",
                            "type": "String",
                            "aggrType": "Count",
                            "captionPosition": "top",
                            "color": {
                                "captionColor": "#000",
                                "countColor": "#000"
                            },
                            "alignment": "center",
                            "cellExpression": "",
                            "displayText": "Discovery Needs Attention"
                        }
                    ],
                    "isComponentLoading": false,
                    "isGroupBy": true,
                    "toolTip": "Clients with last discover time older than 7 days"
                },
                {
                    "type": "HITS",
                    "dataSet": {
                        "dataSetId": 1471,
                        "dataSetName": "Teams Clients SLA",
                        "dataSetGuid": "6c4a4208-f3b3-408d-8ff0-3be774080b0b"
                    },
                    "title": {
                        "text": ""
                    },
                    "id": "Hits1653636757562",
                    "isSelected": true,
                    "mobile": {
                        "visible": "On",
                        "listItemClick": {},
                        "customListLayout": null
                    },
                    "layout": {
                        "Hits1653636757562": {
                            "desktop": {
                                "position": {
                                    "0": 0,
                                    "1": 4
                                },
                                "size": {
                                    "x": 4,
                                    "y": 2
                                }
                            }
                        }
                    },
                    "hideComponent": false,
                    "blankComponent": false,
                    "filters": {
                        "builder": {},
                        "viewer": {}
                    },
                    "visible": {},
                    "orientation": "vertical",
                    "color": {
                        "backgroundColor": "#ffffff"
                    },
                    "iconPosition": "left",
                    "hideHeader": true,
                    "measureDataField": [
                        {
                            "column": "Teams Need Attention",
                            "type": "Integer",
                            "showNumberOps": true,
                            "aggrType": "Sum",
                            "captionPosition": "top",
                            "color": {
                                "captionColor": "#000",
                                "countColor": "#000"
                            },
                            "alignment": "center",
                            "cellExpression": "",
                            "displayText": "Teams Needs Attention"
                        }
                    ],
                    "isComponentLoading": false,
                    "isGroupBy": true,
                    "toolTip": "Teams associated to the client for at least more than 7 days and are never backed-up"
                },
                {
                    "type": "HITS",
                    "dataSet": {
                        "dataSetId": 1503,
                        "dataSetName": "Clients Index",
                        "dataSetGuid": "356a285d-7425-4650-99da-73e0ee3b71d4"
                    },
                    "title": {
                        "text": ""
                    },
                    "id": "Hits1653636774412",
                    "isSelected": false,
                    "mobile": {
                        "visible": "On",
                        "listItemClick": {},
                        "customListLayout": null
                    },
                    "layout": {
                        "Hits1653636774412": {
                            "desktop": {
                                "position": {
                                    "0": 0,
                                    "1": 8
                                },
                                "size": {
                                    "x": 4,
                                    "y": 2
                                }
                            }
                        }
                    },
                    "hideComponent": false,
                    "blankComponent": false,
                    "filters": {
                        "builder": {},
                        "viewer": {}
                    },
                    "visible": {},
                    "orientation": "vertical",
                    "color": {
                        "backgroundColor": "#ffffff"
                    },
                    "iconPosition": "left",
                    "hideHeader": true,
                    "measureDataField": [
                        {
                            "column": "Client",
                            "type": "String",
                            "aggrType": "Count",
                            "captionPosition": "top",
                            "color": {
                                "captionColor": "#000",
                                "countColor": "#000"
                            },
                            "alignment": "center",
                            "cellExpression": "",
                            "displayText": "Index Needs Attention"
                        }
                    ],
                    "isComponentLoading": false,
                    "isGroupBy": true,
                    "toolTip": "Clients with last playback time older than 7 days"
                }
            ],
            "mobile": {
                "visible": "On",
                "listItemClick": {},
                "customListLayout": null
            },
            "hideComponent": false,
            "blankComponent": false,
            "filters": {
                "builder": {},
                "viewer": {}
            },
            "visible": {
                "type": "custom",
                "expression": "=(cv.isAdminOnCommcellLevel || cv.isMspAdmin || cv.isMspUser)"
            },
            "layout": []
        },
        {
            "type": "TABLE",
            "dataSet": {
                "dataSetId": 1431,
                "dataSetName": "Teams Clients SLA",
                "dataSetGuid": "6c4a4208-f3b3-408d-8ff0-3be774080b0b"
            },
            "title": {
                "text": "Teams Clients"
            },
            "id": "Table1620183559960",
            "pageSize": "10",
            "columns": [
                {
                    "dataField": "sys_rowid",
                    "displayName": "sys_rowid",
                    "id": "sys_rowid",
                    "type": "Long",
                    "origType": "String",
                    "visible": true,
                    "hidden": true,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Data Source",
                    "displayName": "CommCell",
                    "id": "DataSource",
                    "type": "String",
                    "origType": "String",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true
                },
                {
                    "dataField": "Client",
                    "displayName": "Client",
                    "id": "Client",
                    "type": "String",
                    "origType": "",
                    "visible": true,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": ":=\nvar redirectURL = customReports.appName === \"webconsole\" ? ( location.origin + '/adminconsole/' + row['clienturl'] ) : row['clienturl']\nreturn '&lt;a href=\"'+redirectURL+'\"&gt;'+cellData+'&lt;/a&gt;'"
                },
                {
                    "dataField": "Client Status",
                    "displayName": "Client Status",
                    "id": "ClientStatus",
                    "type": "String",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Index Status",
                    "displayName": "Index Status",
                    "id": "IndexStatus",
                    "type": "String",
                    "origType": "String",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Last Indexed Backup JobId",
                    "displayName": "Last indexed backup jobid",
                    "id": "Lastindexedbackupjobid",
                    "type": "String",
                    "origType": "String",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": ":=\nvar redirectURL = customReports.appName === \"webconsole\" ? ( location.origin + '/adminconsole/' + row['joburl'] ) : row['joburl']\nreturn '&lt;a href=\"'+redirectURL+'\"&gt;'+cellData+'&lt;/a&gt;'"
                },
                {
                    "dataField": "Last index Time",
                    "displayName": "Last index time",
                    "id": "Lastindextime",
                    "type": "TimeStamp",
                    "origType": "String",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Last Index Error Time",
                    "displayName": "Last index error time",
                    "id": "Lastindexerrortime",
                    "type": "TimeStamp",
                    "origType": "String",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Last Discovery Time",
                    "displayName": "Last discovery time",
                    "id": "Lastdiscoverytime",
                    "type": "TimeStamp",
                    "origType": "TimeStamp",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Last Backup Run Time",
                    "displayName": "Last Backup Run Time",
                    "id": "LastBackupRunTime",
                    "type": "TimeStamp",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Last Backup Job ID",
                    "displayName": "Last Backup Job ID",
                    "id": "LastBackupJobID",
                    "type": "String",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": ":=\nvar redirectURL = customReports.appName === \"webconsole\" ? ( location.origin + '/adminconsole/' + row['backupjoburl'] ) : row['backupjoburl']\nreturn '&lt;a href=\"'+redirectURL+'\"&gt;'+cellData+'&lt;/a&gt;'"
                },
                {
                    "dataField": "Associated Teams",
                    "displayName": "Associated Teams",
                    "id": "AssociatedTeams",
                    "type": "Long",
                    "origType": "",
                    "visible": true,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    }
                },
                {
                    "dataField": "Teams Backed-up",
                    "displayName": "Teams Backed-up",
                    "id": "TeamsBackedup",
                    "type": "Long",
                    "origType": "",
                    "visible": true,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    }
                },
                {
                    "dataField": "Teams Not Backed-up",
                    "displayName": "Teams Not Backed-up",
                    "id": "TeamsNotBackedup",
                    "type": "Long",
                    "origType": "",
                    "visible": true,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    }
                },
                {
                    "dataField": "Teams Never Backed-up",
                    "displayName": "Teams Never Backed-up",
                    "id": "TeamsNeverBackedup",
                    "type": "Integer",
                    "origType": "",
                    "visible": true,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    }
                },
                {
                    "dataField": "Teams Backed-up (at least once)",
                    "displayName": "Teams Backed-up (at least once)",
                    "id": "TeamsBackedupatleastonce",
                    "type": "Long",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Teams Recently Added",
                    "displayName": "Teams Recently Added",
                    "id": "TeamsRecentlyAdded",
                    "type": "Long",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Teams Need Attention",
                    "displayName": "Teams Need Attention",
                    "id": "TeamsNeedAttention",
                    "type": "Integer",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Application Size",
                    "displayName": "Application Size",
                    "id": "ApplicationSize",
                    "type": "Long",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": {
                        "type": "size",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    }
                },
                {
                    "dataField": "Number of Items",
                    "displayName": "Number of Items",
                    "id": "NumberofItems",
                    "type": "Long",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    }
                },
                {
                    "dataField": "Indexed Items",
                    "displayName": "Indexed Items",
                    "id": "IndexedItems",
                    "type": "Long",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    }
                },
                {
                    "dataField": "Azure Apps Associated",
                    "displayName": "Azure Apps Associated",
                    "id": "AzureAppsAssociated",
                    "type": "Integer",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Azure Apps Not Authorized",
                    "displayName": "Azure Apps Not Authorized",
                    "id": "AzureAppsNotAuthorized",
                    "type": "Integer",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Azure Apps To Be Added",
                    "displayName": "Azure Apps To Be Added",
                    "id": "AzureAppsToBeAdded",
                    "type": "Integer",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Last Verify Connection Time",
                    "displayName": "Last Verify Connection Time",
                    "id": "LastVerifyConnectionTime",
                    "type": "TimeStamp",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Max Streams",
                    "displayName": "Max Streams",
                    "id": "MaxStreams",
                    "type": "Integer",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Access Node Group",
                    "displayName": "Access Node Group",
                    "id": "AccessNodeGroup",
                    "type": "String",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": ":=\nif ((cv.isAdminOnCommcellLevel || cv.isMspAdmin || cv.isMspUser) &amp;&amp; cellData !== \"\")\n{\n\tvar redirectURL = customReports.appName === \"webconsole\" ? ( location.origin + '/adminconsole/' + row['accessNodeGroupUrl'] ) : row['accessNodeGroupUrl']\n\treturn '&lt;a href=\"'+redirectURL+'\"&gt;'+cellData+'&lt;/a&gt;'\n}\nelse\n{\n    return \"N/A\"\n}"
                },
                {
                    "dataField": "Index Server",
                    "displayName": "Index Server",
                    "id": "IndexServer",
                    "type": "String",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": ":=\nif ((cv.isAdminOnCommcellLevel || cv.isMspAdmin || cv.isMspUser) &amp;&amp; cellData !== \"\")\n{\n\tvar redirectURL = customReports.appName === \"webconsole\" ? ( location.origin + '/adminconsole/' + row['indexserverurl'] ) : row['indexserverurl']\n\treturn '&lt;a href=\"'+redirectURL+'\"&gt;'+cellData+'&lt;/a&gt;'\n}\nelse\n{\n    return \"N/A\"\n}"
                },
                {
                    "dataField": "Active Jobs",
                    "displayName": "Active Jobs",
                    "id": "ActiveJobs",
                    "type": "String",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": ":=\nvar redirectURL = customReports.appName === \"webconsole\" ? ( location.origin + '/adminconsole/' + row['activejobsurl'] ) : row['activejobsurl']\nreturn '&lt;a href=\"'+redirectURL+'\"&gt;'+cellData+'&lt;/a&gt;'"
                },
                {
                    "dataField": "joburl",
                    "displayName": "joburl",
                    "id": "joburl",
                    "type": "String",
                    "origType": "String",
                    "visible": true,
                    "hidden": true,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true
                },
                {
                    "dataField": "backupjoburl",
                    "displayName": "backupjoburl",
                    "id": "backupjoburl",
                    "type": "String",
                    "origType": "",
                    "visible": true,
                    "hidden": true,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": false
                },
                {
                    "dataField": "clienturl",
                    "displayName": "clienturl",
                    "id": "clienturl",
                    "type": "String",
                    "origType": "",
                    "visible": true,
                    "hidden": true,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": false
                },
                {
                    "dataField": "activejobsurl",
                    "displayName": "activejobsurl",
                    "id": "activejobsurl",
                    "type": "String",
                    "origType": "",
                    "visible": true,
                    "hidden": true,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": false
                },
                {
                    "dataField": "accessNodeGroupUrl",
                    "displayName": "accessNodeGroupUrl",
                    "id": "accessNodeGroupUrl",
                    "type": "String",
                    "origType": "",
                    "visible": true,
                    "hidden": true,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": false,
                    "additionalProperties": false
                },
                {
                    "dataField": "indexserverurl",
                    "displayName": "indexserverurl",
                    "id": "indexserverurl",
                    "type": "String",
                    "origType": "",
                    "visible": true,
                    "hidden": true,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": false
                }
            ],
            "allColumns": true,
            "dataSetName": "",
            "styles": {
                "chartPlotOptions": {
                    "isShowGridlines": true,
                    "isSmoothLines": true,
                    "isShowLineMarkers": true,
                    "autoConvertYValues": true,
                    "isShowLabels": false,
                    "legendPosition": "right"
                }
            },
            "mobile": {
                "visible": "On",
                "listItemClick": {},
                "customListLayout": null
            },
            "hideComponent": false,
            "blankComponent": false,
            "filters": {
                "builder": {},
                "viewer": {}
            },
            "visible": {},
            "orientation": "vertical",
            "showFilterByDefault": false,
            "enableHorizontalScroll": false
        },
        {
            "type": "TABLE",
            "dataSet": {
                "dataSetName": "Teams Entities SLA",
                "dataSetGuid": "805e0d37-b6a8-4979-9878-bc6b2102f8b6",
                "originalDataSetName": ""
            },
            "title": {
                "text": ":= return (rpt.input.Options === 'Show all teams' ? 'Teams' : 'Teams Not Backed-up')"
            },
            "id": "Table1617968131441",
            "pageSize": 20,
            "columns": [
                {
                    "dataField": "sys_rowid",
                    "displayName": "sys_rowid",
                    "id": "sys_rowid",
                    "type": "Long",
                    "origType": "String",
                    "visible": true,
                    "hidden": true,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Data Source",
                    "displayName": "CommCell",
                    "id": "DataSource",
                    "type": "String",
                    "origType": "String",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": false
                },
                {
                    "dataField": "Name",
                    "displayName": "Name",
                    "id": "Name",
                    "type": "Integer",
                    "origType": "String",
                    "visible": true,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Email Address",
                    "displayName": "Email Address",
                    "id": "EmailAddress",
                    "type": "Integer",
                    "origType": "String",
                    "visible": true,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Last Backup",
                    "displayName": "Last backup",
                    "id": "Lastbackup",
                    "type": "Integer",
                    "origType": "String",
                    "visible": true,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": false
                },
                {
                    "dataField": "Last Backup Status",
                    "displayName": "Last Backup Status",
                    "id": "LastBackupStatus",
                    "type": "Integer",
                    "origType": "",
                    "visible": true,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Failure Reason",
                    "displayName": "Failure Reason",
                    "id": "FailureReason",
                    "type": "Integer",
                    "origType": "String",
                    "visible": true,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Last Backup attempt",
                    "displayName": "Last backup attempt",
                    "id": "Lastbackupattempt",
                    "type": "Integer",
                    "origType": "TimeStamp",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Last Backup Attempt JobId",
                    "displayName": "Last Backup Attempt JobId",
                    "id": "LastBackupAttemptJobId",
                    "type": "Integer",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Client",
                    "displayName": "Client",
                    "id": "Client",
                    "type": "Integer",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Added to content on",
                    "displayName": "Added to content on",
                    "id": "Addedtocontenton",
                    "type": "Integer",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    }
                },
                {
                    "dataField": "Backup Size",
                    "displayName": "Backup Size",
                    "id": "BackupSize",
                    "type": "Integer",
                    "origType": "",
                    "visible": true,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": {
                        "type": "size",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    }
                },
                {
                    "dataField": "Number Of Items",
                    "displayName": "Number Of Items",
                    "id": "NumberOfItems",
                    "type": "Integer",
                    "origType": "Long",
                    "visible": true,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    }
                },
                {
                    "dataField": "Failed Items",
                    "displayName": "Failed Items",
                    "id": "FailedItems",
                    "type": "Integer",
                    "origType": "",
                    "visible": false,
                    "hidden": false,
                    "aggrType": "None",
                    "mobileOptions": {
                        "visible": true,
                        "viewOnList": true,
                        "viewOnDetail": true
                    },
                    "isSelected": true,
                    "additionalProperties": false,
                    "cellExpression": {
                        "type": "number",
                        "source": "bytes",
                        "target": "relative",
                        "fmt": "comma",
                        "customformat": "",
                        "tofixed": 2,
                        "customDateFormat": "",
                        "targetWindow": "_blank",
                        "srcTimezone": "GMT"
                    }
                }
            ],
            "allColumns": true,
            "dataSetName": "",
            "styles": {
                "chartPlotOptions": {
                    "isShowGridlines": true,
                    "isSmoothLines": true,
                    "isShowLineMarkers": true,
                    "autoConvertYValues": true,
                    "isShowLabels": false,
                    "legendPosition": "right"
                }
            },
            "mobile": {
                "visible": "On",
                "listItemClick": {},
                "customListLayout": null
            },
            "hideComponent": false,
            "blankComponent": false,
            "filters": {
                "builder": {},
                "viewer": {}
            },
            "showFilterByDefault": false,
            "enableHorizontalScroll": false,
            "visible": {
                "type": "custom",
                "expression": "=!((rpt.input.TeamsClients == \"\" || rpt.input.TeamsClients == \"[]\") &amp;&amp; (rpt.input.ClientGroups == \"\" || rpt.input.ClientGroups == \"[]\"))"
            },
            "orientation": "vertical"
        }
    ],
    "filters": {
        "builder": {},
        "viewer": {}
    },
    "autoRefreshTime": 10,
    "reportLayout": {
        "gridsterOpts": {
            "columns": 12
        },
        "Table1617968131441": {
            "mobile": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    16,
                    0
                ]
            },
            "tablet": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    16,
                    0
                ]
            },
            "desktop": {
                "size": {
                    "x": 12,
                    "y": 3
                },
                "position": [
                    16,
                    0
                ]
            }
        },
        "Table1620183559960": {
            "mobile": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    8,
                    0
                ]
            },
            "tablet": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    8,
                    0
                ]
            },
            "desktop": {
                "size": {
                    "x": 12,
                    "y": 9
                },
                "position": [
                    7,
                    0
                ]
            }
        },
        "Hits1620294897429": {
            "mobile": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    0,
                    0
                ]
            },
            "tablet": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    0,
                    0
                ]
            },
            "desktop": {
                "size": {
                    "x": 4,
                    "y": 2
                },
                "position": [
                    0,
                    0
                ]
            }
        },
        "Hits1620294903156": {
            "mobile": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    0,
                    3
                ]
            },
            "tablet": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    0,
                    3
                ]
            },
            "desktop": {
                "size": {
                    "x": 4,
                    "y": 2
                },
                "position": [
                    0,
                    4
                ]
            }
        },
        "Hits1620294915819": {
            "mobile": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    0,
                    6
                ]
            },
            "tablet": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    0,
                    6
                ]
            },
            "desktop": {
                "size": {
                    "x": 4,
                    "y": 2
                },
                "position": [
                    0,
                    8
                ]
            }
        },
        "Hits1620294919941": {
            "mobile": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    0,
                    9
                ]
            },
            "tablet": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    0,
                    9
                ]
            },
            "desktop": {
                "size": {
                    "x": 4,
                    "y": 2
                },
                "position": [
                    2,
                    4
                ]
            }
        },
        "Hits1623242825632": {
            "mobile": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    2,
                    0
                ]
            },
            "tablet": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    2,
                    0
                ]
            },
            "desktop": {
                "size": {
                    "x": 4,
                    "y": 2
                },
                "position": [
                    2,
                    0
                ]
            }
        },
        "Hits1623242832200": {
            "mobile": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    2,
                    8
                ]
            },
            "tablet": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    2,
                    8
                ]
            },
            "desktop": {
                "size": {
                    "x": 4,
                    "y": 2
                },
                "position": [
                    2,
                    8
                ]
            }
        },
        "PanelComponent1653636715052": {
            "mobile": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    4,
                    0
                ]
            },
            "tablet": {
                "size": {
                    "x": 4,
                    "y": 8
                },
                "position": [
                    4,
                    0
                ]
            },
            "desktop": {
                "size": {
                    "x": 12,
                    "y": 3
                },
                "position": [
                    4,
                    0
                ]
            }
        }
    }
}</body>
      <footer />
    </Page>
  </pages>
  <reportVersion>144</reportVersion>
  <deployedVersion>144</deployedVersion>
  <reportDescription>Backup Health Report for Office 365 Clients.</reportDescription>
  <guid>23734002-f1be-4f95-8232-84042da555ec</guid>
  <revision>$Revision: 1.1.2.15 $</revision>
  <icon>vertical-bar.png</icon>
  <customIcon />
  <hidden>false</hidden>
  <visibleAll>false</visibleAll>
  <readOnly>false</readOnly>
  <shareable>false</shareable>
  <engineVersion>1</engineVersion>
  <builderVersion>2</builderVersion>
  <translations>
    <Translations>
      <locale>default</locale>
      <localeKey>RPT_TITLE</localeKey>
      <localeValue>Office365 Backup Health</localeValue>
    </Translations>
    <Translations>
      <locale>default</locale>
      <localeKey>RPT_DESCRIPTION</localeKey>
      <localeValue>Backup Health Report for Office 365 Clients.</localeValue>
    </Translations>
  </translations>
  <cvTranslations>
    <Translation locale="de" localeKey="Client Name" localeValue="Clientname" />
    <Translation locale="de" localeKey="Completed with errors" localeValue="Mit Fehlern fertiggestellt" />
    <Translation locale="de" localeKey="Data Source" localeValue="Data Source" />
    <Translation locale="de" localeKey="Email Address" localeValue="E-Mail-Adresse" />
    <Translation locale="de" localeKey="Exchange" localeValue="Exchange" />
    <Translation locale="de" localeKey="Exchange Client Groups" localeValue="Exchange Clientgruppen" />
    <Translation locale="de" localeKey="Exchange Clients" localeValue="Exchange-Clients" />
    <Translation locale="de" localeKey="Failed" localeValue="Fehlgeschlagen" />
    <Translation locale="de" localeKey="Failure Reason" localeValue="Fehlerursache" />
    <Translation locale="de" localeKey="Last backup" localeValue="Letzte Sicherung" />
    <Translation locale="de" localeKey="Last backup attempt" localeValue="Letzter Sicherungsversuch" />
    <Translation locale="de" localeKey="Last backup attempt job Id" localeValue="Job-ID des letzten Sicherungsversuchs" />
    <Translation locale="de" localeKey="Mailbox Size" localeValue="Postfachgr&#246;&#223;e" />
    <Translation locale="de" localeKey="Mailbox Status" localeValue="Mailbox Status" />
    <Translation locale="de" localeKey="Mailbox Type" localeValue="Postfachtyp" />
    <Translation locale="de" localeKey="Name" localeValue="Name" />
    <Translation locale="de" localeKey="Not backed up" localeValue="Not backed up" />
    <Translation locale="de" localeKey="Number of Emails" localeValue="Anzahl der E-Mails" />
    <Translation locale="de" localeKey="Number of Items" localeValue="Anzahl der Objekte" />
    <Translation locale="de" localeKey="Office365 SLA Report" localeValue="Office365 SLA-Bericht" />
    <Translation locale="de" localeKey="OneDrive" localeValue="OneDrive" />
    <Translation locale="de" localeKey="OneDrive Client Groups" localeValue="OneDrive Clientgruppen" />
    <Translation locale="de" localeKey="OneDrive Clients" localeValue="OneDrive-Clients" />
    <Translation locale="de" localeKey="Skipped" localeValue="&#220;bersprungen" />
    <Translation locale="de" localeKey="SLA by Clients" localeValue="SLA nach Clients" />
    <Translation locale="de" localeKey="SLA by Mailboxes" localeValue="SLA nach Postf&#228;cher" />
    <Translation locale="de" localeKey="SLA by Users" localeValue="SLA nach Benutzer" />
    <Translation locale="de" localeKey="SLA Status" localeValue="SLA Status" />
    <Translation locale="de" localeKey="Successful" localeValue="Erfolgreich" />
    <Translation locale="de" localeKey="Summary by Clients" localeValue="Zusammenfassung nach Clients" />
    <Translation locale="de" localeKey="Summary by Mailboxes" localeValue="Zusammenfassung nach Postf&#228;cher" />
    <Translation locale="de" localeKey="Summary by Users" localeValue="Zusammenfassung nach Benutzer" />
    <Translation locale="de" localeKey="Suspended" localeValue="Ausgesetzt" />
    <Translation locale="de" localeKey="sys_rowid" localeValue="sys_rowid" />
    <Translation locale="de" localeKey="Time frame" localeValue="Zeitraum" />
    <Translation locale="de" localeKey="Timeframe" localeValue="Zeitraum" />
    <Translation locale="de" localeKey="Total Mailboxes" localeValue="Postf&#228;cher insgesamt" />
    <Translation locale="de" localeKey="Total Users" localeValue="Benutzer insgesamt" />
    <Translation locale="de" localeKey="User Size" localeValue="Benutzergr&#246;&#223;e" />
    <Translation locale="de" localeKey="User Status" localeValue="Benutzerstatus" />
    <Translation locale="es" localeKey="Client Name" localeValue="Client - Nombre" />
    <Translation locale="es" localeKey="Completed with errors" localeValue="Completado con errores" />
    <Translation locale="es" localeKey="Data Source" localeValue="Origen de Datos" />
    <Translation locale="es" localeKey="Email Address" localeValue="Direcci&#243;n de Email " />
    <Translation locale="es" localeKey="Exchange" localeValue="Exchange" />
    <Translation locale="es" localeKey="Exchange Client Groups" localeValue="Grupos de Clientes Exchange " />
    <Translation locale="es" localeKey="Exchange Clients" localeValue="Clientes Exchange" />
    <Translation locale="es" localeKey="Failed" localeValue="Fallido" />
    <Translation locale="es" localeKey="Failure Reason" localeValue="Raz&#243;n de Fallido" />
    <Translation locale="es" localeKey="Last backup" localeValue="&#218;ltima Copia de Seguridad" />
    <Translation locale="es" localeKey="Last backup attempt" localeValue="&#218;ltimo Intento de Copia de Seguridad" />
    <Translation locale="es" localeKey="Last backup attempt job Id" localeValue="ID de Tarea de &#218;ltimo Intento de Copia de Seguridad" />
    <Translation locale="es" localeKey="Mailbox Size" localeValue="Tama&#241;o de Buz&#243;n" />
    <Translation locale="es" localeKey="Mailbox Status" localeValue="Estado de Buz&#243;n" />
    <Translation locale="es" localeKey="Mailbox Type" localeValue="Tipo de Buz&#243;n" />
    <Translation locale="es" localeKey="Name" localeValue="Nombre" />
    <Translation locale="es" localeKey="Not backed up" localeValue="No respaldado" />
    <Translation locale="es" localeKey="Number of Emails" localeValue="N&#250;mero de Emails" />
    <Translation locale="es" localeKey="Number of Items" localeValue="N&#250;mero de Elementos" />
    <Translation locale="es" localeKey="Office365 SLA Report" localeValue="Informe SLA Office365 " />
    <Translation locale="es" localeKey="OneDrive" localeValue="OneDrive" />
    <Translation locale="es" localeKey="OneDrive Client Groups" localeValue="Grupos de Cliente OneDrive " />
    <Translation locale="es" localeKey="OneDrive Clients" localeValue="Clientes de OneDrive" />
    <Translation locale="es" localeKey="Skipped" localeValue="Omitido" />
    <Translation locale="es" localeKey="SLA by Clients" localeValue="SLA por Clientes" />
    <Translation locale="es" localeKey="SLA by Mailboxes" localeValue="SLA por Buzones" />
    <Translation locale="es" localeKey="SLA by Users" localeValue="SLA por Usuarios" />
    <Translation locale="es" localeKey="SLA Status" localeValue="SLA - Estado" />
    <Translation locale="es" localeKey="Successful" localeValue="Con &#201;xito" />
    <Translation locale="es" localeKey="Summary by Clients" localeValue="Resumen por Clientes" />
    <Translation locale="es" localeKey="Summary by Mailboxes" localeValue="Resumen por Buzones" />
    <Translation locale="es" localeKey="Summary by Users" localeValue="Resumen por Usuarios" />
    <Translation locale="es" localeKey="Suspended" localeValue="Suspendido" />
    <Translation locale="es" localeKey="sys_rowid" localeValue="sys_rowid" />
    <Translation locale="es" localeKey="Time frame" localeValue="Plazo de Tiempo" />
    <Translation locale="es" localeKey="Timeframe" localeValue="Plazo de Tiempo" />
    <Translation locale="es" localeKey="Total Mailboxes" localeValue="Buzones Totales" />
    <Translation locale="es" localeKey="Total Users" localeValue="Usuarios Totales" />
    <Translation locale="es" localeKey="User Size" localeValue="Tama&#241;o de Usuario" />
    <Translation locale="es" localeKey="User Status" localeValue="Estado de Usuario" />
    <Translation locale="es_MX" localeKey="Client Name" localeValue="Client - Nombre" />
    <Translation locale="es_MX" localeKey="Completed with errors" localeValue="Completada con errores" />
    <Translation locale="es_MX" localeKey="Data Source" localeValue="Origen de Datos" />
    <Translation locale="es_MX" localeKey="Email Address" localeValue="Direcci&#243;n de Email " />
    <Translation locale="es_MX" localeKey="Exchange" localeValue="Exchange" />
    <Translation locale="es_MX" localeKey="Exchange Client Groups" localeValue="Grupos de Clientes Exchange " />
    <Translation locale="es_MX" localeKey="Exchange Clients" localeValue="Clientes Exchange" />
    <Translation locale="es_MX" localeKey="Failed" localeValue="Fallido" />
    <Translation locale="es_MX" localeKey="Failure Reason" localeValue="Raz&#243;n de Fallido" />
    <Translation locale="es_MX" localeKey="Last backup" localeValue="&#218;ltima Copia de Seguridad" />
    <Translation locale="es_MX" localeKey="Last backup attempt" localeValue="&#218;ltimo Intento de Copia de Seguridad" />
    <Translation locale="es_MX" localeKey="Last backup attempt job Id" localeValue="ID de Tarea de &#218;ltimo Intento de Copia de Seguridad" />
    <Translation locale="es_MX" localeKey="Mailbox Size" localeValue="Tama&#241;o de Buz&#243;n" />
    <Translation locale="es_MX" localeKey="Mailbox Status" localeValue="Estado de Buz&#243;n" />
    <Translation locale="es_MX" localeKey="Mailbox Type" localeValue="Tipo de Buz&#243;n" />
    <Translation locale="es_MX" localeKey="Name" localeValue="Nombre" />
    <Translation locale="es_MX" localeKey="Not backed up" localeValue="No respaldado" />
    <Translation locale="es_MX" localeKey="Number of Emails" localeValue="N&#250;mero de Emails" />
    <Translation locale="es_MX" localeKey="Number of Items" localeValue="N&#250;mero de Elementos" />
    <Translation locale="es_MX" localeKey="Office365 SLA Report" localeValue="Informe SLA Office365 " />
    <Translation locale="es_MX" localeKey="OneDrive" localeValue="OneDrive" />
    <Translation locale="es_MX" localeKey="OneDrive Client Groups" localeValue="Grupos de Cliente OneDrive " />
    <Translation locale="es_MX" localeKey="OneDrive Clients" localeValue="Clientes de OneDrive" />
    <Translation locale="es_MX" localeKey="Skipped" localeValue="Omitido" />
    <Translation locale="es_MX" localeKey="SLA by Clients" localeValue="SLA por Clientes" />
    <Translation locale="es_MX" localeKey="SLA by Mailboxes" localeValue="SLA por Buzones" />
    <Translation locale="es_MX" localeKey="SLA by Users" localeValue="SLA por Usuarios" />
    <Translation locale="es_MX" localeKey="SLA Status" localeValue="SLA - Estado" />
    <Translation locale="es_MX" localeKey="Successful" localeValue="Con &#201;xito" />
    <Translation locale="es_MX" localeKey="Summary by Clients" localeValue="Resumen por Clientes" />
    <Translation locale="es_MX" localeKey="Summary by Mailboxes" localeValue="Resumen por Buzones" />
    <Translation locale="es_MX" localeKey="Summary by Users" localeValue="Resumen por Usuarios" />
    <Translation locale="es_MX" localeKey="Suspended" localeValue="Suspendido" />
    <Translation locale="es_MX" localeKey="sys_rowid" localeValue="sys_rowid" />
    <Translation locale="es_MX" localeKey="Time frame" localeValue="Plazo de Tiempo" />
    <Translation locale="es_MX" localeKey="Timeframe" localeValue="Plazo de Tiempo" />
    <Translation locale="es_MX" localeKey="Total Mailboxes" localeValue="Buzones Totales" />
    <Translation locale="es_MX" localeKey="Total Users" localeValue="Usuarios Totales" />
    <Translation locale="es_MX" localeKey="User Size" localeValue="Tama&#241;o de Usuario" />
    <Translation locale="es_MX" localeKey="User Status" localeValue="Estado de Usuario" />
    <Translation locale="fr" localeKey="Client Name" localeValue="Nom du client" />
    <Translation locale="fr" localeKey="Completed with errors" localeValue="Termin&#233; avec des erreurs" />
    <Translation locale="fr" localeKey="Data Source" localeValue="Source de donn&#233;es" />
    <Translation locale="fr" localeKey="Email Address" localeValue="Adresse Email " />
    <Translation locale="fr" localeKey="Exchange" localeValue="Exchange" />
    <Translation locale="fr" localeKey="Exchange Client Groups" localeValue="Groupes de clients Exchange " />
    <Translation locale="fr" localeKey="Exchange Clients" localeValue="Clients Exchange" />
    <Translation locale="fr" localeKey="Failed" localeValue="&#201;chec" />
    <Translation locale="fr" localeKey="Failure Reason" localeValue="Raison de l'&#233;chec" />
    <Translation locale="fr" localeKey="Last backup" localeValue="Derni&#232;re sauvegarde" />
    <Translation locale="fr" localeKey="Last backup attempt" localeValue="Derni&#232;re tentative de sauvegarde " />
    <Translation locale="fr" localeKey="Last backup attempt job Id" localeValue="Id de la derni&#232;re tentative de sauvegarde " />
    <Translation locale="fr" localeKey="Mailbox Size" localeValue="Taille de la bo&#238;te aux lettres" />
    <Translation locale="fr" localeKey="Mailbox Status" localeValue="&#201;tat de la bo&#238;te aux lettres" />
    <Translation locale="fr" localeKey="Mailbox Type" localeValue="Type de la bo&#238;te aux lettres" />
    <Translation locale="fr" localeKey="Name" localeValue="Nom" />
    <Translation locale="fr" localeKey="Not backed up" localeValue="Non sauvegard&#233;" />
    <Translation locale="fr" localeKey="Number of Emails" localeValue="Nombre d'emails" />
    <Translation locale="fr" localeKey="Number of Items" localeValue="Nombre d'&#233;l&#233;ments" />
    <Translation locale="fr" localeKey="Office365 SLA Report" localeValue="Rapport du SLA d'Office365" />
    <Translation locale="fr" localeKey="OneDrive" localeValue="OneDrive" />
    <Translation locale="fr" localeKey="OneDrive Client Groups" localeValue="Groupes de clients OneDrive" />
    <Translation locale="fr" localeKey="OneDrive Clients" localeValue="Clients OneDrive" />
    <Translation locale="fr" localeKey="Skipped" localeValue="Ignor&#233;" />
    <Translation locale="fr" localeKey="SLA by Clients" localeValue="SLA par clients" />
    <Translation locale="fr" localeKey="SLA by Mailboxes" localeValue="SLA par bo&#238;tes aux lettres" />
    <Translation locale="fr" localeKey="SLA by Users" localeValue="SLA par les utilisateurs" />
    <Translation locale="fr" localeKey="SLA Status" localeValue="&#201;tat de SLA" />
    <Translation locale="fr" localeKey="Successful" localeValue="R&#233;ussi" />
    <Translation locale="fr" localeKey="Summary by Clients" localeValue="R&#233;capitulation par clients" />
    <Translation locale="fr" localeKey="Summary by Mailboxes" localeValue="R&#233;capitulation par bo&#238;tes aux lettres" />
    <Translation locale="fr" localeKey="Summary by Users" localeValue="R&#233;capitulation par utilisateurs " />
    <Translation locale="fr" localeKey="Suspended" localeValue="Suspendu" />
    <Translation locale="fr" localeKey="sys_rowid" localeValue="sys_rowid" />
    <Translation locale="fr" localeKey="Time frame" localeValue="Plage horaire" />
    <Translation locale="fr" localeKey="Timeframe" localeValue="Plagehoraire" />
    <Translation locale="fr" localeKey="Total Mailboxes" localeValue="Total des bo&#238;tes aux lettres" />
    <Translation locale="fr" localeKey="Total Users" localeValue="Total des utilisateurs " />
    <Translation locale="fr" localeKey="User Size" localeValue="Taille de l'utilisateur" />
    <Translation locale="fr" localeKey="User Status" localeValue="&#201;tat de l'utilisateur" />
    <Translation locale="fr_CA" localeKey="Client Name" localeValue="Nom du client" />
    <Translation locale="fr_CA" localeKey="Completed with errors" localeValue="Termin&#233; avec des erreurs" />
    <Translation locale="fr_CA" localeKey="Data Source" localeValue="Source de donn&#233;es" />
    <Translation locale="fr_CA" localeKey="Email Address" localeValue="Adresse Email " />
    <Translation locale="fr_CA" localeKey="Exchange" localeValue="Exchange" />
    <Translation locale="fr_CA" localeKey="Exchange Client Groups" localeValue="Groupes de clients Exchange " />
    <Translation locale="fr_CA" localeKey="Exchange Clients" localeValue="Clients Exchange" />
    <Translation locale="fr_CA" localeKey="Failed" localeValue="&#201;chec" />
    <Translation locale="fr_CA" localeKey="Failure Reason" localeValue="Raison de l'&#233;chec" />
    <Translation locale="fr_CA" localeKey="Last backup" localeValue="Derni&#232;re sauvegarde" />
    <Translation locale="fr_CA" localeKey="Last backup attempt" localeValue="Derni&#232;re tentative de sauvegarde " />
    <Translation locale="fr_CA" localeKey="Last backup attempt job Id" localeValue="Id de la derni&#232;re tentative de sauvegarde " />
    <Translation locale="fr_CA" localeKey="Mailbox Size" localeValue="Taille de la bo&#238;te aux lettres" />
    <Translation locale="fr_CA" localeKey="Mailbox Status" localeValue="&#201;tat de la bo&#238;te aux lettres" />
    <Translation locale="fr_CA" localeKey="Mailbox Type" localeValue="Type de la bo&#238;te aux lettres" />
    <Translation locale="fr_CA" localeKey="Name" localeValue="Nom" />
    <Translation locale="fr_CA" localeKey="Not backed up" localeValue="Non sauvegard&#233;" />
    <Translation locale="fr_CA" localeKey="Number of Emails" localeValue="Nombre d'emails" />
    <Translation locale="fr_CA" localeKey="Number of Items" localeValue="Nombre d'&#233;l&#233;ments" />
    <Translation locale="fr_CA" localeKey="Office365 SLA Report" localeValue="Rapport du SLA d'Office365" />
    <Translation locale="fr_CA" localeKey="OneDrive" localeValue="OneDrive" />
    <Translation locale="fr_CA" localeKey="OneDrive Client Groups" localeValue="Groupes de clients OneDrive" />
    <Translation locale="fr_CA" localeKey="OneDrive Clients" localeValue="Clients OneDrive" />
    <Translation locale="fr_CA" localeKey="Skipped" localeValue="Ignor&#233;" />
    <Translation locale="fr_CA" localeKey="SLA by Clients" localeValue="SLA par clients" />
    <Translation locale="fr_CA" localeKey="SLA by Mailboxes" localeValue="SLA par bo&#238;tes aux lettres" />
    <Translation locale="fr_CA" localeKey="SLA by Users" localeValue="SLA par les utilisateurs" />
    <Translation locale="fr_CA" localeKey="SLA Status" localeValue="&#201;tat de SLA" />
    <Translation locale="fr_CA" localeKey="Successful" localeValue="R&#233;ussi" />
    <Translation locale="fr_CA" localeKey="Summary by Clients" localeValue="R&#233;capitulation par clients" />
    <Translation locale="fr_CA" localeKey="Summary by Mailboxes" localeValue="R&#233;capitulation par bo&#238;tes aux lettres" />
    <Translation locale="fr_CA" localeKey="Summary by Users" localeValue="R&#233;capitulation par utilisateurs " />
    <Translation locale="fr_CA" localeKey="Suspended" localeValue="Suspendu" />
    <Translation locale="fr_CA" localeKey="sys_rowid" localeValue="sys_rowid" />
    <Translation locale="fr_CA" localeKey="Time frame" localeValue="Plage horaire" />
    <Translation locale="fr_CA" localeKey="Timeframe" localeValue="Plagehoraire" />
    <Translation locale="fr_CA" localeKey="Total Mailboxes" localeValue="Total des bo&#238;tes aux lettres" />
    <Translation locale="fr_CA" localeKey="Total Users" localeValue="Total des utilisateurs " />
    <Translation locale="fr_CA" localeKey="User Size" localeValue="Taille de l'utilisateur" />
    <Translation locale="fr_CA" localeKey="User Status" localeValue="&#201;tat de l'utilisateur" />
    <Translation locale="ja" localeKey="Client Name" localeValue="&#12463;&#12521;&#12452;&#12450;&#12531;&#12488;&#21517;" />
    <Translation locale="ja" localeKey="Data Source" localeValue="&#12487;&#12540;&#12479;&#12477;&#12540;&#12473;" />
    <Translation locale="ja" localeKey="Email Address" localeValue="&#38651;&#23376;&#12513;&#12540;&#12523;&#12450;&#12489;&#12524;&#12473;" />
    <Translation locale="ja" localeKey="Exchange" localeValue="Exchange" />
    <Translation locale="ja" localeKey="Exchange Client Groups" localeValue="Exchange&#12463;&#12521;&#12452;&#12450;&#12531;&#12488;&#12464;&#12523;&#12540;&#12503;" />
    <Translation locale="ja" localeKey="Exchange Clients" localeValue="Exchange&#12463;&#12521;&#12452;&#12450;&#12531;&#12488;" />
    <Translation locale="ja" localeKey="Failed" localeValue="&#22833;&#25943;" />
    <Translation locale="ja" localeKey="Failure Reason" localeValue="&#12456;&#12521;&#12540;&#29702;&#30001;" />
    <Translation locale="ja" localeKey="Last backup" localeValue="&#26368;&#24460;&#12398;&#12496;&#12483;&#12463;&#12450;&#12483;&#12503;" />
    <Translation locale="ja" localeKey="Last backup attempt" localeValue="&#26368;&#24460;&#12398;&#12496;&#12483;&#12463;&#12450;&#12483;&#12503;&#12398;&#35430;&#34892;" />
    <Translation locale="ja" localeKey="Last backup attempt job Id" localeValue="&#26368;&#24460;&#12398;&#12496;&#12483;&#12463;&#12450;&#12483;&#12503;&#35430;&#34892;&#12472;&#12519;&#12502;ID" />
    <Translation locale="ja" localeKey="Mailbox Size" localeValue="&#12513;&#12540;&#12523;&#12508;&#12483;&#12463;&#12473;&#12398;&#12469;&#12452;&#12474;" />
    <Translation locale="ja" localeKey="Mailbox Status" localeValue="&#12513;&#12540;&#12523;&#12508;&#12483;&#12463;&#12473;&#12398;&#12473;&#12486;&#12540;&#12479;&#12473;" />
    <Translation locale="ja" localeKey="Mailbox Type" localeValue="&#12513;&#12540;&#12523;&#12508;&#12483;&#12463;&#12473;&#12479;&#12452;&#12503;" />
    <Translation locale="ja" localeKey="Name" localeValue="&#21517;&#21069;" />
    <Translation locale="ja" localeKey="Not backed up" localeValue="&#12496;&#12483;&#12463;&#12450;&#12483;&#12503;&#12373;&#12428;&#12390;&#12356;&#12414;&#12379;&#12435;" />
    <Translation locale="ja" localeKey="Number of Emails" localeValue="&#12513;&#12540;&#12523;&#12398;&#25968;" />
    <Translation locale="ja" localeKey="Number of Items" localeValue="&#12450;&#12452;&#12486;&#12512;&#25968;" />
    <Translation locale="ja" localeKey="Office365 SLA Report" localeValue="Office365 SLA &#12524;&#12509;&#12540;&#12488;" />
    <Translation locale="ja" localeKey="OneDrive" localeValue="OneDrive" />
    <Translation locale="ja" localeKey="OneDrive Client Groups" localeValue="OneDrive&#12463;&#12521;&#12452;&#12450;&#12531;&#12488;&#12464;&#12523;&#12540;&#12503;" />
    <Translation locale="ja" localeKey="OneDrive Clients" localeValue="OneDrive&#12463;&#12521;&#12452;&#12450;&#12531;&#12488;" />
    <Translation locale="ja" localeKey="Skipped" localeValue="&#12473;&#12461;&#12483;&#12503;" />
    <Translation locale="ja" localeKey="SLA by Clients" localeValue="&#12463;&#12521;&#12452;&#12450;&#12531;&#12488;&#21029;SLA" />
    <Translation locale="ja" localeKey="SLA by Mailboxes" localeValue="&#12513;&#12540;&#12523;&#12508;&#12483;&#12463;&#12473;&#21029;SLA" />
    <Translation locale="ja" localeKey="SLA by Users" localeValue="&#12518;&#12540;&#12470;&#12540;&#21029;SLA" />
    <Translation locale="ja" localeKey="SLA Status" localeValue="SLA&#12473;&#12486;&#12540;&#12479;&#12473;" />
    <Translation locale="ja" localeKey="Successful" localeValue="&#25104;&#21151;" />
    <Translation locale="ja" localeKey="Summary by Clients" localeValue="&#12463;&#12521;&#12452;&#12450;&#12531;&#12488;&#21029;&#12398;&#27010;&#35201;" />
    <Translation locale="ja" localeKey="Summary by Mailboxes" localeValue="&#12513;&#12540;&#12523;&#12508;&#12483;&#12463;&#12473;&#21029;&#12398;&#27010;&#35201;" />
    <Translation locale="ja" localeKey="Summary by Users" localeValue="&#12518;&#12540;&#12470;&#12540;&#21029;&#12398;&#27010;&#35201;" />
    <Translation locale="ja" localeKey="Suspended" localeValue="&#19968;&#26178;&#20572;&#27490;" />
    <Translation locale="ja" localeKey="sys_rowid" localeValue="sys_rowid" />
    <Translation locale="ja" localeKey="Time frame" localeValue="&#26178;&#38291;&#26528;" />
    <Translation locale="ja" localeKey="Timeframe" localeValue="&#26178;&#38291;&#26528;" />
    <Translation locale="ja" localeKey="Total Mailboxes" localeValue="&#12513;&#12540;&#12523;&#12508;&#12483;&#12463;&#12473;&#12398;&#32207;&#25968;" />
    <Translation locale="ja" localeKey="Total Users" localeValue="&#21512;&#35336;&#12518;&#12540;&#12470;&#12540;&#25968;" />
    <Translation locale="ja" localeKey="User Size" localeValue="&#12518;&#12540;&#12470;&#12540;&#12469;&#12452;&#12474;" />
    <Translation locale="ja" localeKey="User Status" localeValue="&#12518;&#12540;&#12470;&#12540;&#12473;&#12486;&#12540;&#12479;&#12473;" />
    <Translation locale="ko" localeKey="Client Name" localeValue="&#53364;&#46972;&#51060;&#50616;&#53944; &#51060;&#47492;" />
    <Translation locale="ko" localeKey="Completed with errors" localeValue="&#50724;&#47448;&#50752; &#54632;&#44760; &#50756;&#47308;&#46120;" />
    <Translation locale="ko" localeKey="Data Source" localeValue="&#45936;&#51060;&#53552; &#50896;&#48376;" />
    <Translation locale="ko" localeKey="Email Address" localeValue="Email &#51452;&#49548;" />
    <Translation locale="ko" localeKey="Exchange" localeValue="Exchange" />
    <Translation locale="ko" localeKey="Exchange Client Groups" localeValue="Exchange &#53364;&#46972;&#51060;&#50616;&#53944; &#44536;&#47353;" />
    <Translation locale="ko" localeKey="Exchange Clients" localeValue="Exchange &#53364;&#46972;&#51060;&#50616;&#53944;" />
    <Translation locale="ko" localeKey="Failed" localeValue="&#49892;&#54056;" />
    <Translation locale="ko" localeKey="Failure Reason" localeValue="&#49892;&#54056; &#51060;&#50976;" />
    <Translation locale="ko" localeKey="Last backup" localeValue="&#47560;&#51648;&#47561; &#48177;&#50629;" />
    <Translation locale="ko" localeKey="Last backup attempt" localeValue="&#47560;&#51648;&#47561; &#48177;&#50629; &#49884;&#46020;" />
    <Translation locale="ko" localeKey="Last backup attempt job Id" localeValue="&#47560;&#51648;&#47561; &#48177;&#50629; &#49884;&#46020; &#51089;&#50629; ID" />
    <Translation locale="ko" localeKey="Mailbox Size" localeValue="&#49324;&#49436;&#54632; &#53356;&#44592;" />
    <Translation locale="ko" localeKey="Mailbox Status" localeValue="&#49324;&#49436;&#54632; &#49345;&#53468;" />
    <Translation locale="ko" localeKey="Mailbox Type" localeValue="&#49324;&#49436;&#54632; &#50976;&#54805;" />
    <Translation locale="ko" localeKey="Number of Emails" localeValue="&#51060;&#47700;&#51068; &#49688;" />
    <Translation locale="ko" localeKey="Number of Items" localeValue="&#54637;&#47785; &#49688;" />
    <Translation locale="ko" localeKey="Office365 SLA Report" localeValue="Office365 SLA &#48372;&#44256;&#49436;" />
    <Translation locale="ko" localeKey="OneDrive" localeValue="OneDrive" />
    <Translation locale="ko" localeKey="OneDrive Client Groups" localeValue="OneDrive &#53364;&#46972;&#51060;&#50616;&#53944; &#44536;&#47353;" />
    <Translation locale="ko" localeKey="OneDrive Clients" localeValue="OneDrive &#53364;&#46972;&#51060;&#50616;&#53944;" />
    <Translation locale="ko" localeKey="Skipped" localeValue="&#44148;&#45320;&#46848;" />
    <Translation locale="ko" localeKey="Suspended" localeValue="&#51068;&#49884; &#51473;&#45800;&#46120;" />
    <Translation locale="ko" localeKey="Time frame" localeValue="&#49884;&#44036; &#54532;&#47112;&#51076;" />
    <Translation locale="ko" localeKey="Timeframe" localeValue="&#49884;&#44036; &#54532;&#47112;&#51076;&#09;" />
    <Translation locale="ko" localeKey="Total Mailboxes" localeValue="&#52509; &#49324;&#49436;&#54632;" />
    <Translation locale="ko" localeKey="Total Users" localeValue="&#52509; &#49324;&#50857;&#51088;" />
    <Translation locale="ko" localeKey="User Size" localeValue="&#49324;&#50857;&#51088; &#53356;&#44592;" />
    <Translation locale="ko" localeKey="User Status" localeValue="&#49324;&#50857;&#51088; &#49345;&#53468;" />
    <Translation locale="ru" localeKey="Client Name" localeValue="&#1048;&#1084;&#1103; &#1082;&#1083;&#1080;&#1077;&#1085;&#1090;&#1072;" />
    <Translation locale="ru" localeKey="Completed with errors" localeValue="&#1047;&#1072;&#1074;&#1077;&#1088;&#1096;&#1077;&#1085;&#1086; &#1089; &#1086;&#1096;&#1080;&#1073;&#1082;&#1072;&#1084;&#1080;" />
    <Translation locale="ru" localeKey="Data Source" localeValue="&#1048;&#1089;&#1090;&#1086;&#1095;&#1085;&#1080;&#1082; &#1076;&#1072;&#1085;&#1085;&#1099;&#1093;" />
    <Translation locale="ru" localeKey="Email Address" localeValue="&#1040;&#1076;&#1088;&#1077;&#1089; &#1101;&#1083;. &#1087;&#1086;&#1095;&#1090;&#1099;" />
    <Translation locale="ru" localeKey="Exchange" localeValue="Exchange" />
    <Translation locale="ru" localeKey="Exchange Client Groups" localeValue="&#1043;&#1088;&#1091;&#1087;&#1087;&#1099; &#1082;&#1083;&#1080;&#1077;&#1085;&#1090;&#1086;&#1074; Exchange" />
    <Translation locale="ru" localeKey="Exchange Clients" localeValue="&#1050;&#1083;&#1080;&#1077;&#1085;&#1090;&#1099; Exchange" />
    <Translation locale="ru" localeKey="Failed" localeValue="&#1053;&#1077; &#1074;&#1099;&#1087;&#1086;&#1083;&#1085;&#1077;&#1085;&#1086;" />
    <Translation locale="ru" localeKey="Failure Reason" localeValue="&#1055;&#1088;&#1080;&#1095;&#1080;&#1085;&#1072; &#1089;&#1073;&#1086;&#1103;" />
    <Translation locale="ru" localeKey="Last backup" localeValue="&#1055;&#1086;&#1089;&#1083;&#1077;&#1076;&#1085;&#1077;&#1077; &#1088;&#1077;&#1079;&#1077;&#1088;&#1074;&#1085;&#1086;&#1077; &#1082;&#1086;&#1087;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1080;&#1077;" />
    <Translation locale="ru" localeKey="Last backup attempt" localeValue="&#1055;&#1086;&#1089;&#1083;&#1077;&#1076;&#1085;&#1103;&#1103; &#1087;&#1086;&#1087;&#1099;&#1090;&#1082;&#1072; &#1088;&#1077;&#1079;&#1077;&#1088;&#1074;&#1085;&#1086;&#1075;&#1086; &#1082;&#1086;&#1087;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1080;&#1103;" />
    <Translation locale="ru" localeKey="Last backup attempt job Id" localeValue="&#1048;&#1076;&#1077;&#1085;&#1090;&#1080;&#1092;&#1080;&#1082;&#1072;&#1090;&#1086;&#1088; &#1079;&#1072;&#1076;&#1072;&#1085;&#1080;&#1103; &#1087;&#1086;&#1089;&#1083;&#1077;&#1076;&#1085;&#1077;&#1081; &#1087;&#1086;&#1087;&#1099;&#1090;&#1082;&#1080; &#1088;&#1077;&#1079;&#1077;&#1088;&#1074;&#1085;&#1086;&#1075;&#1086; &#1082;&#1086;&#1087;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1080;&#1103;" />
    <Translation locale="ru" localeKey="Mailbox Size" localeValue="&#1056;&#1072;&#1079;&#1084;&#1077;&#1088; &#1087;&#1086;&#1095;&#1090;&#1086;&#1074;&#1086;&#1075;&#1086; &#1103;&#1097;&#1080;&#1082;&#1072;" />
    <Translation locale="ru" localeKey="Mailbox Status" localeValue="&#1057;&#1086;&#1089;&#1090;&#1086;&#1103;&#1085;&#1080;&#1077; &#1087;&#1086;&#1095;&#1090;&#1086;&#1074;&#1086;&#1075;&#1086; &#1103;&#1097;&#1080;&#1082;&#1072;" />
    <Translation locale="ru" localeKey="Mailbox Type" localeValue="&#1058;&#1080;&#1087; &#1087;&#1086;&#1095;&#1090;&#1086;&#1074;&#1086;&#1075;&#1086; &#1103;&#1097;&#1080;&#1082;&#1072;" />
    <Translation locale="ru" localeKey="Name" localeValue="&#1048;&#1084;&#1103;" />
    <Translation locale="ru" localeKey="Not backed up" localeValue="&#1056;&#1077;&#1079;&#1077;&#1088;&#1074;&#1085;&#1072;&#1103; &#1082;&#1086;&#1087;&#1080;&#1103; &#1085;&#1077; &#1089;&#1086;&#1079;&#1076;&#1072;&#1085;&#1072;" />
    <Translation locale="ru" localeKey="Number of Emails" localeValue="&#1050;&#1086;&#1083;&#1080;&#1095;&#1077;&#1089;&#1090;&#1074;&#1086; &#1089;&#1086;&#1086;&#1073;&#1097;&#1077;&#1085;&#1080;&#1081; &#1101;&#1083;. &#1087;&#1086;&#1095;&#1090;&#1099;" />
    <Translation locale="ru" localeKey="Number of Items" localeValue="&#1050;&#1086;&#1083;&#1080;&#1095;&#1077;&#1089;&#1090;&#1074;&#1086; &#1101;&#1083;&#1077;&#1084;&#1077;&#1085;&#1090;&#1086;&#1074;" />
    <Translation locale="ru" localeKey="Office365 SLA Report" localeValue="&#1054;&#1090;&#1095;&#1077;&#1090; SLA Office365 " />
    <Translation locale="ru" localeKey="OneDrive" localeValue="OneDrive" />
    <Translation locale="ru" localeKey="OneDrive Client Groups" localeValue="&#1043;&#1088;&#1091;&#1087;&#1087;&#1099; &#1082;&#1083;&#1080;&#1077;&#1085;&#1090;&#1086;&#1074; OneDrive " />
    <Translation locale="ru" localeKey="OneDrive Clients" localeValue="&#1050;&#1083;&#1080;&#1077;&#1085;&#1090;&#1099; OneDrive " />
    <Translation locale="ru" localeKey="Skipped" localeValue="&#1055;&#1088;&#1086;&#1087;&#1091;&#1097;&#1077;&#1085;&#1086;" />
    <Translation locale="ru" localeKey="SLA by Clients" localeValue="SLA &#1087;&#1086; &#1082;&#1083;&#1080;&#1077;&#1085;&#1090;&#1072;&#1084;" />
    <Translation locale="ru" localeKey="SLA by Mailboxes" localeValue="SLA &#1087;&#1086; &#1087;&#1086;&#1095;&#1090;&#1086;&#1074;&#1099;&#1084; &#1103;&#1097;&#1080;&#1082;&#1072;&#1084;" />
    <Translation locale="ru" localeKey="SLA by Users" localeValue="SLA &#1087;&#1086; &#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1103;&#1084;" />
    <Translation locale="ru" localeKey="SLA Status" localeValue="&#1057;&#1086;&#1089;&#1090;&#1086;&#1103;&#1085;&#1080;&#1077; SLA " />
    <Translation locale="ru" localeKey="Successful" localeValue="&#1059;&#1089;&#1087;&#1077;&#1096;&#1085;&#1086;" />
    <Translation locale="ru" localeKey="Summary by Clients" localeValue="&#1057;&#1074;&#1086;&#1076;&#1082;&#1072; &#1087;&#1086; &#1082;&#1083;&#1080;&#1077;&#1085;&#1090;&#1072;&#1084;" />
    <Translation locale="ru" localeKey="Summary by Mailboxes" localeValue="&#1057;&#1074;&#1086;&#1076;&#1082;&#1072; &#1087;&#1086; &#1087;&#1086;&#1095;&#1090;&#1086;&#1074;&#1099;&#1084; &#1103;&#1097;&#1080;&#1082;&#1072;&#1084;" />
    <Translation locale="ru" localeKey="Summary by Users" localeValue="&#1057;&#1074;&#1086;&#1076;&#1082;&#1072; &#1087;&#1086; &#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1103;&#1084;" />
    <Translation locale="ru" localeKey="Suspended" localeValue="&#1055;&#1088;&#1080;&#1086;&#1089;&#1090;&#1072;&#1085;&#1086;&#1074;&#1083;&#1077;&#1085;&#1086;" />
    <Translation locale="ru" localeKey="sys_rowid" localeValue="sys_rowid" />
    <Translation locale="ru" localeKey="Time frame" localeValue="&#1048;&#1085;&#1090;&#1077;&#1088;&#1074;&#1072;&#1083; &#1074;&#1088;&#1077;&#1084;&#1077;&#1085;&#1080;" />
    <Translation locale="ru" localeKey="Timeframe" localeValue="&#1042;&#1088;&#1077;&#1084;&#1077;&#1085;&#1085;&#1086;&#1081; &#1080;&#1085;&#1090;&#1077;&#1088;&#1074;&#1072;&#1083;" />
    <Translation locale="ru" localeKey="Total Mailboxes" localeValue="&#1042;&#1089;&#1077;&#1075;&#1086; &#1087;&#1086;&#1095;&#1090;&#1086;&#1074;&#1099;&#1093; &#1103;&#1097;&#1080;&#1082;&#1086;&#1074;" />
    <Translation locale="ru" localeKey="Total Users" localeValue="&#1042;&#1089;&#1077;&#1075;&#1086; &#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1077;&#1081;" />
    <Translation locale="ru" localeKey="User Size" localeValue="&#1056;&#1072;&#1079;&#1084;&#1077;&#1088; &#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1103;" />
    <Translation locale="ru" localeKey="User Status" localeValue="&#1057;&#1086;&#1089;&#1090;&#1086;&#1103;&#1085;&#1080;&#1077; &#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1103;" />
    <Translation locale="zh" localeKey="Client Name" localeValue="&#23458;&#25143;&#31471;&#21517;&#31216;" />
    <Translation locale="zh" localeKey="Completed with errors" localeValue="&#24102;&#38169;&#23436;&#25104;" />
    <Translation locale="zh" localeKey="Data Source" localeValue="&#25968;&#25454;&#28304;" />
    <Translation locale="zh" localeKey="Email Address" localeValue="Email &#22320;&#22336;" />
    <Translation locale="zh" localeKey="Exchange" localeValue="Exchange" />
    <Translation locale="zh" localeKey="Exchange Client Groups" localeValue="Exchange &#23458;&#25143;&#31471;&#32452;" />
    <Translation locale="zh" localeKey="Exchange Clients" localeValue="Exchange &#23458;&#25143;&#31471;" />
    <Translation locale="zh" localeKey="Failed" localeValue="&#22833;&#36133;" />
    <Translation locale="zh" localeKey="Failure Reason" localeValue="&#22833;&#36133;&#21407;&#22240;" />
    <Translation locale="zh" localeKey="Last backup" localeValue="&#19978;&#27425;&#22791;&#20221;" />
    <Translation locale="zh" localeKey="Last backup attempt" localeValue="&#19978;&#27425;&#22791;&#20221;&#23581;&#35797;" />
    <Translation locale="zh" localeKey="Last backup attempt job Id" localeValue="&#19978;&#27425;&#22791;&#20221;&#23581;&#35797;&#20316;&#19994;ID" />
    <Translation locale="zh" localeKey="Mailbox Size" localeValue="&#37038;&#31665;&#22823;&#23567;" />
    <Translation locale="zh" localeKey="Mailbox Status" localeValue="&#37038;&#31665;&#29366;&#24577;" />
    <Translation locale="zh" localeKey="Mailbox Type" localeValue="&#37038;&#31665;&#31867;&#22411;" />
    <Translation locale="zh" localeKey="Name" localeValue="&#21517;&#31216;" />
    <Translation locale="zh" localeKey="Not backed up" localeValue="&#26410;&#22791;&#20221;" />
    <Translation locale="zh" localeKey="Number of Emails" localeValue="&#37038;&#20214;&#25968;&#30446;" />
    <Translation locale="zh" localeKey="Number of Items" localeValue="&#39033;&#30446;&#25968;" />
    <Translation locale="zh" localeKey="Office365 SLA Report" localeValue="Office365 SLA &#25253;&#21578;" />
    <Translation locale="zh" localeKey="OneDrive" localeValue="OneDrive" />
    <Translation locale="zh" localeKey="OneDrive Client Groups" localeValue="OneDrive &#23458;&#25143;&#31471;&#32452;" />
    <Translation locale="zh" localeKey="OneDrive Clients" localeValue="OneDrive &#23458;&#25143;&#31471;" />
    <Translation locale="zh" localeKey="Skipped" localeValue="&#36339;&#36807;" />
    <Translation locale="zh" localeKey="SLA by Clients" localeValue="SLA &#25353;&#23458;&#25143;&#31471;" />
    <Translation locale="zh" localeKey="SLA by Mailboxes" localeValue="SLA &#25353;&#37038;&#31665;" />
    <Translation locale="zh" localeKey="SLA by Users" localeValue="SLA &#25353;&#29992;&#25143;" />
    <Translation locale="zh" localeKey="SLA Status" localeValue="SLA &#29366;&#24577;" />
    <Translation locale="zh" localeKey="Successful" localeValue="&#25104;&#21151;" />
    <Translation locale="zh" localeKey="Summary by Clients" localeValue="&#23458;&#25143;&#31471;" />
    <Translation locale="zh" localeKey="Summary by Mailboxes" localeValue="&#37038;&#31665;&#24635;&#32467;" />
    <Translation locale="zh" localeKey="Summary by Users" localeValue="&#29992;&#25143;&#24635;&#32467;" />
    <Translation locale="zh" localeKey="Suspended" localeValue="&#24050;&#26242;&#20572;" />
    <Translation locale="zh" localeKey="sys_rowid" localeValue="sys_rowid" />
    <Translation locale="zh" localeKey="Time frame" localeValue="&#22823;&#20307;&#26102;&#38388;" />
    <Translation locale="zh" localeKey="Timeframe" localeValue="&#22823;&#20307;&#26102;&#38388;" />
    <Translation locale="zh" localeKey="Total Mailboxes" localeValue="&#25152;&#26377;&#37038;&#31665;" />
    <Translation locale="zh" localeKey="Total Users" localeValue="&#25152;&#26377;&#29992;&#25143;" />
    <Translation locale="zh" localeKey="User Size" localeValue="&#29992;&#25143;&#22823;&#23567;" />
    <Translation locale="zh" localeKey="User Status" localeValue="&#29992;&#25143;&#29366;&#24577;" />
    <Translation locale="zh_TW" localeKey="Client Name" localeValue="&#23458;&#25142;&#31471;&#21517;&#31281;" />
    <Translation locale="zh_TW" localeKey="Completed with errors" localeValue="&#24118;&#37679;&#23436;&#25104;" />
    <Translation locale="zh_TW" localeKey="Data Source" localeValue="&#25976;&#25818;&#28304;" />
    <Translation locale="ja" localeKey="Completed with errors" localeValue="&#12456;&#12521;&#12540;&#12354;&#12426;&#12391;&#23436;&#20102;" />
    <Translation locale="ko" localeKey="Name" localeValue="&#51060;&#47492;" />
    <Translation locale="ko" localeKey="Not backed up" localeValue="&#48177;&#50629;&#46104;&#51648; &#50506;&#51020;" />
    <Translation locale="ko" localeKey="SLA by Clients" localeValue="&#53364;&#46972;&#51060;&#50616;&#53944;&#48324; SLA " />
    <Translation locale="ko" localeKey="SLA by Mailboxes" localeValue="&#49324;&#49436;&#54632;&#48324; SLA" />
    <Translation locale="ko" localeKey="SLA by Users" localeValue="&#49324;&#50857;&#51088;&#48324; SLA" />
    <Translation locale="ko" localeKey="SLA Status" localeValue="SLA &#49345;&#53468;" />
    <Translation locale="ko" localeKey="Summary by Clients" localeValue="&#53364;&#46972;&#51060;&#50616;&#53944;&#48324; &#50836;&#50557;" />
    <Translation locale="ko" localeKey="Summary by Mailboxes" localeValue="&#49324;&#49436;&#54632;&#48324; &#50836;&#50557;" />
    <Translation locale="ko" localeKey="Summary by Users" localeValue="&#49324;&#50857;&#51088;&#48324; &#50836;&#50557;" />
    <Translation locale="ko" localeKey="sys_rowid" localeValue="sys_rowid" />
    <Translation locale="zh_TW" localeKey="Email Address" localeValue="Email &#22320;&#22336;" />
    <Translation locale="zh_TW" localeKey="Number of Emails" localeValue="&#38651;&#23376;&#37109;&#20214;&#25976;&#37327;" />
    <Translation locale="zh_TW" localeKey="OneDrive Client Groups" localeValue="OneDrive &#23458;&#25142;&#31471;&#32068;" />
    <Translation locale="zh_TW" localeKey="Exchange" localeValue="Exchange" />
    <Translation locale="zh_TW" localeKey="Exchange Client Groups" localeValue="Exchange &#23458;&#25142;&#31471;&#32068;" />
    <Translation locale="zh_TW" localeKey="Exchange Clients" localeValue="Exchange &#23458;&#25143;&#31471;" />
    <Translation locale="zh_TW" localeKey="Failed" localeValue="&#22833;&#25943;" />
    <Translation locale="zh_TW" localeKey="Mailbox Status" localeValue="&#37109;&#31665;&#29376;&#24907;" />
    <Translation locale="zh_TW" localeKey="OneDrive" localeValue="OneDrive" />
    <Translation locale="zh_TW" localeKey="SLA Status" localeValue="SLA &#29376;&#24907;" />
    <Translation locale="zh_TW" localeKey="Successful" localeValue="&#25104;&#21151;&#30340;" />
    <Translation locale="zh_TW" localeKey="Suspended" localeValue="&#26283;&#20572;" />
    <Translation locale="zh_TW" localeKey="User Status" localeValue="&#29992;&#25142;&#29376;&#24907;" />
    <Translation locale="zh_TW" localeKey="sys_rowid" localeValue="sys_rowid" />
    <Translation locale="zh_TW" localeKey="Last backup" localeValue="&#19978;&#27425;&#20633;&#20221;" />
    <Translation locale="zh_TW" localeKey="Mailbox Type" localeValue="&#37109;&#31665;&#39006;&#22411;" />
    <Translation locale="de" localeKey="Active Jobs" localeValue="Aktive Jobs" />
    <Translation locale="de" localeKey="activejobsurl" localeValue="AktiveJobsURL" />
    <Translation locale="de" localeKey="Added to content on" localeValue="Wurde dem Inhalt hinzugef&#252;gt am" />
    <Translation locale="de" localeKey="Advanced" localeValue="Erweitert" />
    <Translation locale="de" localeKey="Application Size" localeValue="Anwendungsgr&#246;&#223;e" />
    <Translation locale="de" localeKey="Associated Mailboxes" localeValue="Zugeordnete Postf&#228;cher" />
    <Translation locale="de" localeKey="Associated Sites" localeValue="Zugeordnete Sites" />
    <Translation locale="de" localeKey="Associated Teams" localeValue="Zugeordnete Teams" />
    <Translation locale="de" localeKey="Associated Users" localeValue="Zugeordnete Benutzer" />
    <Translation locale="de" localeKey="Azure Apps Associated" localeValue="Zugeordnete Azure Apps" />
    <Translation locale="de" localeKey="Azure Apps To Be Added" localeValue="Hinzuzuf&#252;gende Azure Apps" />
    <Translation locale="de" localeKey="Backup Size" localeValue="Sicherungsgr&#246;&#223;e" />
    <Translation locale="de" localeKey="Backup Status" localeValue="Sicherungsstatus" />
    <Translation locale="de" localeKey="Client Groups" localeValue="Clientgruppen" />
    <Translation locale="de" localeKey="clienturl" localeValue="clienturl" />
    <Translation locale="de" localeKey="Failed Items" localeValue="Fehlgeschlagene Objekte" />
    <Translation locale="de" localeKey="Index Status" localeValue="Index-Status" />
    <Translation locale="de" localeKey="Indexed Emails" localeValue="Indizierte E-Mails" />
    <Translation locale="de" localeKey="Indexed Items" localeValue="Indizierte Objekte" />
    <Translation locale="de" localeKey="joburl" localeValue="joburl" />
    <Translation locale="de" localeKey="Last Backup Attempt JobId" localeValue="Letzter Sicherungsversuch JobID" />
    <Translation locale="de" localeKey="Last discovery time" localeValue="Letzter Ermittlungszeitpunkt" />
    <Translation locale="de" localeKey="Last index error time" localeValue="Zeitpunkt des letzten Indexfehlers" />
    <Translation locale="de" localeKey="Last index time" localeValue="Letzter Indexzeitpunkt" />
    <Translation locale="de" localeKey="Last indexed backup jobid" localeValue="Zuletzt indizierte SicherungsjobID" />
    <Translation locale="de" localeKey="Mailboxes Backed-up (at least once)" localeValue="Gesicherte Postf&#228;cher (mind. einmal)" />
    <Translation locale="de" localeKey="Mailboxes Meeting SLA" localeValue="Postf&#228;cher, welche das SLA erf&#252;llen" />
    <Translation locale="de" localeKey="Mailboxes Missing SLA" localeValue="Postf&#228;cher, welche das SLA verpassen" />
    <Translation locale="de" localeKey="Mailboxes Need Attention" localeValue="Postf&#228;cher, welche Ihre Aufmerksamkeit erfordern" />
    <Translation locale="de" localeKey="Mailboxes Never Backed-up" localeValue="Nie gesicherte Postf&#228;cher" />
    <Translation locale="de" localeKey="Mailboxes Not Meeting SLA" localeValue="Postf&#228;cher, welche das SLA verpassen" />
    <Translation locale="de" localeKey="Mailboxes Recently Added" localeValue="K&#252;rzlich hinzugef&#252;gte Postf&#228;cher" />
    <Translation locale="de" localeKey="Max Streams" localeValue="Max. Streams" />
    <Translation locale="de" localeKey="Not Processed Items" localeValue="Nicht verarbeitete Objekte" />
    <Translation locale="de" localeKey="Not Processed Mailboxes" localeValue="Nicht verarbeitete Postf&#228;cher" />
    <Translation locale="de" localeKey="Number Of Items" localeValue="Anzahl der Objekte" />
    <Translation locale="de" localeKey="Options" localeValue="Optionen" />
    <Translation locale="de" localeKey="SharePoint" localeValue="SharePoint" />
    <Translation locale="de" localeKey="SharePoint Clients" localeValue="SharePoint-Clients" />
    <Translation locale="de" localeKey="Site URL" localeValue="Site-URL" />
    <Translation locale="de" localeKey="Sites Backed-up (at least once)" localeValue="Gesicherte Sites (mind. einmal)" />
    <Translation locale="de" localeKey="Sites Meeting SLA" localeValue="Sites, welche das SLA erf&#252;llen" />
    <Translation locale="de" localeKey="Sites Missing SLA" localeValue="Sites, welche das SLA erf&#252;llen" />
    <Translation locale="de" localeKey="Sites Need Attention" localeValue="Sites, welche Ihre Aufmerksamkeit erfordern" />
    <Translation locale="de" localeKey="Sites Never Backed-up" localeValue="Nie gesicherte Sites" />
    <Translation locale="de" localeKey="Sites Not Meeting SLA" localeValue="Sites, welche das SLA verpassen" />
    <Translation locale="de" localeKey="Sites Recently Added" localeValue="K&#252;rzlich hinzugef&#252;gte Sites" />
    <Translation locale="de" localeKey="SLA Status for Exchange Clients" localeValue="SLA-Status der Exchange Clients" />
    <Translation locale="de" localeKey="SLA Status for OneDrive Clients" localeValue="SLA-Status der OneDrive Clients" />
    <Translation locale="de" localeKey="SLA Status for SharePoint Clients" localeValue="SLA-Status der SharePoint Clients" />
    <Translation locale="de" localeKey="SLA Status for Teams Clients" localeValue="SLA-Status der Teams Clients" />
    <Translation locale="de" localeKey="Teams" localeValue="Teams" />
    <Translation locale="de" localeKey="Teams Backed-up (at least once)" localeValue="Gesicherte Teams (mind. einmal)" />
    <Translation locale="de" localeKey="Teams Clients" localeValue="Teams-Clients" />
    <Translation locale="de" localeKey="Teams Meeting SLA" localeValue="Teams, welche das SLA erf&#252;llen" />
    <Translation locale="de" localeKey="Teams Missing SLA" localeValue="Teams, welche das SLA verpassen" />
    <Translation locale="de" localeKey="Teams Need Attention" localeValue="Teams, welche Ihre Aufmerksamkeit erfordern" />
    <Translation locale="de" localeKey="Teams Never Backed-up" localeValue="Nie gesicherte Teams" />
    <Translation locale="de" localeKey="Teams Not Meeting SLA" localeValue="Teams, welche das SLA verpassen" />
    <Translation locale="de" localeKey="Teams Recently Added" localeValue="K&#252;rzlich gesicherte Teams" />
    <Translation locale="de" localeKey="Users Backed-up (at least once)" localeValue="Gesicherte Benutzer (mind. einmal)" />
    <Translation locale="de" localeKey="Users Meeting SLA" localeValue="Benutzer, welche das SLA erf&#252;llen" />
    <Translation locale="de" localeKey="Users Missing SLA" localeValue="Benutzer, welche das SLA verpassen" />
    <Translation locale="de" localeKey="Users Need Attention" localeValue="Benutzer, welche Ihre Aufmerksamkeit erfordern" />
    <Translation locale="de" localeKey="Users Never Backed-up" localeValue="Nie gesicherte Benutzer" />
    <Translation locale="de" localeKey="Users Not Meeting SLA" localeValue="Benutzer, welche das SLA verpassen" />
    <Translation locale="de" localeKey="Users Recently Added" localeValue="K&#252;rzlich hinzugef&#252;gte Benutzer" />
    <Translation locale="es" localeKey="Active Jobs" localeValue="Tareas Activas" />
    <Translation locale="es" localeKey="activejobsurl" localeValue="urldetareasactivas" />
    <Translation locale="es" localeKey="Added to content on" localeValue="Agregado a contenido en" />
    <Translation locale="es" localeKey="Advanced" localeValue="Avanzado" />
    <Translation locale="es" localeKey="Application Size" localeValue="Tama&#241;o de Aplicaci&#243;n" />
    <Translation locale="es" localeKey="Associated Mailboxes" localeValue="Buzones Asociados" />
    <Translation locale="es" localeKey="Associated Sites" localeValue="Sitios Asociados" />
    <Translation locale="es" localeKey="Associated Teams" localeValue="Teams Asociadas" />
    <Translation locale="es" localeKey="Associated Users" localeValue="Usuarios Asociados" />
    <Translation locale="es" localeKey="Azure Apps Associated" localeValue="Azure Apps Asociados" />
    <Translation locale="es" localeKey="Azure Apps To Be Added" localeValue="Azure Apps A Ser Agregados" />
    <Translation locale="es" localeKey="Backup Size" localeValue="Tama&#241;o de Copia de Seguridad" />
    <Translation locale="es" localeKey="Backup Status" localeValue="Estado de Copia de Seguridad" />
    <Translation locale="es" localeKey="Client Groups" localeValue="Grupo de Cliente" />
    <Translation locale="es" localeKey="clienturl" localeValue="clienteurl" />
    <Translation locale="es" localeKey="Failed Items" localeValue="Elementos fallidos" />
    <Translation locale="es" localeKey="Index Status" localeValue="Estado de &#205;ndice" />
    <Translation locale="es" localeKey="Indexed Emails" localeValue="Emails Indexados" />
    <Translation locale="es" localeKey="Indexed Items" localeValue="Elementos Indexados" />
    <Translation locale="es" localeKey="joburl" localeValue="tareaurl" />
    <Translation locale="es" localeKey="Last Backup Attempt JobId" localeValue="&#218;ltimo Intento de Copia de Seguridad ID de Tarea" />
    <Translation locale="es" localeKey="Last discovery time" localeValue="&#218;ltima hora de descubrimiento" />
    <Translation locale="es" localeKey="Last index error time" localeValue="Hora del &#218;ltimo Error de &#205;ndice" />
    <Translation locale="es" localeKey="Last index time" localeValue="&#218;ltima Hora del &#205;ndice" />
    <Translation locale="es" localeKey="Last indexed backup jobid" localeValue="&#218;ltima copia de seguridad indexada id de tarea" />
    <Translation locale="es" localeKey="Mailboxes Backed-up (at least once)" localeValue="Buzones Respaldados (al menos una vez)" />
    <Translation locale="es" localeKey="Mailboxes Meeting SLA" localeValue="Buzones que Cumplen SLA " />
    <Translation locale="es" localeKey="Mailboxes Missing SLA" localeValue="Buzones Omitiendo SLA" />
    <Translation locale="es" localeKey="Mailboxes Need Attention" localeValue="Buzones Necesitan Atenci&#243;n" />
    <Translation locale="es" localeKey="Mailboxes Never Backed-up" localeValue="Buzones Nunca Respaldados" />
    <Translation locale="es" localeKey="Mailboxes Not Meeting SLA" localeValue="Buzones No Cumpliendo SLA" />
    <Translation locale="es" localeKey="Mailboxes Recently Added" localeValue="Buzones Recientemente Agregados" />
    <Translation locale="es" localeKey="Max Streams" localeValue="Secuencias M&#225;x " />
    <Translation locale="es" localeKey="Not Processed Items" localeValue="Elementos No Procesados" />
    <Translation locale="es" localeKey="Not Processed Mailboxes" localeValue="Buzones No Procesados" />
    <Translation locale="es" localeKey="Number Of Items" localeValue="N&#250;mero de Elementos" />
    <Translation locale="es" localeKey="Options" localeValue="Opciones" />
    <Translation locale="es" localeKey="SharePoint" localeValue="SharePoint" />
    <Translation locale="es" localeKey="SharePoint Clients" localeValue="Clientes de SharePoint " />
    <Translation locale="es" localeKey="Site URL" localeValue="Url de Sitio" />
    <Translation locale="es" localeKey="Sites Backed-up (at least once)" localeValue="Sitios Respaldados&#09; (al menos una vez)" />
    <Translation locale="es" localeKey="Sites Meeting SLA" localeValue="Sitios que Cumplen el SLA&#09;" />
    <Translation locale="es" localeKey="Sites Missing SLA" localeValue="Sitios Omitiendo SLA" />
    <Translation locale="es" localeKey="Sites Need Attention" localeValue="Sitios Que Necesitan Atenci&#243;n" />
    <Translation locale="es" localeKey="Sites Never Backed-up" localeValue="Sitios Nunca Respaldados " />
    <Translation locale="es" localeKey="Sites Not Meeting SLA" localeValue="Sitios Que No Cumplen SLA" />
    <Translation locale="es" localeKey="Sites Recently Added" localeValue="Sitios Recientemente Agregados" />
    <Translation locale="es" localeKey="SLA Status for Exchange Clients" localeValue="Estado de SLA para Clientes Exchange " />
    <Translation locale="es" localeKey="SLA Status for OneDrive Clients" localeValue="Estado de SLA para Clientes OneDrive" />
    <Translation locale="es" localeKey="SLA Status for SharePoint Clients" localeValue="Estado de SLA para Clientes SharePoint" />
    <Translation locale="es" localeKey="SLA Status for Teams Clients" localeValue="Estado de SLA para Clientes Teams" />
    <Translation locale="es" localeKey="Teams" localeValue="Teams" />
    <Translation locale="es" localeKey="Teams Backed-up (at least once)" localeValue="Teams Respaldados (al menos una vez)" />
    <Translation locale="es" localeKey="Teams Clients" localeValue="Cientes de Teams " />
    <Translation locale="es" localeKey="Teams Meeting SLA" localeValue="Teams Cumplen con SLA" />
    <Translation locale="es" localeKey="Teams Missing SLA" localeValue="Teams Omitiendo SLA" />
    <Translation locale="es" localeKey="Teams Need Attention" localeValue="Teams Necesita Atenci&#243;n" />
    <Translation locale="es" localeKey="Teams Never Backed-up" localeValue="Teams Nunca Respaldadas" />
    <Translation locale="es" localeKey="Teams Not Meeting SLA" localeValue="Teams No Cumplen Con SLA" />
    <Translation locale="es" localeKey="Teams Recently Added" localeValue="Teams Recientemente Agregada" />
    <Translation locale="es" localeKey="Users Backed-up (at least once)" localeValue="Usuarios Respaldados (al menos una vez)" />
    <Translation locale="es" localeKey="Users Meeting SLA" localeValue="Usuarios Cumplen Con SLA " />
    <Translation locale="es" localeKey="Users Missing SLA" localeValue="Usuarios Omitiendo SLA" />
    <Translation locale="es" localeKey="Users Need Attention" localeValue="Usuarios Necesitan Atenci&#243;n " />
    <Translation locale="es" localeKey="Users Never Backed-up" localeValue="Usuarios Nunca Respaldados" />
    <Translation locale="es" localeKey="Users Not Meeting SLA" localeValue="Usuarios que Incumplen SLA&#09;" />
    <Translation locale="es" localeKey="Users Recently Added" localeValue="Usuarios Recientemente Agregados" />
    <Translation locale="es_MX" localeKey="Active Jobs" localeValue="Tareas Activas" />
    <Translation locale="es_MX" localeKey="activejobsurl" localeValue="urldetareasactivas" />
    <Translation locale="es_MX" localeKey="Added to content on" localeValue="Agregado a contenido en" />
    <Translation locale="es_MX" localeKey="Advanced" localeValue="Avanzado" />
    <Translation locale="es_MX" localeKey="Application Size" localeValue="Tama&#241;o de Aplicaci&#243;n" />
    <Translation locale="es_MX" localeKey="Associated Mailboxes" localeValue="Buzones Asociados" />
    <Translation locale="es_MX" localeKey="Associated Sites" localeValue="Sitios Asociados" />
    <Translation locale="es_MX" localeKey="Associated Teams" localeValue="Teams Asociadas" />
    <Translation locale="es_MX" localeKey="Associated Users" localeValue="Usuarios Asociados" />
    <Translation locale="es_MX" localeKey="Azure Apps Associated" localeValue="Azure Apps Asociados" />
    <Translation locale="es_MX" localeKey="Azure Apps To Be Added" localeValue="Azure Apps A Ser Agregados" />
    <Translation locale="es_MX" localeKey="Backup Size" localeValue="Tama&#241;o de Copia de Seguridad" />
    <Translation locale="es_MX" localeKey="Backup Status" localeValue="Estado de Copia de Seguridad" />
    <Translation locale="es_MX" localeKey="Client Groups" localeValue="Grupo de Cliente" />
    <Translation locale="es_MX" localeKey="clienturl" localeValue="clienteurl" />
    <Translation locale="es_MX" localeKey="Failed Items" localeValue="Elementos fallidos" />
    <Translation locale="es_MX" localeKey="Index Status" localeValue="Estado de &#205;ndice" />
    <Translation locale="es_MX" localeKey="Indexed Emails" localeValue="Emails Indexados" />
    <Translation locale="es_MX" localeKey="Indexed Items" localeValue="Elementos Indexados" />
    <Translation locale="es_MX" localeKey="joburl" localeValue="tareaurl" />
    <Translation locale="es_MX" localeKey="Last Backup Attempt JobId" localeValue="&#218;ltimo Intento de Copia de Seguridad ID de Tarea" />
    <Translation locale="es_MX" localeKey="Last discovery time" localeValue="&#218;ltima hora de descubrimiento" />
    <Translation locale="es_MX" localeKey="Last index error time" localeValue="Hora del &#218;ltimo Error de &#205;ndice" />
    <Translation locale="es_MX" localeKey="Last index time" localeValue="&#218;ltima Hora del &#205;ndice" />
    <Translation locale="es_MX" localeKey="Last indexed backup jobid" localeValue="&#218;ltima copia de seguridad indexada id de tarea" />
    <Translation locale="es_MX" localeKey="Mailboxes Backed-up (at least once)" localeValue="Buzones Respaldados (al menos una vez)" />
    <Translation locale="es_MX" localeKey="Mailboxes Meeting SLA" localeValue="Buzones que Cumplen SLA " />
    <Translation locale="es_MX" localeKey="Mailboxes Missing SLA" localeValue="Buzones Omitiendo SLA" />
    <Translation locale="es_MX" localeKey="Mailboxes Need Attention" localeValue="Buzones Necesitan Atenci&#243;n" />
    <Translation locale="es_MX" localeKey="Mailboxes Never Backed-up" localeValue="Buzones Nunca Respaldados" />
    <Translation locale="es_MX" localeKey="Mailboxes Not Meeting SLA" localeValue="Buzones No Cumpliendo SLA" />
    <Translation locale="es_MX" localeKey="Mailboxes Recently Added" localeValue="Buzones Recientemente Agregados" />
    <Translation locale="es_MX" localeKey="Max Streams" localeValue="Secuencias M&#225;x " />
    <Translation locale="es_MX" localeKey="Not Processed Items" localeValue="Elementos No Procesados" />
    <Translation locale="es_MX" localeKey="Not Processed Mailboxes" localeValue="Buzones No Procesados" />
    <Translation locale="es_MX" localeKey="Number Of Items" localeValue="N&#250;mero de Elementos" />
    <Translation locale="es_MX" localeKey="Options" localeValue="Opciones" />
    <Translation locale="es_MX" localeKey="SharePoint" localeValue="SharePoint" />
    <Translation locale="es_MX" localeKey="SharePoint Clients" localeValue="Clientes de SharePoint " />
    <Translation locale="es_MX" localeKey="Site URL" localeValue="Url de Sitio" />
    <Translation locale="es_MX" localeKey="Sites Backed-up (at least once)" localeValue="Sitios Respaldados&#09; (al menos una vez)" />
    <Translation locale="es_MX" localeKey="Sites Meeting SLA" localeValue="Sitios que Cumplen el SLA&#09;" />
    <Translation locale="es_MX" localeKey="Sites Missing SLA" localeValue="Sitios Omitiendo SLA" />
    <Translation locale="es_MX" localeKey="Sites Need Attention" localeValue="Sitios Que Necesitan Atenci&#243;n" />
    <Translation locale="es_MX" localeKey="Sites Never Backed-up" localeValue="Sitios Nunca Respaldados " />
    <Translation locale="es_MX" localeKey="Sites Not Meeting SLA" localeValue="Sitios Que No Cumplen SLA" />
    <Translation locale="es_MX" localeKey="Sites Recently Added" localeValue="Sitios Recientemente Agregados" />
    <Translation locale="es_MX" localeKey="SLA Status for Exchange Clients" localeValue="Estado de SLA para Clientes Exchange " />
    <Translation locale="es_MX" localeKey="SLA Status for OneDrive Clients" localeValue="Estado de SLA para Clientes OneDrive" />
    <Translation locale="es_MX" localeKey="SLA Status for SharePoint Clients" localeValue="Estado de SLA para Clientes SharePoint" />
    <Translation locale="es_MX" localeKey="SLA Status for Teams Clients" localeValue="Estado de SLA para Clientes Teams" />
    <Translation locale="es_MX" localeKey="Teams" localeValue="Teams" />
    <Translation locale="es_MX" localeKey="Teams Backed-up (at least once)" localeValue="Teams Respaldados (al menos una vez)" />
    <Translation locale="es_MX" localeKey="Teams Clients" localeValue="Cientes de Teams " />
    <Translation locale="es_MX" localeKey="Teams Meeting SLA" localeValue="Teams Cumplen con SLA" />
    <Translation locale="es_MX" localeKey="Teams Missing SLA" localeValue="Teams Omitiendo SLA" />
    <Translation locale="es_MX" localeKey="Teams Need Attention" localeValue="Teams Necesita Atenci&#243;n" />
    <Translation locale="es_MX" localeKey="Teams Never Backed-up" localeValue="Teams Nunca Respaldadas" />
    <Translation locale="es_MX" localeKey="Teams Not Meeting SLA" localeValue="Teams No Cumplen Con SLA" />
    <Translation locale="es_MX" localeKey="Teams Recently Added" localeValue="Teams Recientemente Agregada" />
    <Translation locale="es_MX" localeKey="Users Backed-up (at least once)" localeValue="Usuarios Respaldados (al menos una vez)" />
    <Translation locale="es_MX" localeKey="Users Meeting SLA" localeValue="Usuarios Cumplen Con SLA " />
    <Translation locale="es_MX" localeKey="Users Missing SLA" localeValue="Usuarios Omitiendo SLA" />
    <Translation locale="es_MX" localeKey="Users Need Attention" localeValue="Usuarios Necesitan Atenci&#243;n " />
    <Translation locale="es_MX" localeKey="Users Never Backed-up" localeValue="Usuarios Nunca Respaldados" />
    <Translation locale="es_MX" localeKey="Users Not Meeting SLA" localeValue="Usuarios que Incumplen SLA&#09;" />
    <Translation locale="es_MX" localeKey="Users Recently Added" localeValue="Usuarios Recientemente Agregados" />
    <Translation locale="fr" localeKey="Active Jobs" localeValue="T&#226;ches actives" />
    <Translation locale="fr" localeKey="activejobsurl" localeValue="urldest&#226;chesactives&#09;" />
    <Translation locale="fr" localeKey="Added to content on" localeValue="Ajout&#233;e au contenu le" />
    <Translation locale="fr" localeKey="Advanced" localeValue="Avanc&#233;" />
    <Translation locale="fr" localeKey="Application Size" localeValue="Taille de l&#8217;application" />
    <Translation locale="fr" localeKey="Associated Mailboxes" localeValue="Bo&#238;tes aux lettres associ&#233;es" />
    <Translation locale="fr" localeKey="Associated Sites" localeValue="Sites associ&#233;s" />
    <Translation locale="fr" localeKey="Associated Users" localeValue="Utilisateurs associ&#233;s" />
    <Translation locale="fr" localeKey="Azure Apps Associated" localeValue="Apps Azure associ&#233;es" />
    <Translation locale="fr" localeKey="Azure Apps To Be Added" localeValue="Azure Apps &#224; ajouter" />
    <Translation locale="fr" localeKey="Backup Size" localeValue="Taille de la sauvegarde" />
    <Translation locale="fr" localeKey="Backup Status" localeValue="&#201;tat de la sauvegarde" />
    <Translation locale="fr" localeKey="Client Groups" localeValue="Groupes de clients" />
    <Translation locale="fr" localeKey="clienturl" localeValue="urlclient" />
    <Translation locale="fr" localeKey="Failed Items" localeValue="Objets &#233;chou&#233;s" />
    <Translation locale="fr" localeKey="Index Status" localeValue="&#201;tat de l'index" />
    <Translation locale="fr" localeKey="Indexed Emails" localeValue="Emails index&#233;s" />
    <Translation locale="fr" localeKey="Indexed Items" localeValue="Objets index&#233;s" />
    <Translation locale="fr" localeKey="joburl" localeValue="urldet&#226;che" />
    <Translation locale="fr" localeKey="Last Backup Attempt JobId" localeValue="Id de la derni&#232;re tentative de sauvegarde" />
    <Translation locale="fr" localeKey="Last discovery time" localeValue="Heure de la derni&#232;re d&#233;couverte" />
    <Translation locale="fr" localeKey="Last index error time" localeValue="Heure de la derni&#232;re erreur d'index" />
    <Translation locale="fr" localeKey="Last index time" localeValue="Derni&#232;re heure d'indexation" />
    <Translation locale="fr" localeKey="Last indexed backup jobid" localeValue="Id de la derni&#232;re t&#226;che de sauvegarde index&#233;e" />
    <Translation locale="fr" localeKey="Mailboxes Backed-up (at least once)" localeValue="Bo&#238;tes aux lettres sauvegard&#233;es (au moins une fois)" />
    <Translation locale="fr" localeKey="Mailboxes Meeting SLA" localeValue="Bo&#238;tes aux lettres respectant le SLA" />
    <Translation locale="fr" localeKey="Mailboxes Missing SLA" localeValue="Bo&#238;tes aux lettres qui manquent le SLA" />
    <Translation locale="fr" localeKey="Mailboxes Need Attention" localeValue="Les bo&#238;tes aux lettres qui n&#233;cessitent votre attention" />
    <Translation locale="fr" localeKey="Mailboxes Never Backed-up" localeValue="Bo&#238;tes aux lettres jamais sauvegard&#233;es" />
    <Translation locale="fr" localeKey="Mailboxes Not Meeting SLA" localeValue="Bo&#238;tes aux lettres ne respectant pas le SLA" />
    <Translation locale="fr" localeKey="Mailboxes Recently Added" localeValue="Bo&#238;tes aux lettres r&#233;cemment ajout&#233;es" />
    <Translation locale="fr" localeKey="Max Streams" localeValue="Nombre maximal de flux" />
    <Translation locale="fr" localeKey="Not Processed Items" localeValue="Objets non trait&#233;s" />
    <Translation locale="fr" localeKey="Not Processed Mailboxes" localeValue="Bo&#238;tes aux lettres non trait&#233;es" />
    <Translation locale="fr" localeKey="Number Of Items" localeValue="Nombre d'&#233;l&#233;ments" />
    <Translation locale="fr" localeKey="Options" localeValue="Options" />
    <Translation locale="fr" localeKey="SharePoint" localeValue="SharePoint" />
    <Translation locale="fr" localeKey="SharePoint Clients" localeValue="Clients SharePoint " />
    <Translation locale="fr" localeKey="Site URL" localeValue="URL de site" />
    <Translation locale="fr" localeKey="Sites Backed-up (at least once)" localeValue="Sites sauvegard&#233;s (au moins une fois)" />
    <Translation locale="fr" localeKey="Sites Meeting SLA" localeValue="Sites respectant le SLA" />
    <Translation locale="fr" localeKey="Sites Missing SLA" localeValue="Sites qui manquent le SLA" />
    <Translation locale="fr" localeKey="Sites Need Attention" localeValue="Sites qui n&#233;cessitent votre attention" />
    <Translation locale="fr" localeKey="Sites Never Backed-up" localeValue="Sites jamais sauvegard&#233;s" />
    <Translation locale="fr" localeKey="Sites Not Meeting SLA" localeValue="Sites ne respectant pas le SLA" />
    <Translation locale="fr" localeKey="Sites Recently Added" localeValue="Sites r&#233;cemment ajout&#233;s" />
    <Translation locale="fr" localeKey="SLA Status for Exchange Clients" localeValue="&#201;tat du SLA pour les clients Exchange" />
    <Translation locale="fr" localeKey="SLA Status for OneDrive Clients" localeValue="&#201;tat du SLA pour les clients OneDrive" />
    <Translation locale="fr" localeKey="SLA Status for SharePoint Clients" localeValue="&#201;tat du SLA pour les clients SharePoint" />
    <Translation locale="fr" localeKey="SLA Status for Teams Clients" localeValue="&#201;tat SLA des clients de Teams" />
    <Translation locale="fr" localeKey="Teams" localeValue="Teams" />
    <Translation locale="fr" localeKey="Teams Backed-up (at least once)" localeValue="Teams sauvegard&#233;s (au moins une fois)" />
    <Translation locale="fr" localeKey="Teams Clients" localeValue="Clients Teams" />
    <Translation locale="fr" localeKey="Teams Meeting SLA" localeValue="&#201;quipes qui respectent le SLA" />
    <Translation locale="fr" localeKey="Teams Missing SLA" localeValue="&#201;quipes qui manquent le SLA" />
    <Translation locale="fr" localeKey="Teams Need Attention" localeValue="Teams n&#233;cessitent de l'attention" />
    <Translation locale="fr" localeKey="Teams Never Backed-up" localeValue="Teams jamais sauvegard&#233;s" />
    <Translation locale="fr" localeKey="Teams Not Meeting SLA" localeValue="Teams ne respectant pas le SLA " />
    <Translation locale="fr" localeKey="Teams Recently Added" localeValue="Teams r&#233;cemment ajout&#233;s" />
    <Translation locale="fr" localeKey="Users Backed-up (at least once)" localeValue="Utilisateurs sauvegard&#233;s (au moins une fois)" />
    <Translation locale="fr" localeKey="Users Meeting SLA" localeValue="Utilisateurs respectant le SLA" />
    <Translation locale="fr" localeKey="Users Missing SLA" localeValue="Utilisateurs qui manquent le SLA" />
    <Translation locale="fr" localeKey="Users Need Attention" localeValue="Utilisateurs qui ont besoin de votre attention" />
    <Translation locale="fr" localeKey="Users Never Backed-up" localeValue="Utilisateurs jamais sauvegard&#233;s" />
    <Translation locale="fr" localeKey="Users Not Meeting SLA" localeValue="Utilisateurs ne respectant pas le SLA" />
    <Translation locale="fr" localeKey="Users Recently Added" localeValue="Utilisateurs r&#233;cemment ajout&#233;s" />
    <Translation locale="fr_CA" localeKey="Active Jobs" localeValue="T&#226;ches actives" />
    <Translation locale="fr_CA" localeKey="activejobsurl" localeValue="urldest&#226;chesactives&#09;" />
    <Translation locale="fr_CA" localeKey="Added to content on" localeValue="Ajout&#233;e au contenu le" />
    <Translation locale="fr_CA" localeKey="Advanced" localeValue="Avanc&#233;" />
    <Translation locale="fr_CA" localeKey="Application Size" localeValue="Taille de l&#8217;application" />
    <Translation locale="fr_CA" localeKey="Associated Mailboxes" localeValue="Bo&#238;tes aux lettres associ&#233;es" />
    <Translation locale="fr_CA" localeKey="Associated Sites" localeValue="Sites associ&#233;s" />
    <Translation locale="fr_CA" localeKey="Associated Users" localeValue="Utilisateurs associ&#233;s" />
    <Translation locale="fr_CA" localeKey="Azure Apps Associated" localeValue="Apps Azure associ&#233;es" />
    <Translation locale="fr_CA" localeKey="Azure Apps To Be Added" localeValue="Azure Apps &#224; ajouter" />
    <Translation locale="fr_CA" localeKey="Backup Size" localeValue="Taille de la sauvegarde" />
    <Translation locale="fr_CA" localeKey="Backup Status" localeValue="&#201;tat de la sauvegarde" />
    <Translation locale="fr_CA" localeKey="Client Groups" localeValue="Groupes de clients" />
    <Translation locale="fr_CA" localeKey="clienturl" localeValue="urlclient" />
    <Translation locale="fr_CA" localeKey="Failed Items" localeValue="Objets &#233;chou&#233;s" />
    <Translation locale="fr_CA" localeKey="Index Status" localeValue="&#201;tat de l'index" />
    <Translation locale="fr_CA" localeKey="Indexed Emails" localeValue="Emails index&#233;s" />
    <Translation locale="fr_CA" localeKey="Indexed Items" localeValue="Objets index&#233;s" />
    <Translation locale="fr_CA" localeKey="joburl" localeValue="urldet&#226;che" />
    <Translation locale="fr_CA" localeKey="Last Backup Attempt JobId" localeValue="Id de la derni&#232;re tentative de sauvegarde" />
    <Translation locale="fr_CA" localeKey="Last discovery time" localeValue="Heure de la derni&#232;re d&#233;couverte" />
    <Translation locale="fr_CA" localeKey="Last index error time" localeValue="Heure de la derni&#232;re erreur d'index" />
    <Translation locale="fr_CA" localeKey="Last index time" localeValue="Derni&#232;re heure d'indexation" />
    <Translation locale="fr_CA" localeKey="Last indexed backup jobid" localeValue="Id de la derni&#232;re t&#226;che de sauvegarde index&#233;e" />
    <Translation locale="fr_CA" localeKey="Mailboxes Backed-up (at least once)" localeValue="Bo&#238;tes aux lettres sauvegard&#233;es (au moins une fois)" />
    <Translation locale="fr_CA" localeKey="Mailboxes Meeting SLA" localeValue="Bo&#238;tes aux lettres respectant le SLA" />
    <Translation locale="fr_CA" localeKey="Mailboxes Missing SLA" localeValue="Bo&#238;tes aux lettres qui manquent le SLA" />
    <Translation locale="fr_CA" localeKey="Mailboxes Need Attention" localeValue="Les bo&#238;tes aux lettres qui n&#233;cessitent votre attention" />
    <Translation locale="fr_CA" localeKey="Mailboxes Never Backed-up" localeValue="Bo&#238;tes aux lettres jamais sauvegard&#233;es" />
    <Translation locale="fr_CA" localeKey="Mailboxes Not Meeting SLA" localeValue="Bo&#238;tes aux lettres ne respectant pas le SLA" />
    <Translation locale="fr_CA" localeKey="Mailboxes Recently Added" localeValue="Bo&#238;tes aux lettres r&#233;cemment ajout&#233;es" />
    <Translation locale="fr_CA" localeKey="Max Streams" localeValue="Nombre maximal de flux" />
    <Translation locale="fr_CA" localeKey="Not Processed Items" localeValue="Objets non trait&#233;s" />
    <Translation locale="fr_CA" localeKey="Not Processed Mailboxes" localeValue="Bo&#238;tes aux lettres non trait&#233;es" />
    <Translation locale="fr_CA" localeKey="Number Of Items" localeValue="Nombre d'&#233;l&#233;ments" />
    <Translation locale="fr_CA" localeKey="Options" localeValue="Options" />
    <Translation locale="fr_CA" localeKey="SharePoint" localeValue="SharePoint" />
    <Translation locale="fr_CA" localeKey="SharePoint Clients" localeValue="Clients SharePoint " />
    <Translation locale="fr_CA" localeKey="Site URL" localeValue="URL de site" />
    <Translation locale="fr_CA" localeKey="Sites Backed-up (at least once)" localeValue="Sites sauvegard&#233;s (au moins une fois)" />
    <Translation locale="fr_CA" localeKey="Sites Meeting SLA" localeValue="Sites respectant le SLA" />
    <Translation locale="fr_CA" localeKey="Sites Missing SLA" localeValue="Sites qui manquent le SLA" />
    <Translation locale="fr_CA" localeKey="Sites Need Attention" localeValue="Sites qui n&#233;cessitent votre attention" />
    <Translation locale="fr_CA" localeKey="Sites Never Backed-up" localeValue="Sites jamais sauvegard&#233;s" />
    <Translation locale="fr_CA" localeKey="Sites Not Meeting SLA" localeValue="Sites ne respectant pas le SLA" />
    <Translation locale="fr_CA" localeKey="Sites Recently Added" localeValue="Sites r&#233;cemment ajout&#233;s" />
    <Translation locale="fr_CA" localeKey="SLA Status for Exchange Clients" localeValue="&#201;tat du SLA pour les clients Exchange" />
    <Translation locale="fr_CA" localeKey="SLA Status for OneDrive Clients" localeValue="&#201;tat du SLA pour les clients OneDrive" />
    <Translation locale="fr_CA" localeKey="SLA Status for SharePoint Clients" localeValue="&#201;tat du SLA pour les clients SharePoint" />
    <Translation locale="fr_CA" localeKey="SLA Status for Teams Clients" localeValue="&#201;tat SLA des clients de Teams" />
    <Translation locale="fr_CA" localeKey="Teams" localeValue="Teams" />
    <Translation locale="fr_CA" localeKey="Teams Backed-up (at least once)" localeValue="Teams sauvegard&#233;s (au moins une fois)" />
    <Translation locale="fr_CA" localeKey="Teams Clients" localeValue="Clients Teams" />
    <Translation locale="fr_CA" localeKey="Teams Meeting SLA" localeValue="&#201;quipes qui respectent le SLA" />
    <Translation locale="fr_CA" localeKey="Teams Missing SLA" localeValue="&#201;quipes qui manquent le SLA" />
    <Translation locale="fr_CA" localeKey="Teams Need Attention" localeValue="Teams n&#233;cessitent de l'attention" />
    <Translation locale="fr_CA" localeKey="Teams Never Backed-up" localeValue="Teams jamais sauvegard&#233;s" />
    <Translation locale="fr_CA" localeKey="Teams Not Meeting SLA" localeValue="Teams ne respectant pas le SLA " />
    <Translation locale="fr_CA" localeKey="Teams Recently Added" localeValue="Teams r&#233;cemment ajout&#233;s" />
    <Translation locale="fr_CA" localeKey="Users Backed-up (at least once)" localeValue="Utilisateurs sauvegard&#233;s (au moins une fois)" />
    <Translation locale="fr_CA" localeKey="Users Meeting SLA" localeValue="Utilisateurs respectant le SLA" />
    <Translation locale="fr_CA" localeKey="Users Missing SLA" localeValue="Utilisateurs qui manquent le SLA" />
    <Translation locale="fr_CA" localeKey="Users Need Attention" localeValue="Utilisateurs qui ont besoin de votre attention" />
    <Translation locale="fr_CA" localeKey="Users Never Backed-up" localeValue="Utilisateurs jamais sauvegard&#233;s" />
    <Translation locale="fr_CA" localeKey="Users Not Meeting SLA" localeValue="Utilisateurs ne respectant pas le SLA" />
    <Translation locale="fr_CA" localeKey="Users Recently Added" localeValue="Utilisateurs r&#233;cemment ajout&#233;s" />
    <Translation locale="ja" localeKey="Active Jobs" localeValue="&#12450;&#12463;&#12486;&#12451;&#12502;&#12394;&#12472;&#12519;&#12502;" />
    <Translation locale="ja" localeKey="activejobsurl" localeValue="&#12450;&#12463;&#12486;&#12451;&#12502;&#12394;&#12472;&#12519;&#12502;&#12398;URL" />
    <Translation locale="ja" localeKey="Advanced" localeValue="&#35443;&#32048;" />
    <Translation locale="ja" localeKey="Application Size" localeValue="&#12450;&#12503;&#12522;&#12465;&#12540;&#12471;&#12519;&#12531;&#12469;&#12452;&#12474;" />
    <Translation locale="ja" localeKey="Associated Mailboxes" localeValue="&#38306;&#36899;&#12377;&#12427;&#12513;&#12540;&#12523;&#12508;&#12483;&#12463;&#12473;" />
    <Translation locale="ja" localeKey="Associated Sites" localeValue="&#38306;&#36899;&#12469;&#12452;&#12488;" />
    <Translation locale="ja" localeKey="Associated Teams" localeValue="&#38306;&#36899;&#12377;&#12427;&#12481;&#12540;&#12512;" />
    <Translation locale="ja" localeKey="Associated Users" localeValue="&#38306;&#36899;&#12518;&#12540;&#12470;&#12540;" />
    <Translation locale="ja" localeKey="Backup Size" localeValue="&#12496;&#12483;&#12463;&#12450;&#12483;&#12503;&#12469;&#12452;&#12474;" />
    <Translation locale="ja" localeKey="Backup Status" localeValue="&#12496;&#12483;&#12463;&#12450;&#12483;&#12503;&#12473;&#12486;&#12540;&#12479;&#12473;" />
    <Translation locale="ja" localeKey="Client Groups" localeValue="&#12463;&#12521;&#12452;&#12450;&#12531;&#12488;&#12464;&#12523;&#12540;&#12503;" />
    <Translation locale="ja" localeKey="Failed Items" localeValue="&#22833;&#25943;&#12375;&#12383;&#12450;&#12452;&#12486;&#12512;" />
    <Translation locale="ja" localeKey="Index Status" localeValue="&#12452;&#12531;&#12487;&#12483;&#12463;&#12473;&#12473;&#12486;&#12540;&#12479;&#12473;" />
    <Translation locale="ja" localeKey="Indexed Emails" localeValue="&#12452;&#12531;&#12487;&#12483;&#12463;&#12473;&#20184;&#12365;&#12513;&#12540;&#12523;" />
    <Translation locale="ja" localeKey="Indexed Items" localeValue="&#12452;&#12531;&#12487;&#12483;&#12463;&#12473;&#20184;&#12365;&#12450;&#12452;&#12486;&#12512;" />
    <Translation locale="ja" localeKey="joburl" localeValue="&#12472;&#12519;&#12502;URL" />
    <Translation locale="ja" localeKey="Last Backup Attempt JobId" localeValue="&#26368;&#24460;&#12398;&#12496;&#12483;&#12463;&#12450;&#12483;&#12503;&#35430;&#34892;&#12472;&#12519;&#12502; ID" />
    <Translation locale="ja" localeKey="Last discovery time" localeValue="&#26368;&#32066;&#26908;&#20986;&#26178;&#21051;" />
    <Translation locale="ja" localeKey="Last index error time" localeValue="&#26368;&#32066;&#12452;&#12531;&#12487;&#12483;&#12463;&#12473;&#12456;&#12521;&#12540;&#26178;&#38291;" />
    <Translation locale="ja" localeKey="Last index time" localeValue="&#26368;&#32066;&#12452;&#12531;&#12487;&#12483;&#12463;&#12473;&#26178;&#38291;" />
    <Translation locale="ja" localeKey="Last indexed backup jobid" localeValue="&#26368;&#24460;&#12398;&#12452;&#12531;&#12487;&#12483;&#12463;&#12473;&#20184;&#12365;&#12496;&#12483;&#12463;&#12450;&#12483;&#12503; &#12472;&#12519;&#12502; ID" />
    <Translation locale="ja" localeKey="Mailboxes Backed-up (at least once)" localeValue="&#12496;&#12483;&#12463;&#12450;&#12483;&#12503;&#12373;&#12428;&#12383;&#12513;&#12540;&#12523;&#12508;&#12483;&#12463;&#12473; (&#23569;&#12394;&#12367;&#12392;&#12418; 1 &#22238;)" />
    <Translation locale="ja" localeKey="Mailboxes Meeting SLA" localeValue="SLA&#36969;&#21512;&#12398;&#12513;&#12540;&#12523;&#12508;&#12483;&#12463;&#12473;" />
    <Translation locale="ja" localeKey="Mailboxes Missing SLA" localeValue="SLA&#19981;&#36969;&#21512;&#12398;&#12513;&#12540;&#12523;&#12508;&#12483;&#12463;&#12473;" />
    <Translation locale="ja" localeKey="Mailboxes Need Attention" localeValue="&#27880;&#24847;&#12364;&#24517;&#35201;&#12394;&#12513;&#12540;&#12523;&#12508;&#12483;&#12463;&#12473;" />
    <Translation locale="ja" localeKey="Mailboxes Never Backed-up" localeValue="&#12496;&#12483;&#12463;&#12450;&#12483;&#12503;&#12434;&#34892;&#12431;&#12394;&#12356;&#12513;&#12540;&#12523;&#12508;&#12483;&#12463;&#12473;" />
    <Translation locale="ja" localeKey="Mailboxes Not Meeting SLA" localeValue="SLA&#19981;&#36969;&#21512;&#12398;&#12513;&#12540;&#12523;&#12508;&#12483;&#12463;&#12473;" />
    <Translation locale="ja" localeKey="Mailboxes Recently Added" localeValue="&#26368;&#36817;&#36861;&#21152;&#12373;&#12428;&#12383;&#12513;&#12540;&#12523;&#12508;&#12483;&#12463;&#12473;" />
    <Translation locale="ja" localeKey="Max Streams" localeValue="&#26368;&#22823;&#12473;&#12488;&#12522;&#12540;&#12512;" />
    <Translation locale="ja" localeKey="Not Processed Items" localeValue="&#26410;&#20966;&#29702;&#12398;&#12450;&#12452;&#12486;&#12512;" />
    <Translation locale="ja" localeKey="Not Processed Mailboxes" localeValue="&#26410;&#20966;&#29702;&#12398;&#12513;&#12540;&#12523;&#12508;&#12483;&#12463;&#12473;" />
    <Translation locale="ja" localeKey="Number Of Items" localeValue="&#12450;&#12452;&#12486;&#12512;&#25968;" />
    <Translation locale="ja" localeKey="Options" localeValue="&#12458;&#12503;&#12471;&#12519;&#12531;" />
    <Translation locale="ja" localeKey="SharePoint" localeValue="SharePoint" />
    <Translation locale="ja" localeKey="SharePoint Clients" localeValue="SharePoint&#12463;&#12521;&#12452;&#12450;&#12531;&#12488;" />
    <Translation locale="ja" localeKey="Site URL" localeValue="&#12469;&#12452;&#12488;URL" />
    <Translation locale="ja" localeKey="Sites Backed-up (at least once)" localeValue="&#12496;&#12483;&#12463;&#12450;&#12483;&#12503;&#12373;&#12428;&#12383;&#12469;&#12452;&#12488;&#65288;&#23569;&#12394;&#12367;&#12392;&#12418;1&#22238;&#65289;" />
    <Translation locale="ja" localeKey="Sites Meeting SLA" localeValue="SLA&#36969;&#21512;&#12398;&#12469;&#12452;&#12488;" />
    <Translation locale="ja" localeKey="Sites Missing SLA" localeValue="SLA&#19981;&#36969;&#21512;&#12398;&#12469;&#12452;&#12488;" />
    <Translation locale="ja" localeKey="Sites Need Attention" localeValue="&#27880;&#24847;&#12364;&#24517;&#35201;&#12394;&#12469;&#12452;&#12488;" />
    <Translation locale="ja" localeKey="Sites Never Backed-up" localeValue="&#12496;&#12483;&#12463;&#12450;&#12483;&#12503;&#12373;&#12428;&#12390;&#12356;&#12394;&#12356;&#12469;&#12452;&#12488;" />
    <Translation locale="ja" localeKey="Sites Not Meeting SLA" localeValue="SLA&#19981;&#36969;&#21512;&#12398;&#12469;&#12452;&#12488;" />
    <Translation locale="ja" localeKey="Sites Recently Added" localeValue="&#26368;&#36817;&#36861;&#21152;&#12373;&#12428;&#12383;&#12469;&#12452;&#12488;" />
    <Translation locale="ja" localeKey="SLA Status for Exchange Clients" localeValue="Exchange &#12463;&#12521;&#12452;&#12450;&#12531;&#12488;&#12398; SLA &#12473;&#12486;&#12540;&#12479;&#12473;" />
    <Translation locale="ja" localeKey="SLA Status for OneDrive Clients" localeValue="OneDrive &#12463;&#12521;&#12452;&#12450;&#12531;&#12488;&#12398; SLA &#12473;&#12486;&#12540;&#12479;&#12473;" />
    <Translation locale="ja" localeKey="SLA Status for SharePoint Clients" localeValue="SharePoint &#12463;&#12521;&#12452;&#12450;&#12531;&#12488;&#12398; SLA &#12473;&#12486;&#12540;&#12479;&#12473;" />
    <Translation locale="ja" localeKey="SLA Status for Teams Clients" localeValue="&#12481;&#12540;&#12512; &#12463;&#12521;&#12452;&#12450;&#12531;&#12488;&#12398; SLA &#12473;&#12486;&#12540;&#12479;&#12473;" />
    <Translation locale="ja" localeKey="Teams" localeValue="&#12481;&#12540;&#12512;" />
    <Translation locale="ja" localeKey="Teams Backed-up (at least once)" localeValue="&#12496;&#12483;&#12463;&#12450;&#12483;&#12503;&#12373;&#12428;&#12383;&#12481;&#12540;&#12512;&#65288;&#23569;&#12394;&#12367;&#12392;&#12418;1&#22238;&#65289;" />
    <Translation locale="ja" localeKey="Teams Clients" localeValue="&#12481;&#12540;&#12512;&#12463;&#12521;&#12452;&#12450;&#12531;&#12488;" />
    <Translation locale="ja" localeKey="Teams Meeting SLA" localeValue="SLA&#36969;&#21512;&#12398;&#12481;&#12540;&#12512;" />
    <Translation locale="ja" localeKey="Teams Missing SLA" localeValue="SLA&#19981;&#36969;&#26684;&#12398;&#12481;&#12540;&#12512;" />
    <Translation locale="ja" localeKey="Teams Need Attention" localeValue="&#27880;&#24847;&#12364;&#24517;&#35201;&#12394;&#12481;&#12540;&#12512;" />
    <Translation locale="ja" localeKey="Teams Never Backed-up" localeValue="&#12496;&#12483;&#12463;&#12450;&#12483;&#12503;&#12373;&#12428;&#12383;&#12371;&#12392;&#12398;&#12394;&#12356;&#12481;&#12540;&#12512;" />
    <Translation locale="ja" localeKey="Teams Not Meeting SLA" localeValue="SLA&#19981;&#36969;&#21512;&#12398;&#12481;&#12540;&#12512;" />
    <Translation locale="ja" localeKey="Teams Recently Added" localeValue="&#26368;&#36817;&#36861;&#21152;&#12373;&#12428;&#12383;&#12481;&#12540;&#12512;" />
    <Translation locale="ja" localeKey="Users Meeting SLA" localeValue="SLA &#36969;&#21512;&#12518;&#12540;&#12470;&#12540; " />
    <Translation locale="ja" localeKey="Users Missing SLA" localeValue="SLA &#36969;&#21512;&#12518;&#12540;&#12470;&#12540; " />
    <Translation locale="ja" localeKey="Users Never Backed-up" localeValue="&#12496;&#12483;&#12463;&#12450;&#12483;&#12503;&#12398;&#12394;&#12363;&#12387;&#12383;&#12518;&#12540;&#12470;&#12540;" />
    <Translation locale="ja" localeKey="Users Not Meeting SLA" localeValue="SLA &#19981;&#36969;&#21512;&#12518;&#12540;&#12470;&#12540; " />
    <Translation locale="ko" localeKey="Active Jobs" localeValue="&#54876;&#49457; &#51089;&#50629;" />
    <Translation locale="ko" localeKey="activejobsurl" localeValue="activejobsurl" />
    <Translation locale="ko" localeKey="Advanced" localeValue="&#44256;&#44553;" />
    <Translation locale="ko" localeKey="Associated Mailboxes" localeValue="&#50672;&#44208;&#46108; &#54200;&#51648;&#54632;" />
    <Translation locale="ko" localeKey="Associated Sites" localeValue="&#50672;&#44208;&#46108; &#49324;&#51060;&#53944;" />
    <Translation locale="ko" localeKey="Associated Teams" localeValue="&#50672;&#44208;&#46108; &#54016;" />
    <Translation locale="ko" localeKey="Associated Users" localeValue="&#50672;&#44208;&#46108; &#49324;&#50857;&#51088;" />
    <Translation locale="ko" localeKey="Azure Apps To Be Added" localeValue="&#52628;&#44032;&#54624; Azure App " />
    <Translation locale="ko" localeKey="Backup Size" localeValue="&#48177;&#50629; &#53356;&#44592;" />
    <Translation locale="ko" localeKey="Backup Status" localeValue="&#48177;&#50629; &#49345;&#53468;" />
    <Translation locale="ko" localeKey="Client Groups" localeValue="&#53364;&#46972;&#51060;&#50616;&#53944; &#44536;&#47353;" />
    <Translation locale="ko" localeKey="clienturl" localeValue="clienturl" />
    <Translation locale="ko" localeKey="Failed Items" localeValue="&#49892;&#54056;&#54620; &#54637;&#47785;" />
    <Translation locale="ko" localeKey="Index Status" localeValue="&#51064;&#45937;&#49828; &#49345;&#53468;" />
    <Translation locale="ko" localeKey="joburl" localeValue="joburl" />
    <Translation locale="ko" localeKey="Last Backup Attempt JobId" localeValue="&#47560;&#51648;&#47561; &#48177;&#50629; &#49884;&#46020; &#51089;&#50629; ID" />
    <Translation locale="ko" localeKey="Last index error time" localeValue="&#47560;&#51648;&#47561; &#51064;&#45937;&#49828; &#50724;&#47448; &#49884;&#44036;" />
    <Translation locale="ko" localeKey="Last index time" localeValue="&#47560;&#51648;&#47561; &#51064;&#45937;&#49828; &#49884;&#44036;" />
    <Translation locale="ko" localeKey="Last indexed backup jobid" localeValue="&#47560;&#51648;&#47561;&#51004;&#47196; &#51064;&#45937;&#49905;&#46108; &#48177;&#50629; &#51089;&#50629; ID" />
    <Translation locale="ko" localeKey="Mailboxes Backed-up (at least once)" localeValue="&#48177;&#50629;&#46108; &#49324;&#49436;&#54632;(&#52572;&#49548; 1&#54924; &#51060;&#49345;)" />
    <Translation locale="ko" localeKey="Mailboxes Meeting SLA" localeValue="SLA&#47484; &#52649;&#51313;&#54616;&#45716; &#49324;&#49436;&#54632;" />
    <Translation locale="ko" localeKey="Mailboxes Missing SLA" localeValue="SLA&#47484; &#52649;&#51313;&#54616;&#51648; &#50506;&#45716; &#49324;&#49436;&#54632;" />
    <Translation locale="ko" localeKey="Mailboxes Never Backed-up" localeValue="&#48177;&#50629;&#46108; &#51201;&#51060; &#50630;&#45716; &#49324;&#49436;&#54632;" />
    <Translation locale="ko" localeKey="Mailboxes Not Meeting SLA" localeValue="SLA&#47484; &#52649;&#51313;&#54616;&#51648; &#50506;&#45716; &#49324;&#49436;&#54632;" />
    <Translation locale="ko" localeKey="Not Processed Items" localeValue="&#52376;&#47532;&#46104;&#51648; &#50506;&#51008; &#54637;&#47785;" />
    <Translation locale="ko" localeKey="Not Processed Mailboxes" localeValue="&#52376;&#47532;&#46104;&#51648; &#50506;&#51008; &#54200;&#51648;&#54632;" />
    <Translation locale="ko" localeKey="Number Of Items" localeValue="&#54637;&#47785; &#49688;" />
    <Translation locale="ko" localeKey="SharePoint Clients" localeValue="SharePoint &#53364;&#46972;&#51060;&#50616;&#53944;" />
    <Translation locale="ko" localeKey="Site URL" localeValue="&#49324;&#51060;&#53944; URL" />
    <Translation locale="ko" localeKey="Sites Meeting SLA" localeValue="SLA&#47484; &#52649;&#51313;&#54616;&#45716; &#49324;&#51060;&#53944;" />
    <Translation locale="ko" localeKey="Sites Missing SLA" localeValue="SLA&#47484; &#52649;&#51313;&#54616;&#51648; &#50506;&#45716; &#49324;&#51060;&#53944;" />
    <Translation locale="ko" localeKey="Sites Never Backed-up" localeValue="&#48177;&#50629;&#46104;&#51648; &#50506;&#51008; &#49324;&#51060;&#53944;" />
    <Translation locale="ko" localeKey="SLA Status for Exchange Clients" localeValue="Exchange &#53364;&#46972;&#51060;&#50616;&#53944;&#51032; SLA &#49345;&#53468;" />
    <Translation locale="ko" localeKey="SLA Status for OneDrive Clients" localeValue="OneDrive &#53364;&#46972;&#51060;&#50616;&#53944;&#51032; SLA &#49345;&#53468;" />
    <Translation locale="ko" localeKey="SLA Status for SharePoint Clients" localeValue="SharePoint &#53364;&#46972;&#51060;&#50616;&#53944;&#51032; SLA &#49345;&#53468;" />
    <Translation locale="ko" localeKey="SLA Status for Teams Clients" localeValue="Teams &#53364;&#46972;&#51060;&#50616;&#53944;&#51032; SLA &#49345;&#53468;" />
    <Translation locale="ko" localeKey="Teams" localeValue="Teams" />
    <Translation locale="ko" localeKey="Teams Meeting SLA" localeValue="SLA&#47484; &#52649;&#51313;&#54616;&#45716; Teams" />
    <Translation locale="ko" localeKey="Teams Missing SLA" localeValue="SLA&#47484; &#52649;&#51313;&#54616;&#51648; &#50506;&#45716; Teams" />
    <Translation locale="ko" localeKey="Teams Never Backed-up" localeValue="&#48177;&#50629;&#46108; &#51201;&#51060; &#50630;&#45716; Teams" />
    <Translation locale="ko" localeKey="Teams Not Meeting SLA" localeValue="SLA&#47484; &#52649;&#51313;&#54616;&#51648; &#50506;&#45716; Teams" />
    <Translation locale="ko" localeKey="Users Meeting SLA" localeValue="SLA&#47484; &#52649;&#51313;&#54616;&#45716; &#49324;&#50857;&#51088;" />
    <Translation locale="ko" localeKey="Users Missing SLA" localeValue="SLA&#47484; &#52649;&#51313;&#54616;&#51648; &#50506;&#45716; &#49324;&#50857;&#51088;" />
    <Translation locale="ko" localeKey="Users Never Backed-up" localeValue="&#48177;&#50629;&#54616;&#51648; &#50506;&#51008; &#49324;&#50857;&#51088;" />
    <Translation locale="ko" localeKey="Users Not Meeting SLA" localeValue="SLA&#47484; &#52649;&#51313;&#54616;&#51648; &#50506;&#45716; &#49324;&#50857;&#51088;" />
    <Translation locale="ru" localeKey="Active Jobs" localeValue="&#1040;&#1082;&#1090;&#1080;&#1074;&#1085;&#1099;&#1077; &#1079;&#1072;&#1076;&#1072;&#1085;&#1080;&#1103;" />
    <Translation locale="ru" localeKey="activejobsurl" localeValue="url&#1072;&#1082;&#1090;&#1080;&#1074;&#1085;&#1099;&#1093;&#1079;&#1072;&#1076;&#1072;&#1085;&#1080;&#1081;" />
    <Translation locale="ru" localeKey="Advanced" localeValue="&#1044;&#1086;&#1087;&#1086;&#1083;&#1085;&#1080;&#1090;&#1077;&#1083;&#1100;&#1085;&#1099;&#1081;" />
    <Translation locale="ru" localeKey="Application Size" localeValue="&#1056;&#1072;&#1079;&#1084;&#1077;&#1088; &#1087;&#1088;&#1080;&#1083;&#1086;&#1078;&#1077;&#1085;&#1080;&#1103;" />
    <Translation locale="ru" localeKey="Associated Mailboxes" localeValue="&#1057;&#1074;&#1103;&#1079;&#1072;&#1085;&#1085;&#1099;&#1077; &#1087;&#1086;&#1095;&#1090;&#1086;&#1074;&#1099;&#1077; &#1103;&#1097;&#1080;&#1082;&#1080; " />
    <Translation locale="ru" localeKey="Associated Sites" localeValue="&#1057;&#1074;&#1103;&#1079;&#1072;&#1085;&#1085;&#1099;&#1077; &#1089;&#1072;&#1081;&#1090;&#1099; " />
    <Translation locale="ru" localeKey="Associated Teams" localeValue="&#1057;&#1074;&#1103;&#1079;&#1072;&#1085;&#1085;&#1099;&#1077; Teams" />
    <Translation locale="ru" localeKey="Associated Users" localeValue="&#1057;&#1074;&#1103;&#1079;&#1072;&#1085;&#1085;&#1099;&#1077; &#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1080; " />
    <Translation locale="ru" localeKey="Backup Size" localeValue="&#1056;&#1072;&#1079;&#1084;&#1077;&#1088; &#1088;&#1077;&#1079;&#1077;&#1088;&#1074;&#1085;&#1086;&#1081; &#1082;&#1086;&#1087;&#1080;&#1080; " />
    <Translation locale="ru" localeKey="Backup Status" localeValue="&#1057;&#1086;&#1089;&#1090;&#1086;&#1103;&#1085;&#1080;&#1077; &#1088;&#1077;&#1079;&#1077;&#1088;&#1074;&#1085;&#1086;&#1075;&#1086; &#1082;&#1086;&#1087;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1080;&#1103;" />
    <Translation locale="ru" localeKey="Client Groups" localeValue="&#1043;&#1088;&#1091;&#1087;&#1087;&#1099; &#1082;&#1083;&#1080;&#1077;&#1085;&#1090;&#1086;&#1074; " />
    <Translation locale="ru" localeKey="clienturl" localeValue="url&#1082;&#1083;&#1080;&#1077;&#1085;&#1090;&#1072;" />
    <Translation locale="ru" localeKey="Index Status" localeValue="&#1057;&#1086;&#1089;&#1090;&#1086;&#1103;&#1085;&#1080;&#1077; &#1080;&#1085;&#1076;&#1077;&#1082;&#1089;&#1072;" />
    <Translation locale="ru" localeKey="joburl" localeValue="URL&#1079;&#1072;&#1076;&#1072;&#1085;&#1080;&#1103;" />
    <Translation locale="ru" localeKey="Last Backup Attempt JobId" localeValue="&#1048;&#1076;&#1077;&#1085;&#1090;&#1080;&#1092;&#1080;&#1082;&#1072;&#1090;&#1086;&#1088;&#1047;&#1072;&#1076;&#1072;&#1085;&#1080;&#1103; &#1087;&#1086;&#1089;&#1083;&#1077;&#1076;&#1085;&#1077;&#1081; &#1087;&#1086;&#1087;&#1099;&#1090;&#1082;&#1080; &#1088;&#1077;&#1079;&#1077;&#1088;&#1074;&#1085;&#1086;&#1075;&#1086; &#1082;&#1086;&#1087;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1080;&#1103; " />
    <Translation locale="ru" localeKey="Last discovery time" localeValue="&#1042;&#1088;&#1077;&#1084;&#1103; &#1087;&#1086;&#1089;&#1083;&#1077;&#1076;&#1085;&#1077;&#1075;&#1086; &#1086;&#1073;&#1085;&#1072;&#1088;&#1091;&#1078;&#1077;&#1085;&#1080;&#1103;" />
    <Translation locale="ru" localeKey="Last index error time" localeValue="&#1042;&#1088;&#1077;&#1084;&#1103; &#1087;&#1086;&#1089;&#1083;&#1077;&#1076;&#1085;&#1077;&#1081; &#1086;&#1096;&#1080;&#1073;&#1082;&#1080; &#1080;&#1085;&#1076;&#1077;&#1082;&#1089;&#1072;" />
    <Translation locale="ru" localeKey="Last index time" localeValue="&#1042;&#1088;&#1077;&#1084;&#1103; &#1087;&#1086;&#1089;&#1083;&#1077;&#1076;&#1085;&#1077;&#1075;&#1086; &#1080;&#1085;&#1076;&#1077;&#1082;&#1089;&#1072;" />
    <Translation locale="ru" localeKey="Last indexed backup jobid" localeValue="&#1048;&#1076;&#1077;&#1085;&#1090;&#1080;&#1092;&#1080;&#1082;&#1072;&#1090;&#1086;&#1088; &#1087;&#1086;&#1089;&#1083;&#1077;&#1076;&#1085;&#1077;&#1075;&#1086; &#1087;&#1088;&#1086;&#1080;&#1085;&#1076;&#1077;&#1082;&#1089;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1085;&#1086;&#1075;&#1086; &#1079;&#1072;&#1076;&#1072;&#1085;&#1080;&#1103; &#1088;&#1077;&#1079;&#1077;&#1088;&#1074;&#1085;&#1086;&#1075;&#1086; &#1082;&#1086;&#1087;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1080;&#1103;" />
    <Translation locale="ru" localeKey="Mailboxes Meeting SLA" localeValue="&#1055;&#1086;&#1095;&#1090;&#1086;&#1074;&#1099;&#1077; &#1103;&#1097;&#1080;&#1082;&#1080;, &#1091;&#1076;&#1086;&#1074;&#1083;&#1077;&#1090;&#1074;&#1086;&#1088;&#1103;&#1102;&#1097;&#1080;&#1077; SLA " />
    <Translation locale="ru" localeKey="Mailboxes Missing SLA" localeValue="&#1055;&#1086;&#1095;&#1090;&#1086;&#1074;&#1099;&#1077; &#1103;&#1097;&#1080;&#1082;&#1080; &#1073;&#1077;&#1079; SLA" />
    <Translation locale="ru" localeKey="Mailboxes Never Backed-up" localeValue="&#1055;&#1086;&#1095;&#1090;&#1086;&#1074;&#1099;&#1077; &#1103;&#1097;&#1080;&#1082;&#1080; &#1073;&#1077;&#1079; &#1088;&#1077;&#1079;&#1077;&#1088;&#1074;&#1085;&#1099;&#1093; &#1082;&#1086;&#1087;&#1080;&#1081; " />
    <Translation locale="ru" localeKey="Mailboxes Not Meeting SLA" localeValue="&#1055;&#1086;&#1095;&#1090;&#1086;&#1074;&#1099;&#1077; &#1103;&#1097;&#1080;&#1082;&#1080;, &#1085;&#1077; &#1091;&#1076;&#1086;&#1074;&#1083;&#1077;&#1090;&#1074;&#1086;&#1088;&#1103;&#1102;&#1097;&#1080;&#1077; SLA " />
    <Translation locale="ru" localeKey="Not Processed Items" localeValue="&#1053;&#1077;&#1086;&#1073;&#1088;&#1072;&#1073;&#1086;&#1090;&#1072;&#1085;&#1085;&#1099;&#1077; &#1101;&#1083;&#1077;&#1084;&#1077;&#1085;&#1090;&#1099;" />
    <Translation locale="ru" localeKey="Not Processed Mailboxes" localeValue="&#1053;&#1077;&#1086;&#1073;&#1088;&#1072;&#1073;&#1086;&#1090;&#1072;&#1085;&#1085;&#1099;&#1077; &#1087;&#1086;&#1095;&#1090;&#1086;&#1074;&#1099;&#1077; &#1103;&#1097;&#1080;&#1082;&#1080; " />
    <Translation locale="ru" localeKey="Number Of Items" localeValue="&#1050;&#1086;&#1083;&#1080;&#1095;&#1077;&#1089;&#1090;&#1074;&#1086; &#1101;&#1083;&#1077;&#1084;&#1077;&#1085;&#1090;&#1086;&#1074;" />
    <Translation locale="ru" localeKey="Options" localeValue="&#1055;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1099;" />
    <Translation locale="ru" localeKey="SharePoint" localeValue="SharePoint" />
    <Translation locale="ru" localeKey="SharePoint Clients" localeValue="&#1050;&#1083;&#1080;&#1077;&#1085;&#1090;&#1099; SharePoint" />
    <Translation locale="ru" localeKey="Site URL" localeValue="URL-&#1072;&#1076;&#1088;&#1077;&#1089; &#1089;&#1072;&#1081;&#1090;&#1072;" />
    <Translation locale="ru" localeKey="Sites Meeting SLA" localeValue="&#1057;&#1072;&#1081;&#1090;&#1099;, &#1089;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1091;&#1102;&#1097;&#1080;&#1077; SLA " />
    <Translation locale="ru" localeKey="Sites Missing SLA" localeValue="&#1057;&#1072;&#1081;&#1090;&#1099; &#1089; &#1086;&#1090;&#1089;&#1091;&#1090;&#1089;&#1090;&#1074;&#1091;&#1102;&#1097;&#1080;&#1084; SLA" />
    <Translation locale="ru" localeKey="Sites Never Backed-up" localeValue="&#1057;&#1072;&#1081;&#1090;&#1099;, &#1076;&#1083;&#1103; &#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1093; &#1085;&#1077; &#1089;&#1086;&#1079;&#1076;&#1072;&#1074;&#1072;&#1083;&#1080;&#1089;&#1100; &#1088;&#1077;&#1079;&#1077;&#1088;&#1074;&#1085;&#1099;&#1077; &#1082;&#1086;&#1087;&#1080;&#1080;" />
    <Translation locale="ru" localeKey="Sites Not Meeting SLA" localeValue="&#1057;&#1072;&#1081;&#1090;&#1099;, &#1085;&#1077; &#1089;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1091;&#1102;&#1097;&#1080;&#1077; SLA " />
    <Translation locale="ru" localeKey="SLA Status for Exchange Clients" localeValue="&#1057;&#1090;&#1072;&#1090;&#1091;&#1089; SLA &#1076;&#1083;&#1103; &#1082;&#1083;&#1080;&#1077;&#1085;&#1090;&#1086;&#1074; Exchange " />
    <Translation locale="ru" localeKey="SLA Status for OneDrive Clients" localeValue="&#1057;&#1090;&#1072;&#1090;&#1091;&#1089; SLA &#1076;&#1083;&#1103; &#1082;&#1083;&#1080;&#1077;&#1085;&#1090;&#1086;&#1074; OneDrive" />
    <Translation locale="ru" localeKey="SLA Status for SharePoint Clients" localeValue="&#1057;&#1090;&#1072;&#1090;&#1091;&#1089; SLA &#1076;&#1083;&#1103; &#1082;&#1083;&#1080;&#1077;&#1085;&#1090;&#1086;&#1074; SharePoint" />
    <Translation locale="ru" localeKey="SLA Status for Teams Clients" localeValue="&#1057;&#1090;&#1072;&#1090;&#1091;&#1089; SLA &#1076;&#1083;&#1103; &#1082;&#1083;&#1080;&#1077;&#1085;&#1090;&#1086;&#1074; Teams " />
    <Translation locale="ru" localeKey="Teams" localeValue="Teams" />
    <Translation locale="ru" localeKey="Teams Clients" localeValue="&#1050;&#1083;&#1080;&#1077;&#1085;&#1090;&#1099; Teams " />
    <Translation locale="ru" localeKey="Teams Meeting SLA" localeValue="Teams &#1089;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1091;&#1102;&#1097;&#1080;&#1077; SLA " />
    <Translation locale="ru" localeKey="Users Never Backed-up" localeValue="&#1055;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1080;, &#1076;&#1083;&#1103; &#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1093; &#1085;&#1077; &#1074;&#1099;&#1087;&#1086;&#1083;&#1085;&#1103;&#1083;&#1086;&#1089;&#1100; &#1088;&#1077;&#1079;&#1077;&#1088;&#1074;&#1085;&#1086;&#1077; &#1082;&#1086;&#1087;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1080;&#1077;" />
    <Translation locale="ru" localeKey="Users Not Meeting SLA" localeValue="&#1055;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1080;, &#1085;&#1077; &#1089;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1091;&#1102;&#1097;&#1080;&#1077; SLA " />
    <Translation locale="zh" localeKey="Active Jobs" localeValue="&#27963;&#36291;&#20316;&#19994;" />
    <Translation locale="zh" localeKey="activejobsurl" localeValue="&#27963;&#36291;&#20316;&#19994; URL" />
    <Translation locale="zh" localeKey="Added to content on" localeValue="&#28155;&#21152;&#21040;&#20869;&#23481;" />
    <Translation locale="zh" localeKey="Advanced" localeValue="&#39640;&#32423;&#30340;" />
    <Translation locale="zh" localeKey="Application Size" localeValue="&#24212;&#29992;&#31243;&#24207;&#22823;&#23567;" />
    <Translation locale="zh" localeKey="Associated Mailboxes" localeValue="&#20851;&#32852;&#30340;&#37038;&#31665;" />
    <Translation locale="zh" localeKey="Associated Sites" localeValue="&#20851;&#32852;&#30340;&#31449;&#28857;" />
    <Translation locale="zh" localeKey="Associated Teams" localeValue="&#20851;&#32852;&#30340;&#22242;&#38431;" />
    <Translation locale="zh" localeKey="Associated Users" localeValue="&#20851;&#32852;&#30340;&#29992;&#25143;" />
    <Translation locale="zh" localeKey="Azure Apps Associated" localeValue="&#20851;&#32852;&#30340; Azure Apps" />
    <Translation locale="zh" localeKey="Azure Apps To Be Added" localeValue="&#35201;&#28155;&#21152;&#30340; Azure Apps" />
    <Translation locale="zh" localeKey="Backup Size" localeValue="&#22791;&#20221;&#22823;&#23567;" />
    <Translation locale="zh" localeKey="Backup Status" localeValue="&#22791;&#20221;&#29366;&#24577;" />
    <Translation locale="zh" localeKey="Client Groups" localeValue="&#23458;&#25143;&#31471;&#32452;" />
    <Translation locale="zh" localeKey="clienturl" localeValue="&#23458;&#25143;&#31471; URL" />
    <Translation locale="zh" localeKey="Failed Items" localeValue="&#22833;&#36133;&#30340;&#39033;&#30446;" />
    <Translation locale="zh" localeKey="Index Status" localeValue="&#32034;&#24341;&#29366;&#24577;" />
    <Translation locale="zh" localeKey="Indexed Emails" localeValue="&#32034;&#24341;&#37038;&#20214;" />
    <Translation locale="zh" localeKey="Indexed Items" localeValue="&#32034;&#24341;&#39033;&#30446;" />
    <Translation locale="zh" localeKey="joburl" localeValue="&#20316;&#19994; URL" />
    <Translation locale="zh" localeKey="Last Backup Attempt JobId" localeValue="&#19978;&#27425;&#22791;&#20221;&#23581;&#35797;&#20316;&#19994; ID" />
    <Translation locale="zh" localeKey="Last discovery time" localeValue="&#26368;&#21518;&#21457;&#29616;&#26102;&#38388;" />
    <Translation locale="zh" localeKey="Last index error time" localeValue="&#19978;&#27425;&#32034;&#24341;&#38169;&#35823;&#26102;&#38388;" />
    <Translation locale="zh" localeKey="Last index time" localeValue="&#19978;&#27425;&#32034;&#24341;&#26102;&#38388;" />
    <Translation locale="zh" localeKey="Last indexed backup jobid" localeValue="&#19978;&#27425;&#32034;&#24341;&#30340;&#22791;&#20221;&#20316;&#19994; ID" />
    <Translation locale="zh" localeKey="Mailboxes Backed-up (at least once)" localeValue="&#24050;&#22791;&#20221;&#37038;&#31665;&#65288;&#33267;&#23569;&#19968;&#27425;&#65289;" />
    <Translation locale="zh" localeKey="Mailboxes Meeting SLA" localeValue="SLA&#36798;&#26631;&#37038;&#31665;" />
    <Translation locale="zh" localeKey="Mailboxes Missing SLA" localeValue="SLA&#26410;&#36798;&#26631;&#37038;&#31665;" />
    <Translation locale="zh" localeKey="Mailboxes Need Attention" localeValue="&#37038;&#31665;&#38656;&#35201;&#27880;&#24847;" />
    <Translation locale="zh" localeKey="Mailboxes Never Backed-up" localeValue="&#20174;&#26410;&#22791;&#20221;&#30340;&#37038;&#31665;" />
    <Translation locale="zh" localeKey="Mailboxes Not Meeting SLA" localeValue="SLA&#19981;&#36798;&#26631;&#37038;&#31665;" />
    <Translation locale="zh" localeKey="Mailboxes Recently Added" localeValue="&#26368;&#36817;&#28155;&#21152;&#30340;&#37038;&#31665;" />
    <Translation locale="zh" localeKey="Max Streams" localeValue="&#26368;&#22810;&#27969;" />
    <Translation locale="zh" localeKey="Not Processed Items" localeValue="&#26410;&#22788;&#29702;&#39033;&#30446;" />
    <Translation locale="zh" localeKey="Not Processed Mailboxes" localeValue="&#26410;&#22788;&#29702;&#30340;&#37038;&#31665;" />
    <Translation locale="zh" localeKey="Number Of Items" localeValue="&#39033;&#30446;&#25968;" />
    <Translation locale="zh" localeKey="Options" localeValue="&#36873;&#39033;" />
    <Translation locale="zh" localeKey="SharePoint" localeValue="SharePoint" />
    <Translation locale="zh" localeKey="SharePoint Clients" localeValue="SharePoint &#23458;&#25143;&#31471;" />
    <Translation locale="zh" localeKey="Site URL" localeValue="&#32593;&#31449; URL" />
    <Translation locale="zh" localeKey="Sites Meeting SLA" localeValue="SLA&#36798;&#26631;&#31449;&#28857;" />
    <Translation locale="zh" localeKey="Sites Missing SLA" localeValue="SLA&#19981;&#36798;&#26631;&#31449;&#28857;" />
    <Translation locale="zh" localeKey="Sites Never Backed-up" localeValue="&#20174;&#19981;&#22791;&#20221;&#32593;&#31449;" />
    <Translation locale="zh" localeKey="Sites Not Meeting SLA" localeValue="SLA&#19981;&#36798;&#26631;&#30340;&#32593;&#31449;" />
    <Translation locale="zh" localeKey="SLA Status for Exchange Clients" localeValue="Exchange&#23458;&#25143;&#31471;&#30340;SLA&#29366;&#24577;" />
    <Translation locale="zh" localeKey="SLA Status for OneDrive Clients" localeValue="OneDrive&#23458;&#25143;&#31471;&#30340;SLA&#29366;&#24577;" />
    <Translation locale="zh" localeKey="SLA Status for SharePoint Clients" localeValue="SharePoint&#23458;&#25143;&#31471;&#30340;SLA&#29366;&#24577;" />
    <Translation locale="zh" localeKey="SLA Status for Teams Clients" localeValue="&#22242;&#38431;&#23458;&#25143;&#31471;&#30340;SLA&#29366;&#24577;" />
    <Translation locale="zh" localeKey="Teams" localeValue="&#22242;&#38431;" />
    <Translation locale="zh" localeKey="Teams Clients" localeValue="&#22242;&#38431;&#23458;&#25143;&#31471;" />
    <Translation locale="zh" localeKey="Teams Meeting SLA" localeValue="SLA&#36798;&#26631;&#30340;&#22242;&#38431;" />
    <Translation locale="zh" localeKey="Teams Missing SLA" localeValue="SLA&#26410;&#36798;&#26631;&#30340;&#22242;&#38431;" />
    <Translation locale="zh" localeKey="Teams Never Backed-up" localeValue="&#20174;&#26410;&#22791;&#20221;&#30340;&#22242;&#38431;" />
    <Translation locale="zh" localeKey="Teams Not Meeting SLA" localeValue="SLA&#26410;&#36798;&#26631;&#30340;&#22242;&#38431;" />
    <Translation locale="zh" localeKey="Users Meeting SLA" localeValue="SLA&#36798;&#26631;&#29992;&#25143;" />
    <Translation locale="zh" localeKey="Users Missing SLA" localeValue="SLA&#26410;&#36798;&#26631;&#29992;&#25143;" />
    <Translation locale="zh" localeKey="Users Never Backed-up" localeValue="&#26410;&#22791;&#20221;&#30340;&#29992;&#25143;" />
    <Translation locale="zh" localeKey="Users Not Meeting SLA" localeValue="SLA&#26410;&#36798;&#26631;&#29992;&#25143;" />
    <Translation locale="zh_TW" localeKey="Application Size" localeValue="&#25033;&#29992;&#31243;&#24207;&#22823;&#23567;" />
    <Translation locale="zh_TW" localeKey="Backup Status" localeValue="&#20633;&#20221;&#29376;&#24907;" />
    <Translation locale="zh_TW" localeKey="Client Groups" localeValue="&#23458;&#25142;&#31471;&#32068;" />
    <Translation locale="zh_TW" localeKey="clienturl" localeValue="&#23458;&#25142;&#31471;&#32178;&#22336;" />
    <Translation locale="zh_TW" localeKey="Teams" localeValue="Teams" />
    <Translation locale="zh_TW" localeKey="Teams Clients" localeValue="Teams &#23458;&#25142;&#31471;" />
    <Translation locale="zh_TW" localeKey="Teams Meeting SLA" localeValue="SLA&#36948;&#27161;&#30340;Teams" />
    <Translation locale="zh_TW" localeKey="Teams Missing SLA" localeValue="SLA&#26410;&#36948;&#27161;&#30340; Teams" />
    <Translation locale="zh_TW" localeKey="Teams Never Backed-up" localeValue="&#24478;&#26410;&#20633;&#20221;&#30340; Teams" />
    <Translation locale="zh_TW" localeKey="Teams Not Meeting SLA" localeValue="SLA&#26410;&#36948;&#27161;&#30340; Teams" />
    <Translation locale="zh" localeKey="Sites Backed-up (at least once)" localeValue="&#24050;&#22791;&#20221;&#31449;&#28857;&#65288;&#33267;&#23569;&#19968;&#27425;&#65289;" />
    <Translation locale="zh" localeKey="Sites Need Attention" localeValue="&#32593;&#31449;&#38656;&#35201;&#27880;&#24847;" />
    <Translation locale="zh" localeKey="Sites Recently Added" localeValue="&#26368;&#36817;&#28155;&#21152;&#30340;&#31449;&#28857;" />
    <Translation locale="zh" localeKey="Teams Backed-up (at least once)" localeValue="&#24050;&#22791;&#20221;&#22242;&#38431;&#65288;&#33267;&#23569;&#19968;&#27425;&#65289;" />
    <Translation locale="zh" localeKey="Teams Need Attention" localeValue="&#22242;&#38431;&#38656;&#35201;&#27880;&#24847;" />
    <Translation locale="zh" localeKey="Teams Recently Added" localeValue="&#26368;&#36817;&#28155;&#21152;&#30340;&#22242;&#38431;" />
    <Translation locale="zh" localeKey="Users Backed-up (at least once)" localeValue="&#29992;&#25143;&#22791;&#20221;&#65288;&#33267;&#23569;&#19968;&#27425;&#65289;" />
    <Translation locale="zh" localeKey="Users Need Attention" localeValue="&#29992;&#25143;&#38656;&#35201;&#27880;&#24847;" />
    <Translation locale="zh" localeKey="Users Recently Added" localeValue="&#26368;&#36817;&#28155;&#21152;&#30340;&#29992;&#25143;" />
    <Translation locale="fr_CA" localeKey="Associated Teams" localeValue="Teams associ&#233;s" />
    <Translation locale="fr" localeKey="Associated Teams" localeValue="Teams associ&#233;s" />
    <Translation locale="ja" localeKey="Added to content on" localeValue="&#12467;&#12531;&#12486;&#12531;&#12484;&#12395;&#36861;&#21152;" />
    <Translation locale="ja" localeKey="Azure Apps Associated" localeValue="&#38306;&#36899;&#12377;&#12427;Azure&#12450;&#12503;&#12522;" />
    <Translation locale="ja" localeKey="Azure Apps To Be Added" localeValue="&#36861;&#21152;&#12373;&#12428;&#12427;Azure&#12450;&#12503;&#12522;" />
    <Translation locale="ja" localeKey="Users Backed-up (at least once)" localeValue="&#12496;&#12483;&#12463;&#12450;&#12483;&#12503;&#12373;&#12428;&#12383;&#12518;&#12540;&#12470;&#12540;&#65288;&#23569;&#12394;&#12367;&#12392;&#12418;1&#22238;&#65289;" />
    <Translation locale="ja" localeKey="Users Need Attention" localeValue="&#27880;&#24847;&#12364;&#24517;&#35201;&#12394;&#12518;&#12540;&#12470;&#12540;" />
    <Translation locale="ja" localeKey="Users Recently Added" localeValue="&#26368;&#36817;&#36861;&#21152;&#12373;&#12428;&#12383;&#12518;&#12540;&#12470;&#12540;" />
    <Translation locale="ja" localeKey="clienturl" localeValue="&#12463;&#12521;&#12452;&#12450;&#12531;&#12488;URL" />
    <Translation locale="ko" localeKey="Added to content on" localeValue="&#53080;&#53584;&#52768;&#50640; &#52628;&#44032;" />
    <Translation locale="ko" localeKey="Application Size" localeValue="&#51025;&#50857; &#54532;&#47196;&#44536;&#47016; &#53356;&#44592;" />
    <Translation locale="ko" localeKey="Azure Apps Associated" localeValue="&#50672;&#44208;&#46108; Azure App" />
    <Translation locale="ko" localeKey="Indexed Emails" localeValue="&#51064;&#45937;&#49905;&#46108; &#51060;&#47700;&#51068;" />
    <Translation locale="ko" localeKey="Last discovery time" localeValue="&#47560;&#51648;&#47561; &#44160;&#49353; &#49884;&#44036;" />
    <Translation locale="ko" localeKey="Mailboxes Need Attention" localeValue="&#51452;&#51032;&#44032; &#54596;&#50836;&#54620; &#49324;&#49436;&#54632;" />
    <Translation locale="ko" localeKey="Mailboxes Recently Added" localeValue="&#52572;&#44540;&#50640; &#52628;&#44032;&#46108; &#49324;&#49436;&#54632;" />
    <Translation locale="ko" localeKey="Options" localeValue="&#50741;&#49496;" />
    <Translation locale="ko" localeKey="SharePoint" localeValue="SharePoint" />
    <Translation locale="ko" localeKey="Sites Need Attention" localeValue="&#51452;&#51032;&#44032; &#54596;&#50836;&#54620; &#49324;&#51060;&#53944;" />
    <Translation locale="ko" localeKey="Sites Not Meeting SLA" localeValue="SLA&#47484; &#52649;&#51313;&#54616;&#51648; &#50506;&#45716; &#49324;&#51060;&#53944;" />
    <Translation locale="ko" localeKey="Sites Recently Added" localeValue="&#52572;&#44540; &#52628;&#44032;&#46108; &#49324;&#51060;&#53944;" />
    <Translation locale="ko" localeKey="Teams Backed-up (at least once)" localeValue="&#48177;&#50629;&#46108; Teams(1&#54924; &#51060;&#49345;)" />
    <Translation locale="ko" localeKey="Teams Clients" localeValue="Teams &#53364;&#46972;&#51060;&#50616;&#53944;" />
    <Translation locale="ko" localeKey="Teams Need Attention" localeValue="&#51452;&#51032;&#44032; &#54596;&#50836;&#54620; Teams" />
    <Translation locale="ko" localeKey="Teams Recently Added" localeValue="&#52572;&#44540;&#50640; &#52628;&#44032;&#46108; Teams" />
    <Translation locale="zh_TW" localeKey="Active Jobs" localeValue="&#27963;&#36493;&#20316;&#26989;" />
    <Translation locale="zh_TW" localeKey="Advanced" localeValue="&#39640;&#32026;" />
    <Translation locale="zh_TW" localeKey="Associated Mailboxes" localeValue="&#38364;&#32879;&#37109;&#31665;" />
    <Translation locale="zh_TW" localeKey="Associated Sites" localeValue="&#38364;&#32879;&#31449;&#40670;" />
    <Translation locale="zh_TW" localeKey="Associated Teams" localeValue="&#38364;&#32879; Teams" />
    <Translation locale="zh_TW" localeKey="Associated Users" localeValue="&#38364;&#32879;&#29992;&#25142;" />
    <Translation locale="zh_TW" localeKey="Azure Apps To Be Added" localeValue="&#35201;&#28155;&#21152;&#30340; Azure Apps" />
    <Translation locale="zh_TW" localeKey="Backup Size" localeValue="&#20633;&#20221;&#22823;&#23567;" />
    <Translation locale="zh_TW" localeKey="Failed Items" localeValue="&#22833;&#25943;&#38917;&#30446;" />
    <Translation locale="zh_TW" localeKey="Failure Reason" localeValue="&#22833;&#25943;&#21407;&#22240;" />
    <Translation locale="zh_TW" localeKey="Last Backup Attempt JobId" localeValue="&#19978;&#27425;&#20633;&#20221;&#22039;&#35430;&#20316;&#26989;&#32232;&#34399;" />
    <Translation locale="zh_TW" localeKey="Last discovery time" localeValue="&#19978;&#27425;&#30332;&#29694;&#26178;&#38291;" />
    <Translation locale="zh_TW" localeKey="Last index error time" localeValue="&#19978;&#27425;&#32034;&#24341;&#37679;&#35492;&#26178;&#38291;" />
    <Translation locale="zh_TW" localeKey="Mailbox Size" localeValue="&#37109;&#31665;&#22823;&#23567;" />
    <Translation locale="zh_TW" localeKey="Mailboxes Need Attention" localeValue="&#37109;&#31665;&#38656;&#35201;&#27880;&#24847;" />
    <Translation locale="zh_TW" localeKey="Mailboxes Never Backed-up" localeValue="&#24478;&#26410;&#20633;&#20221;&#30340;&#37109;&#31665;" />
    <Translation locale="zh_TW" localeKey="Mailboxes Recently Added" localeValue="&#26368;&#36817;&#28155;&#21152;&#30340;&#37109;&#31665;" />
    <Translation locale="zh_TW" localeKey="Max Streams" localeValue="&#26368;&#22823;&#27969;&#25976;" />
    <Translation locale="zh_TW" localeKey="Number Of Items" localeValue="&#38917;&#30446;&#25976;&#30446;" />
    <Translation locale="zh_TW" localeKey="Number of Items" localeValue="&#38917;&#30446;&#25976;&#30446;" />
    <Translation locale="zh_TW" localeKey="OneDrive Clients" localeValue="OneDrive &#23458;&#25142;&#31471;" />
    <Translation locale="zh_TW" localeKey="Options" localeValue="&#36984;&#38917;" />
    <Translation locale="zh_TW" localeKey="SharePoint" localeValue="SharePoint" />
    <Translation locale="zh_TW" localeKey="SharePoint Clients" localeValue="SharePoint &#23458;&#25142;&#31471;" />
    <Translation locale="zh_TW" localeKey="Site URL" localeValue="&#31449;&#40670; URL" />
    <Translation locale="zh_TW" localeKey="Sites Need Attention" localeValue="&#38656;&#35201;&#27880;&#24847;&#30340;&#32178;&#31449;" />
    <Translation locale="zh_TW" localeKey="Sites Never Backed-up" localeValue="&#24478;&#26410;&#20633;&#20221;&#30340;&#31449;&#40670;" />
    <Translation locale="zh_TW" localeKey="Sites Recently Added" localeValue="&#26368;&#36817;&#28155;&#21152;&#30340;&#31449;&#40670;" />
    <Translation locale="zh_TW" localeKey="Skipped" localeValue="&#36339;&#36942;&#30340;" />
    <Translation locale="zh_TW" localeKey="activejobsurl" localeValue="&#27963;&#36493;&#20316;&#26989;&#32178;&#22336;" />
    <Translation locale="ru" localeKey="Added to content on" localeValue="&#1044;&#1086;&#1073;&#1072;&#1074;&#1083;&#1077;&#1085;&#1086; &#1074; &#1089;&#1086;&#1076;&#1077;&#1088;&#1078;&#1080;&#1084;&#1086;&#1077; &#1085;&#1072;" />
    <Translation locale="ru" localeKey="Azure Apps Associated" localeValue="&#1057;&#1074;&#1103;&#1079;&#1072;&#1085;&#1085;&#1099;&#1077; Azure Apps " />
    <Translation locale="ru" localeKey="Azure Apps To Be Added" localeValue="Azure Apps &#1076;&#1083;&#1103; &#1076;&#1086;&#1073;&#1072;&#1074;&#1083;&#1077;&#1085;&#1080;&#1103;" />
    <Translation locale="ru" localeKey="Failed Items" localeValue="&#1069;&#1083;&#1077;&#1084;&#1077;&#1085;&#1090;&#1099; &#1089; &#1086;&#1096;&#1080;&#1073;&#1082;&#1072;&#1084;&#1080;" />
    <Translation locale="ko" localeKey="Indexed Items" localeValue="&#51064;&#45937;&#49905;&#46108; &#54637;&#47785;" />
    <Translation locale="ko" localeKey="Max Streams" localeValue="&#52572;&#45824; &#49828;&#53944;&#47548;" />
    <Translation locale="ko" localeKey="Sites Backed-up (at least once)" localeValue="&#48177;&#50629;&#46108; &#49324;&#51060;&#53944;(&#51201;&#50612;&#46020; &#54620;&#48264;)" />
    <Translation locale="ko" localeKey="Users Recently Added" localeValue="&#52572;&#44540;&#50640; &#52628;&#44032;&#46108; &#49324;&#50857;&#51088;" />
    <Translation locale="zh_TW" localeKey="Added to content on" localeValue="&#28155;&#21152;&#21040;&#20839;&#23481;" />
    <Translation locale="zh_TW" localeKey="Azure Apps Associated" localeValue="&#38364;&#32879;&#30340; Azure Apps" />
    <Translation locale="zh_TW" localeKey="Index Status" localeValue="&#32034;&#24341;&#29376;&#24907;" />
    <Translation locale="zh_TW" localeKey="Indexed Emails" localeValue="&#32034;&#24341;&#38651;&#23376;&#37109;&#20214;" />
    <Translation locale="zh_TW" localeKey="Indexed Items" localeValue="&#32034;&#24341;&#38917;&#30446;" />
    <Translation locale="zh_TW" localeKey="Last backup attempt" localeValue="&#19978;&#27425;&#20633;&#20221;&#22039;&#35430;" />
    <Translation locale="zh_TW" localeKey="Last backup attempt job Id" localeValue="&#19978;&#27425;&#20633;&#20221;&#22039;&#35430;&#20316;&#26989; ID" />
    <Translation locale="zh_TW" localeKey="Last index time" localeValue="&#19978;&#27425;&#32034;&#24341;&#26178;&#38291;" />
    <Translation locale="zh_TW" localeKey="Last indexed backup jobid" localeValue="&#19978;&#27425;&#32034;&#24341;&#30340;&#20633;&#20221;&#20316;&#26989; ID" />
    <Translation locale="zh_TW" localeKey="Mailboxes Backed-up (at least once)" localeValue="&#20633;&#20221;&#37109;&#31665;&#65288;&#33267;&#23569;&#19968;&#27425;&#65289;" />
    <Translation locale="zh_TW" localeKey="Mailboxes Meeting SLA" localeValue="SLA&#36948;&#27161;&#37109;&#31665;" />
    <Translation locale="zh_TW" localeKey="Mailboxes Missing SLA" localeValue="SLA&#26410;&#36798;&#26631;&#37038;&#31665;&#09;" />
    <Translation locale="zh_TW" localeKey="Mailboxes Not Meeting SLA" localeValue="SLA&#26410;&#36798;&#26631;&#37038;&#31665;&#09;" />
    <Translation locale="zh_TW" localeKey="Name" localeValue="&#21517;&#31281;" />
    <Translation locale="zh_TW" localeKey="Not Processed Items" localeValue="&#26410;&#34389;&#29702;&#30340;&#38917;&#30446;" />
    <Translation locale="zh_TW" localeKey="Not Processed Mailboxes" localeValue="&#26410;&#34389;&#29702;&#30340;&#37109;&#31665;" />
    <Translation locale="zh_TW" localeKey="Not backed up" localeValue="&#26410;&#20633;&#20221;" />
    <Translation locale="zh_TW" localeKey="Office365 SLA Report" localeValue="Office365 SLA &#22577;&#21578;" />
    <Translation locale="zh_TW" localeKey="SLA Status for Exchange Clients" localeValue="Exchange &#23458;&#25142;&#31471;&#30340; SLA &#29376;&#24907;" />
    <Translation locale="zh_TW" localeKey="SLA Status for OneDrive Clients" localeValue="OneDrive &#23458;&#25142;&#31471;&#30340; SLA &#29376;&#24907;" />
    <Translation locale="zh_TW" localeKey="SLA Status for SharePoint Clients" localeValue="SharePoint &#23458;&#25142;&#31471;&#30340; SLA &#29376;&#24907;" />
    <Translation locale="zh_TW" localeKey="SLA Status for Teams Clients" localeValue="Teams &#23458;&#25142;&#30340; SLA &#29376;&#24907;" />
    <Translation locale="zh_TW" localeKey="SLA by Clients" localeValue="&#25353;&#23458;&#25142;&#31471;&#30340;SLA" />
    <Translation locale="zh_TW" localeKey="SLA by Mailboxes" localeValue="&#25353;&#37109;&#31665;&#30340;SLA" />
    <Translation locale="zh_TW" localeKey="SLA by Users" localeValue="&#25353;&#29992;&#25142;&#30340;SLA" />
    <Translation locale="zh_TW" localeKey="Summary by Clients" localeValue="&#25353;&#23458;&#25142;&#31471;&#32317;&#32080;" />
    <Translation locale="zh_TW" localeKey="Time frame" localeValue="&#22823;&#39636;&#26178;&#38291;" />
    <Translation locale="zh_TW" localeKey="Timeframe" localeValue="&#22823;&#39636;&#26178;&#38291;" />
    <Translation locale="zh_TW" localeKey="joburl" localeValue="&#20316;&#26989;&#32178;&#22336;" />
    <Translation locale="default" localeKey="Active Jobs" localeValue="Active Jobs" />
    <Translation locale="default" localeKey="activejobsurl" localeValue="activejobsurl" />
    <Translation locale="default" localeKey="Added to content on" localeValue="Added to content on" />
    <Translation locale="default" localeKey="Advanced" localeValue="Advanced" />
    <Translation locale="default" localeKey="Application Size" localeValue="Application Size" />
    <Translation locale="default" localeKey="Associated Mailboxes" localeValue="Associated Mailboxes" />
    <Translation locale="default" localeKey="Associated Sites" localeValue="Associated Sites" />
    <Translation locale="default" localeKey="Associated Teams" localeValue="Associated Teams" />
    <Translation locale="default" localeKey="Associated Users" localeValue="Associated Users" />
    <Translation locale="default" localeKey="Azure Apps Associated" localeValue="Azure Apps Associated" />
    <Translation locale="default" localeKey="Azure Apps To Be Added" localeValue="Azure Apps To Be Added" />
    <Translation locale="default" localeKey="Backup Size" localeValue="Backup Size" />
    <Translation locale="default" localeKey="Backup Status" localeValue="Backup Status" />
    <Translation locale="default" localeKey="Client Groups" localeValue="Client Groups" />
    <Translation locale="default" localeKey="Client Name" localeValue="Client Name" />
    <Translation locale="default" localeKey="clienturl" localeValue="clienturl" />
    <Translation locale="default" localeKey="Completed with errors" localeValue="Completed with errors" />
    <Translation locale="default" localeKey="Data Source" localeValue="Data Source" />
    <Translation locale="default" localeKey="Email Address" localeValue="Email Address" />
    <Translation locale="default" localeKey="Exchange" localeValue="Exchange" />
    <Translation locale="default" localeKey="Exchange Client Groups" localeValue="Exchange Client Groups" />
    <Translation locale="default" localeKey="Exchange Clients" localeValue="Exchange Clients" />
    <Translation locale="default" localeKey="Failed" localeValue="Failed" />
    <Translation locale="default" localeKey="Failed Items" localeValue="Failed Items" />
    <Translation locale="default" localeKey="Failure Reason" localeValue="Failure Reason" />
    <Translation locale="default" localeKey="Index Status" localeValue="Index Status" />
    <Translation locale="default" localeKey="Indexed Emails" localeValue="Indexed Emails" />
    <Translation locale="default" localeKey="Indexed Items" localeValue="Indexed Items" />
    <Translation locale="default" localeKey="joburl" localeValue="joburl" />
    <Translation locale="default" localeKey="Last backup" localeValue="Last backup" />
    <Translation locale="default" localeKey="Last backup attempt" localeValue="Last backup attempt" />
    <Translation locale="default" localeKey="Last backup attempt job Id" localeValue="Last backup attempt job Id" />
    <Translation locale="default" localeKey="Last Backup Attempt JobId" localeValue="Last Backup Attempt JobId" />
    <Translation locale="default" localeKey="Last discovery time" localeValue="Last discovery time" />
    <Translation locale="default" localeKey="Last index error time" localeValue="Last index error time" />
    <Translation locale="default" localeKey="Last index time" localeValue="Last index time" />
    <Translation locale="default" localeKey="Last indexed backup jobid" localeValue="Last indexed backup jobid" />
    <Translation locale="default" localeKey="Mailbox Size" localeValue="Mailbox Size" />
    <Translation locale="default" localeKey="Mailbox Status" localeValue="Mailbox Status" />
    <Translation locale="default" localeKey="Mailbox Type" localeValue="Mailbox Type" />
    <Translation locale="default" localeKey="Mailboxes Backed-up (at least once)" localeValue="Mailboxes Backed-up (at least once)" />
    <Translation locale="default" localeKey="Mailboxes Meeting SLA" localeValue="Mailboxes Meeting SLA" />
    <Translation locale="default" localeKey="Mailboxes Missing SLA" localeValue="Mailboxes Missing SLA" />
    <Translation locale="default" localeKey="Mailboxes Need Attention" localeValue="Mailboxes Need Attention" />
    <Translation locale="default" localeKey="Mailboxes Never Backed-up" localeValue="Mailboxes Never Backed-up" />
    <Translation locale="default" localeKey="Mailboxes Not Meeting SLA" localeValue="Mailboxes Not Meeting SLA" />
    <Translation locale="default" localeKey="Mailboxes Recently Added" localeValue="Mailboxes Recently Added" />
    <Translation locale="default" localeKey="Max Streams" localeValue="Max Streams" />
    <Translation locale="default" localeKey="Name" localeValue="Name" />
    <Translation locale="default" localeKey="Not backed up" localeValue="Not backed up" />
    <Translation locale="default" localeKey="Not Processed Items" localeValue="Not Processed Items" />
    <Translation locale="default" localeKey="Not Processed Mailboxes" localeValue="Not Processed Mailboxes" />
    <Translation locale="default" localeKey="Number of Emails" localeValue="Number of Emails" />
    <Translation locale="default" localeKey="Number of Items" localeValue="Number of Items" />
    <Translation locale="default" localeKey="Number Of Items" localeValue="Number Of Items" />
    <Translation locale="default" localeKey="Office365 SLA Report" localeValue="Office365 SLA Report" />
    <Translation locale="default" localeKey="OneDrive" localeValue="OneDrive" />
    <Translation locale="default" localeKey="OneDrive Client Groups" localeValue="OneDrive Client Groups" />
    <Translation locale="default" localeKey="OneDrive Clients" localeValue="OneDrive Clients" />
    <Translation locale="default" localeKey="Options" localeValue="Options" />
    <Translation locale="default" localeKey="SharePoint" localeValue="SharePoint" />
    <Translation locale="default" localeKey="SharePoint Clients" localeValue="SharePoint Clients" />
    <Translation locale="default" localeKey="Site URL" localeValue="Site URL" />
    <Translation locale="default" localeKey="Sites Backed-up (at least once)" localeValue="Sites Backed-up (at least once)" />
    <Translation locale="default" localeKey="Sites Meeting SLA" localeValue="Sites Meeting SLA" />
    <Translation locale="default" localeKey="Sites Missing SLA" localeValue="Sites Missing SLA" />
    <Translation locale="default" localeKey="Sites Need Attention" localeValue="Sites Need Attention" />
    <Translation locale="default" localeKey="Sites Never Backed-up" localeValue="Sites Never Backed-up" />
    <Translation locale="default" localeKey="Sites Not Meeting SLA" localeValue="Sites Not Meeting SLA" />
    <Translation locale="default" localeKey="Sites Recently Added" localeValue="Sites Recently Added" />
    <Translation locale="default" localeKey="Skipped" localeValue="Skipped" />
    <Translation locale="default" localeKey="SLA by Clients" localeValue="SLA by Clients" />
    <Translation locale="default" localeKey="SLA by Mailboxes" localeValue="SLA by Mailboxes" />
    <Translation locale="default" localeKey="SLA by Users" localeValue="SLA by Users" />
    <Translation locale="default" localeKey="SLA Status" localeValue="SLA Status" />
    <Translation locale="default" localeKey="SLA Status for Exchange Clients" localeValue="SLA Status for Exchange Clients" />
    <Translation locale="default" localeKey="SLA Status for OneDrive Clients" localeValue="SLA Status for OneDrive Clients" />
    <Translation locale="default" localeKey="SLA Status for SharePoint Clients" localeValue="SLA Status for SharePoint Clients" />
    <Translation locale="default" localeKey="SLA Status for Teams Clients" localeValue="SLA Status for Teams Clients" />
    <Translation locale="default" localeKey="Successful" localeValue="Successful" />
    <Translation locale="default" localeKey="Summary by Clients" localeValue="Summary by Clients" />
    <Translation locale="default" localeKey="Summary by Mailboxes" localeValue="Summary by Mailboxes" />
    <Translation locale="default" localeKey="Summary by Users" localeValue="Summary by Users" />
    <Translation locale="default" localeKey="Suspended" localeValue="Suspended" />
    <Translation locale="default" localeKey="sys_rowid" localeValue="sys_rowid" />
    <Translation locale="default" localeKey="Teams" localeValue="Teams" />
    <Translation locale="default" localeKey="Teams Backed-up (at least once)" localeValue="Teams Backed-up (at least once)" />
    <Translation locale="default" localeKey="Teams Clients" localeValue="Teams Clients" />
    <Translation locale="default" localeKey="Teams Meeting SLA" localeValue="Teams Meeting SLA" />
    <Translation locale="default" localeKey="Teams Missing SLA" localeValue="Teams Missing SLA" />
    <Translation locale="default" localeKey="Teams Need Attention" localeValue="Teams Need Attention" />
    <Translation locale="default" localeKey="Teams Never Backed-up" localeValue="Teams Never Backed-up" />
    <Translation locale="default" localeKey="Teams Not Meeting SLA" localeValue="Teams Not Meeting SLA" />
    <Translation locale="default" localeKey="Teams Recently Added" localeValue="Teams Recently Added" />
    <Translation locale="default" localeKey="Time frame" localeValue="Time frame" />
    <Translation locale="default" localeKey="Timeframe" localeValue="Timeframe" />
    <Translation locale="default" localeKey="Total Mailboxes" localeValue="Total Mailboxes" />
    <Translation locale="default" localeKey="Total Users" localeValue="Total Users" />
    <Translation locale="default" localeKey="User Size" localeValue="User Size" />
    <Translation locale="default" localeKey="User Status" localeValue="User Status" />
    <Translation locale="default" localeKey="Users Backed-up (at least once)" localeValue="Users Backed-up (at least once)" />
    <Translation locale="default" localeKey="Users Meeting SLA" localeValue="Users Meeting SLA" />
    <Translation locale="default" localeKey="Users Missing SLA" localeValue="Users Missing SLA" />
    <Translation locale="default" localeKey="Users Need Attention" localeValue="Users Need Attention" />
    <Translation locale="default" localeKey="Users Never Backed-up" localeValue="Users Never Backed-up" />
    <Translation locale="default" localeKey="Users Not Meeting SLA" localeValue="Users Not Meeting SLA" />
    <Translation locale="default" localeKey="Users Recently Added" localeValue="Users Recently Added" />
  </cvTranslations>
  <minCommCellVersion>
    <releaseID>16</releaseID>
    <servicePack>0</servicePack>
    <spMinorVersion>0</spMinorVersion>
  </minCommCellVersion>
  <maxCommCellVersion>
    <releaseID>100</releaseID>
    <servicePack>99</servicePack>
  </maxCommCellVersion>
  <userReportId>Office365 Backup Health</userReportId>
  <uiTags>
    <string>Office365</string>
    <string>Backup Health</string>
  </uiTags>
  <showPagesAsTabs>true</showPagesAsTabs>
  <type>STANDARD</type>
  <canEdit>true</canEdit>
  <visibleToTenantAdmins>true</visibleToTenantAdmins>
  <builtIn>false</builtIn>
  <systemReport>false</systemReport>
  <isMetrics>false</isMetrics>
</CustomReport>